
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Signal &#8212; NeuroKit2 0.1.8 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <link rel="shortcut icon" href="../_static/icon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Events" href="functions_events.html" />
    <link rel="prev" title="Microstates" href="functions_microstates.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/neurokit.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Menu
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../authors.html">
   Authors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cite_us.html">
   Cite us
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../examples/index.html">
   Examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/bio_eventrelated/bio_eventrelated.html">
     Event-related Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/bio_intervalrelated/bio_intervalrelated.html">
     Interval-related Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/bio_custom/bio_custom.html">
     Customize your Processing Pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/ecg_hrv/ecg_hrv.html">
     Heart Rate Varability (HRV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/ecg_heartbeats/ecg_heartbeats.html">
     Extract and Visualize Individual Heartbeats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/ecg_delineate/ecg_delineate.html">
     Locate P, Q, S and T waves in ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/ecg_edr/ecg_edr.html">
     ECG-Derived Respiration (EDR)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/ecg_generate_12leads/ecg_generate_12leads.html">
     Generating Abnormal 12-leads ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/eda_peaks/eda_peaks.html">
     Analyze Electrodermal Activity (EDA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/rsp_rrv/rsp_rrv.html">
     Respiratory Rate Variability (RRV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/eog_analyze/eog_analyze.html">
     Analyze Electrooculography EOG data (eye blinks, saccades, etc.)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/signal_simulation/signal_simulation.html">
     Simulate Artificial Physiological Signals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/eeg_power/eeg_power.html">
     EEG Power in Frequency Bands
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/misc_fit_function/misc_fit_function.html">
     Fit a function to a non-linear pattern
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/misc_epochs_create/misc_epochs_create.html">
     Create epochs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Functions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="functions_bio.html">
     bio submodule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_ecg.html">
     ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_ppg.html">
     PPG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_hrv.html">
     HRV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_rsp.html">
     RSP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_eda.html">
     EDA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_emg.html">
     EMG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_eog.html">
     EOG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_eeg.html">
     EEG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_microstates.html">
     Microstates
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Signal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_events.html">
     Events
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_epochs.html">
     Epochs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_data.html">
     Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_complexity.html">
     Complexity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_markov.html">
     Markov Chains
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_stats.html">
     Stats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_misc.html">
     Misc
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions_benchmark.html">
     Benchmarking
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../resources/index.html">
   Resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/learn_python.html">
     Learn Python in 10 minutes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/contributing.html">
     Contributing guide
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/recording.html">
     Recording good quality signals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/resources.html">
     Additional Resources
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../studies/index.html">
   Studies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference external" href="https://www.mdpi.com/1424-8220/21/12/3998">
     HRV Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://psyarxiv.com/mwa6x/">
     HRV Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://psyarxiv.com/f8k3x/">
     Complexity Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../studies/complexity_benchmark.html">
     Complexity Benchmark
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../studies/ecg_benchmark.html">
     ECG Benchmark
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../studies/erp_gam.html">
     EEG Analysis with GAMs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../studies/eog_blinktemplate.html">
     EOG blink template
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/neuropsychology/NeuroKit">
   Repository
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit/issues/new?title=Issue%20on%20page%20%2Ffunctions/functions_signal.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit/edit/dev/docs_wip/functions/functions_signal.rst"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/functions/functions_signal.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-simulate">
   <em>
    signal_simulate()
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preprocessing">
     Preprocessing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-filter">
   <em>
    signal_filter()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-sanitize">
   <em>
    signal_sanitize()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-resample">
   <em>
    signal_resample()
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transformation">
     Transformation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-binarize">
   <em>
    signal_binarize()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-decompose">
   <em>
    signal.decompose()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-recompose">
   <em>
    signal_recompose()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-detrend">
   <em>
    signal_detrend()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-distort">
   <em>
    signal_distort()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-flatline">
   <em>
    signal_flatline()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-interpolate">
   <em>
    signal_interpolate()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-merge">
   <em>
    signal_merge()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-noise">
   <em>
    signal_noise()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-surrogate">
   <em>
    signal_surrogate()
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#peaks">
     Peaks
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-findpeaks">
   <em>
    signal_findpeaks()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-fixpeaks">
   <em>
    signal_fixpeaks()
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis">
     Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-autocor">
   <em>
    signal_autocor()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-changepoints">
   <em>
    signal_changepoints()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-period">
   <em>
    signal_period()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-phase">
   <em>
    signal_phase()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-plot">
   <em>
    signal_plot()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-power">
   <em>
    signal_power()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-psd">
   <em>
    signal_psd()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-rate">
   <em>
    signal_rate()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-smooth">
   <em>
    signal_smooth()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-synchrony">
   <em>
    signal_synchrony()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-timefrequency">
   <em>
    signal_timefrequency()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-zerocrossings">
   <em>
    signal_zerocrossings()
   </em>
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Signal</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-simulate">
   <em>
    signal_simulate()
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preprocessing">
     Preprocessing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-filter">
   <em>
    signal_filter()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-sanitize">
   <em>
    signal_sanitize()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-resample">
   <em>
    signal_resample()
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transformation">
     Transformation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-binarize">
   <em>
    signal_binarize()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-decompose">
   <em>
    signal.decompose()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-recompose">
   <em>
    signal_recompose()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-detrend">
   <em>
    signal_detrend()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-distort">
   <em>
    signal_distort()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-flatline">
   <em>
    signal_flatline()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-interpolate">
   <em>
    signal_interpolate()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-merge">
   <em>
    signal_merge()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-noise">
   <em>
    signal_noise()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-surrogate">
   <em>
    signal_surrogate()
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#peaks">
     Peaks
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-findpeaks">
   <em>
    signal_findpeaks()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-fixpeaks">
   <em>
    signal_fixpeaks()
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis">
     Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-autocor">
   <em>
    signal_autocor()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-changepoints">
   <em>
    signal_changepoints()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-period">
   <em>
    signal_period()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-phase">
   <em>
    signal_phase()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-plot">
   <em>
    signal_plot()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-power">
   <em>
    signal_power()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-psd">
   <em>
    signal_psd()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-rate">
   <em>
    signal_rate()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-smooth">
   <em>
    signal_smooth()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-synchrony">
   <em>
    signal_synchrony()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-timefrequency">
   <em>
    signal_timefrequency()
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-zerocrossings">
   <em>
    signal_zerocrossings()
   </em>
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="signal">
<h1>Signal<a class="headerlink" href="#signal" title="Permalink to this headline">#</a></h1>
<section id="signal-simulate">
<h2><em>signal_simulate()</em><a class="headerlink" href="#signal-simulate" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_simulate">
<span class="sig-name descname"><span class="pre">signal_simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_simulate.html#signal_simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_simulate" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Simulate a continuous signal</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>float</em>) – Desired length of duration (s).</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The desired sampling rate (in Hz, i.e., samples/second).</p></li>
<li><p><strong>frequency</strong> (<em>float or list</em>) – Oscillatory frequency of the signal (in Hz, i.e., oscillations per second).</p></li>
<li><p><strong>amplitude</strong> (<em>float or list</em>) – Amplitude of the oscillations.</p></li>
<li><p><strong>noise</strong> (<em>float</em>) – Noise level (amplitude of the laplace noise).</p></li>
<li><p><strong>silent</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code> (default), might print warnings if impossible frequencies are queried.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – The simulated signal.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [3]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;1Hz&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;2Hz&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;Multi&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">amplitude</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="gp">   ...: </span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">   ...: </span>
<span class="gh">Out[3]: </span><span class="go">&lt;AxesSubplot:&gt;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_simulate1.png"><img alt="../_images/p_signal_simulate1.png" src="../_images/p_signal_simulate1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

<section id="preprocessing">
<h3>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">#</a></h3>
</section>
</section>
<section id="signal-filter">
<h2><em>signal_filter()</em><a class="headerlink" href="#signal-filter" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_filter">
<span class="sig-name descname"><span class="pre">signal_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'butterworth'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">powerline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_filter.html#signal_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_filter" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Filter a signal using “butterworth”, “fir” or “savgol” filters</strong></p>
<p>Apply a lowpass (if “highcut” frequency is provided), highpass (if “lowcut” frequency is
provided) or bandpass (if both are provided) filter to the signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.
or <code class="docutils literal notranslate"><span class="pre">&quot;bandstop&quot;</span></code>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
<li><p><strong>lowcut</strong> (<em>float</em>) – Lower cutoff frequency in Hz. The default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>highcut</strong> (<em>float</em>) – Upper cutoff frequency in Hz. The default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;butterworth&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;fir&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bessel&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;savgol&quot;</span></code>. Note that for
Butterworth, the function uses the SOS method from <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.sosfiltfilt()</span></code>,
recommended for general purpose filtering. One can also specify <code class="docutils literal notranslate"><span class="pre">&quot;butterworth_ba&quot;</span></code> for a
more traditional and legacy method (often implemented in other software).</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;butterworth&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;savgol&quot;</span></code>. Order of the filter (default
is 2).</p></li>
<li><p><strong>window_size</strong> (<em>int</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;savgol&quot;</span></code>. The length of the filter window (i.e. the number of
coefficients). Must be an odd integer. If default, will be set to the sampling rate
divided by 10 (101 if the sampling rate is 1000 Hz).</p></li>
<li><p><strong>powerline</strong> (<em>int</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;powerline&quot;</span></code>.
The powerline frequency (normally 50 Hz or 60Hz).</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, plot the filtered signal as an overlay of the original.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_detrend" title="neurokit2.signal_detrend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_detrend</span></code></a>, <a class="reference internal" href="#neurokit2.signal_psd" title="neurokit2.signal_psd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_psd</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>array</em> – Vector containing the filtered signal.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># Low freq</span>

<span class="gp">In [5]: </span><span class="n">signal</span> <span class="o">+=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># High freq</span>

<span class="go"># Visualize Lowpass Filtered Signal using Different Methods</span>
<span class="gp">In [6]: </span><span class="n">fig1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Raw&quot;</span><span class="p">:</span> <span class="n">signal</span><span class="p">,</span>
<span class="gp">   ...: </span>                   <span class="s2">&quot;Butter_2&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth&quot;</span><span class="p">,</span>
<span class="gp">   ...: </span>                    <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">   ...: </span>                   <span class="s2">&quot;Butter_2_BA&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">   ...: </span>                    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth_ba&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">   ...: </span>                   <span class="s2">&quot;Butter_5&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth&quot;</span><span class="p">,</span>
<span class="gp">   ...: </span>                    <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">   ...: </span>                   <span class="s2">&quot;Butter_5_BA&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">   ...: </span>                    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth_ba&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">   ...: </span>                   <span class="s2">&quot;Bessel_2&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;bessel&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">   ...: </span>                   <span class="s2">&quot;Bessel_5&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;bessel&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">   ...: </span>                   <span class="s2">&quot;FIR&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fir&quot;</span><span class="p">)})</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_filter1.png"><img alt="../_images/p_signal_filter1.png" src="../_images/p_signal_filter1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Visualize Highpass Filtered Signal using Different Methods</span>
<span class="gp">In [7]: </span><span class="n">fig2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Raw&quot;</span><span class="p">:</span> <span class="n">signal</span><span class="p">,</span>
<span class="gp">   ...: </span>                    <span class="s2">&quot;Butter_2&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth&quot;</span><span class="p">,</span>
<span class="gp">   ...: </span>                    <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">   ...: </span>                    <span class="s2">&quot;Butter_2_ba&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">   ...: </span>                    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth_ba&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">   ...: </span>                    <span class="s2">&quot;Butter_5&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth&quot;</span><span class="p">,</span>
<span class="gp">   ...: </span>                    <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">   ...: </span>                    <span class="s2">&quot;Butter_5_BA&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">   ...: </span>                    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth_ba&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">   ...: </span>                    <span class="s2">&quot;Bessel_2&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;bessel&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">   ...: </span>                    <span class="s2">&quot;Bessel_5&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;bessel&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">   ...: </span>                    <span class="s2">&quot;FIR&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fir&quot;</span><span class="p">)})</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_filter2.png"><img alt="../_images/p_signal_filter2.png" src="../_images/p_signal_filter2.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Using Bandpass Filtering in real-life scenarios</span>
<span class="go"># Simulate noisy respiratory signal</span>
<span class="gp">In [8]: </span><span class="n">original</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;breathmetrics&quot;</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_distort</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">noise_frequency</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">noise_amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">   ...: </span>                          <span class="n">powerline_amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="go"># Bandpass between 10 and 30 breaths per minute (respiratory rate range)</span>
<span class="gp">In [10]: </span><span class="n">fig3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Raw&quot;</span><span class="p">:</span> <span class="n">signal</span><span class="p">,</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Butter_2&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">30</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span>
<span class="gp">   ....: </span>                                                  <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Butter_2_BA&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">30</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span>
<span class="gp">   ....: </span>                                                     <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth_ba&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Butter_5&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">30</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span>
<span class="gp">   ....: </span>                                                  <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Butter_5_BA&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">30</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span>
<span class="gp">   ....: </span>                                                     <span class="n">method</span><span class="o">=</span><span class="s2">&quot;butterworth_ba&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Bessel_2&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">30</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span>
<span class="gp">   ....: </span>                                                  <span class="n">method</span><span class="o">=</span><span class="s2">&quot;bessel&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Bessel_5&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">30</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span>
<span class="gp">   ....: </span>                                                  <span class="n">method</span><span class="o">=</span><span class="s2">&quot;bessel&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;FIR&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">30</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span>
<span class="gp">   ....: </span>                                             <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fir&quot;</span><span class="p">),</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Savgol&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;savgol&quot;</span><span class="p">)})</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_filter3.png"><img alt="../_images/p_signal_filter3.png" src="../_images/p_signal_filter3.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-sanitize">
<h2><em>signal_sanitize()</em><a class="headerlink" href="#signal-sanitize" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_sanitize">
<span class="sig-name descname"><span class="pre">signal_sanitize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_sanitize.html#signal_sanitize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_sanitize" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Reset indexing for Pandas Series</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>signal</strong> (<em>Series</em>) – The indexed input signal (<code class="docutils literal notranslate"><span class="pre">pandas</span> <span class="pre">Dataframe.set_index()</span></code>)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Series</em> – The default indexed signal</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [3]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">))]})</span>

<span class="gp">In [5]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">default_index_signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_sanitize</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="signal-resample">
<h2><em>signal_resample()</em><a class="headerlink" href="#signal-resample" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_resample">
<span class="sig-name descname"><span class="pre">signal_resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'interpolation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_resample.html#signal_resample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_resample" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Resample a continuous signal to a different length or sampling rate</strong></p>
<p>Up- or down-sample a signal. The user can specify either a desired length for the vector, or
input the original sampling rate and the desired sampling rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>desired_length</strong> (<em>int</em>) – The desired length of the signal.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The original sampling frequency (in Hz, i.e., samples/second).</p></li>
<li><p><strong>desired_sampling_rate</strong> (<em>int</em>) – The desired (output) sampling frequency (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Can be <code class="docutils literal notranslate"><span class="pre">&quot;interpolation&quot;</span></code> (see <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.zoom()</span></code>), <code class="docutils literal notranslate"><span class="pre">&quot;numpy&quot;</span></code> for numpy’s
interpolation (see <code class="docutils literal notranslate"><span class="pre">np.interp()</span></code>),``”pandas”`` for Pandas’ time series resampling,
<code class="docutils literal notranslate"><span class="pre">&quot;poly&quot;</span></code> (see <code class="docutils literal notranslate"><span class="pre">scipy.signal.resample_poly()</span></code>) or <code class="docutils literal notranslate"><span class="pre">&quot;FFT&quot;</span></code> (see
<code class="docutils literal notranslate"><span class="pre">scipy.signal.resample()</span></code>) for the Fourier method. <code class="docutils literal notranslate"><span class="pre">&quot;FFT&quot;</span></code> is the most accurate
(if the signal is periodic), but becomes exponentially slower as the signal length
increases. In contrast, <code class="docutils literal notranslate"><span class="pre">&quot;interpolation&quot;</span></code> is the fastest, followed by <code class="docutils literal notranslate"><span class="pre">&quot;numpy&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;poly&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;pandas&quot;</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – Vector containing resampled signal values.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>

<span class="go"># Downsample</span>
<span class="gp">In [5]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="gp">In [6]: </span><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;interpolation&quot;</span><span class="p">,</span> <span class="s2">&quot;FFT&quot;</span><span class="p">,</span> <span class="s2">&quot;poly&quot;</span><span class="p">,</span> <span class="s2">&quot;numpy&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas&quot;</span><span class="p">]:</span>
<span class="gp">   ...: </span>    <span class="n">data</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_resample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">desired_length</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>

<span class="gp">In [8]: </span><span class="n">downsampled_interpolation</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_resample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;interpolation&quot;</span><span class="p">,</span>
<span class="gp">   ...: </span>                                               <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [9]: </span><span class="n">downsampled_fft</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_resample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;FFT&quot;</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [10]: </span><span class="n">downsampled_poly</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_resample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;poly&quot;</span><span class="p">,</span>
<span class="gp">   ....: </span>                                      <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [11]: </span><span class="n">downsampled_numpy</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_resample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;numpy&quot;</span><span class="p">,</span>
<span class="gp">   ....: </span>                                       <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [12]: </span><span class="n">downsampled_pandas</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_resample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pandas&quot;</span><span class="p">,</span>
<span class="gp">   ....: </span>                                        <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="go"># Upsample</span>
<span class="gp">In [13]: </span><span class="n">upsampled_interpolation</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_resample</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">downsampled_interpolation</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;interpolation&quot;</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">1000</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [14]: </span><span class="n">upsampled_fft</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_resample</span><span class="p">(</span><span class="n">downsampled_fft</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;FFT&quot;</span><span class="p">,</span>
<span class="gp">   ....: </span>                                   <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [15]: </span><span class="n">upsampled_poly</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_resample</span><span class="p">(</span><span class="n">downsampled_poly</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;poly&quot;</span><span class="p">,</span>
<span class="gp">   ....: </span>                                    <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [16]: </span><span class="n">upsampled_numpy</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_resample</span><span class="p">(</span><span class="n">downsampled_numpy</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;numpy&quot;</span><span class="p">,</span>
<span class="gp">   ....: </span>                                     <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [17]: </span><span class="n">upsampled_pandas</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_resample</span><span class="p">(</span><span class="n">downsampled_pandas</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pandas&quot;</span><span class="p">,</span>
<span class="gp">   ....: </span>                                      <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="go"># Compare with original</span>
<span class="gp">In [18]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Original&quot;</span><span class="p">:</span> <span class="n">signal</span><span class="p">,</span>
<span class="gp">   ....: </span>                    <span class="s2">&quot;Interpolation&quot;</span><span class="p">:</span> <span class="n">upsampled_interpolation</span><span class="p">,</span>
<span class="gp">   ....: </span>                    <span class="s2">&quot;FFT&quot;</span><span class="p">:</span> <span class="n">upsampled_fft</span><span class="p">,</span>
<span class="gp">   ....: </span>                    <span class="s2">&quot;Poly&quot;</span><span class="p">:</span> <span class="n">upsampled_poly</span><span class="p">,</span>
<span class="gp">   ....: </span>                    <span class="s2">&quot;Numpy&quot;</span><span class="p">:</span> <span class="n">upsampled_numpy</span><span class="p">,</span>
<span class="gp">   ....: </span>                    <span class="s2">&quot;Pandas&quot;</span><span class="p">:</span> <span class="n">upsampled_pandas</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;.-&quot;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [19]: </span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_resample1.png"><img alt="../_images/p_signal_resample1.png" src="../_images/p_signal_resample1.png" style="width: 1200.0px; height: 1200.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Timing benchmarks</span>
<span class="gp">In [20]: </span><span class="o">%</span><span class="k">timeit</span> nk.signal_resample(signal, method=&quot;interpolation&quot;,
<span class="gp">   ....: </span>                           <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="o">%</span><span class="k">timeit</span> nk.signal_resample(signal, method=&quot;FFT&quot;,
<span class="gp">   ....: </span>                           <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="o">%</span><span class="k">timeit</span> nk.signal_resample(signal, method=&quot;poly&quot;,
<span class="gp">   ....: </span>                           <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="o">%</span><span class="k">timeit</span> nk.signal_resample(signal, method=&quot;numpy&quot;,
<span class="gp">   ....: </span>                           <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="o">%</span><span class="k">timeit</span> nk.signal_resample(signal, method=&quot;pandas&quot;,
<span class="gp">   ....: </span>                           <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">desired_sampling_rate</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_interpolate" title="neurokit2.signal_interpolate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_interpolate</span></code></a></p>
</div>
</dd></dl>

<section id="transformation">
<h3>Transformation<a class="headerlink" href="#transformation" title="Permalink to this headline">#</a></h3>
</section>
</section>
<section id="signal-binarize">
<h2><em>signal_binarize()</em><a class="headerlink" href="#signal-binarize" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_binarize">
<span class="sig-name descname"><span class="pre">signal_binarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'threshold'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_binarize.html#signal_binarize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_binarize" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Binarize a continuous signal</strong></p>
<p>Convert a continuous signal into zeros and ones depending on a given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The algorithm used to discriminate between the two states. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;mixture&quot;</span></code>
(default) or <code class="docutils literal notranslate"><span class="pre">&quot;threshold&quot;</span></code>. If <code class="docutils literal notranslate"><span class="pre">&quot;mixture&quot;</span></code>, will use a Gaussian Mixture Model to
categorize between the two states. If <code class="docutils literal notranslate"><span class="pre">&quot;threshold&quot;</span></code>, will consider as activated all
points which value is superior to the threshold.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – If <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;mixture&quot;</span></code>, then it corresponds to the minimum probability required to
be considered as activated (if <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code>, then 0.5). If <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;threshold&quot;</span></code>,
then it corresponds to the minimum amplitude to detect as onset. If <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code>, takes the
value between the max and the min.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>list</em> – A list or array depending on the type passed.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>

<span class="gp">In [5]: </span><span class="n">binary</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_binarize</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Raw&quot;</span><span class="p">:</span> <span class="n">signal</span><span class="p">,</span> <span class="s2">&quot;Binary&quot;</span><span class="p">:</span> <span class="n">binary</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gh">Out[6]: </span><span class="go">&lt;AxesSubplot:&gt;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_binarize.png"><img alt="../_images/p_signal_binarize.png" src="../_images/p_signal_binarize.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-decompose">
<h2><em>signal.decompose()</em><a class="headerlink" href="#signal-decompose" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_decompose">
<span class="sig-name descname"><span class="pre">signal_decompose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'emd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_decompose.html#signal_decompose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_decompose" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Decompose a signal</strong></p>
<p>Signal decomposition into different sources using different methods, such as Empirical Mode
Decomposition (EMD) or Singular spectrum analysis (SSA)-based signal separation method.</p>
<p>The extracted components can then be recombined into meaningful sources using
<a class="reference internal" href="#neurokit2.signal_recompose" title="neurokit2.signal_recompose"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_recompose()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – Vector of values.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The decomposition method. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;emd&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;ssa&quot;</span></code>.</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of components to extract. Only used for <code class="docutils literal notranslate"><span class="pre">&quot;ssa&quot;</span></code> method. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, will default
to 50.</p></li>
<li><p><strong>**kwargs</strong> – Other arguments passed to other functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Array</em> – Components of the decomposed signal.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_recompose" title="neurokit2.signal_recompose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_recompose</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Create complex signal</span>
<span class="gp">In [2]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># High freq</span>

<span class="gp">In [3]: </span><span class="n">signal</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># Higher freq</span>

<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>  <span class="c1"># Add baseline and trend</span>

<span class="gp">In [5]: </span><span class="n">signal</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_decompose1.png"><img alt="../_images/p_signal_decompose1.png" src="../_images/p_signal_decompose1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Example 1: Using the EMD method</span>
<span class="gp">In [7]: </span><span class="n">components</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_decompose</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;emd&quot;</span><span class="p">)</span>

<span class="go"># Visualize Decomposed Signal Components</span>
<span class="gp">In [8]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_decompose2.png"><img alt="../_images/p_signal_decompose2.png" src="../_images/p_signal_decompose2.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Example 2: USing the SSA method</span>
<span class="gp">In [9]: </span><span class="n">components</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_decompose</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;ssa&quot;</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="go"># Visualize Decomposed Signal Components</span>
<span class="gp">In [10]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>  <span class="c1"># Visualize components</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_decompose3.png"><img alt="../_images/p_signal_decompose3.png" src="../_images/p_signal_decompose3.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-recompose">
<h2><em>signal_recompose()</em><a class="headerlink" href="#signal-recompose" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_recompose">
<span class="sig-name descname"><span class="pre">signal_recompose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wcorr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_recompose.html#signal_recompose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_recompose" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Combine signal sources after decomposition</strong></p>
<p>Combine and reconstruct meaningful signal sources after signal decomposition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>components</strong> (<em>array</em>) – Array of components obtained via <a class="reference internal" href="#neurokit2.signal_decompose" title="neurokit2.signal_decompose"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_decompose()</span></code></a>.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The decomposition method. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;wcorr&quot;</span></code>.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – The threshold used to group components together.</p></li>
<li><p><strong>keep_sd</strong> (<em>float</em>) – If a float is specified, will only keep the reconstructed components that are superior
or equal to that percentage of the max standard deviaiton (SD) of the components. For
instance, <code class="docutils literal notranslate"><span class="pre">keep_sd=0.01</span></code> will remove all components with SD lower than 1% of the
max SD. This can be used to filter out noise.</p></li>
<li><p><strong>**kwargs</strong> – Other arguments used to override, for instance <code class="docutils literal notranslate"><span class="pre">metric=&quot;chebyshev&quot;</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Array</em> – Components of the recomposed components.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Create complex signal</span>
<span class="gp">In [2]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># High freq</span>

<span class="gp">In [3]: </span><span class="n">signal</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># Higher freq</span>

<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>  <span class="c1"># Add baseline and trend</span>

<span class="gp">In [5]: </span><span class="n">signal</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="go"># Decompose signal</span>
<span class="gp">In [6]: </span><span class="n">components</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_decompose</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;emd&#39;</span><span class="p">)</span>

<span class="go"># Recompose</span>
<span class="gp">In [7]: </span><span class="n">recomposed</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_recompose</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;wcorr&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.90</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>  <span class="c1"># Visualize components</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_recompose1.png"><img alt="../_images/p_signal_recompose1.png" src="../_images/p_signal_recompose1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-detrend">
<h2><em>signal_detrend()</em><a class="headerlink" href="#signal-detrend" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_detrend">
<span class="sig-name descname"><span class="pre">signal_detrend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'polynomial'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_detrend.html#signal_detrend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_detrend" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Polynomial detrending of signal</strong></p>
<p>Apply a baseline (order = 0), linear (order = 1), or polynomial (order &gt; 1) detrending to the
signal (i.e., removing a general trend). One can also use other methods, such as smoothness
priors approach described by Tarvainen (2002) or LOESS regression, but these scale badly for
long signals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;polynomial&quot;</span></code> (default; traditional detrending of a given order) or
<code class="docutils literal notranslate"><span class="pre">&quot;tarvainen2002&quot;</span></code> to use the smoothness priors approach described by Tarvainen (2002)
(mostly used in HRV analyses as a lowpass filter to remove complex trends), <code class="docutils literal notranslate"><span class="pre">&quot;loess&quot;</span></code> for
LOESS smoothing trend removal or <code class="docutils literal notranslate"><span class="pre">&quot;locreg&quot;</span></code> for local linear regression (the <em>‘runline’</em>
algorithm from chronux).</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;polynomial&quot;</span></code>. The order of the polynomial. 0, 1 or &gt; 1 for a
baseline (‘constant detrend’, i.e., remove only the mean), linear (remove the linear trend)
or polynomial detrending, respectively. Can also be <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code>, in which case it will
attempt to find the optimal order to minimize the RMSE.</p></li>
<li><p><strong>regularization</strong> (<em>int</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method=&quot;tarvainen2002&quot;</span></code>. The regularization parameter (default to 500).</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method</span></code> is “loess”. The parameter which controls the degree of smoothing.</p></li>
<li><p><strong>window</strong> (<em>float</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method</span></code> is “locreg”. The detrending <code class="docutils literal notranslate"><span class="pre">window</span></code> should correspond to the
desired low frequency band to remove multiplied by the sampling rate
(for instance, <code class="docutils literal notranslate"><span class="pre">1.5*1000</span></code> will remove frequencies below 1.5Hz for a signal sampled at
1000Hz).</p></li>
<li><p><strong>stepsize</strong> (<em>float</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;locreg&quot;</span></code>. Similarly to <code class="docutils literal notranslate"><span class="pre">window</span></code>, <code class="docutils literal notranslate"><span class="pre">stepsize</span></code> should also
be multiplied by the sampling rate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – Vector containing the detrended signal.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_filter" title="neurokit2.signal_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_filter</span></code></a>, <a class="reference internal" href="functions_stats.html#neurokit2.fit_loess" title="neurokit2.fit_loess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_loess</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [4]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="go"># Simulate signal with low and high frequency</span>
<span class="gp">In [5]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">amplitude</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">)))</span>  <span class="c1"># Add baseline and linear trend</span>

<span class="go"># Apply detrending algorithms</span>
<span class="go"># Method 1: Default Polynomial Detrending of a Given Order</span>
<span class="go"># Constant detrend (removes the mean)</span>
<span class="gp">In [7]: </span><span class="n">baseline</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_detrend</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="go"># Linear Detrend (removes the linear trend)</span>
<span class="gp">In [8]: </span><span class="n">linear</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_detrend</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="go"># Polynomial Detrend (removes the polynomial trend)</span>
<span class="gp">In [9]: </span><span class="n">quadratic</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_detrend</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Quadratic detrend</span>

<span class="gp">In [10]: </span><span class="n">cubic</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_detrend</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Cubic detrend</span>

<span class="gp">In [11]: </span><span class="n">poly10</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_detrend</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Linear detrend (10th order)</span>

<span class="go"># Method 2: Tarvainen&#39;s smoothness priors approach (Tarvainen et al., 2002)</span>
<span class="gp">In [12]: </span><span class="n">tarvainen</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_detrend</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;tarvainen2002&quot;</span><span class="p">)</span>

<span class="go"># Method 3: LOESS smoothing trend removal</span>
<span class="gp">In [13]: </span><span class="n">loess</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_detrend</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;loess&quot;</span><span class="p">)</span>

<span class="go"># Method 4: Local linear regression (100Hz)</span>
<span class="gp">In [14]: </span><span class="n">locreg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_detrend</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;locreg&quot;</span><span class="p">,</span>
<span class="gp">   ....: </span>                           <span class="n">window</span><span class="o">=</span><span class="mf">1.5</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mf">0.02</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="go"># Visualize different methods</span>
<span class="gp">In [15]: </span><span class="n">axes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Original signal&quot;</span><span class="p">:</span> <span class="n">signal</span><span class="p">,</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Baseline&quot;</span><span class="p">:</span> <span class="n">baseline</span><span class="p">,</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Linear&quot;</span><span class="p">:</span> <span class="n">linear</span><span class="p">,</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Quadratic&quot;</span><span class="p">:</span> <span class="n">quadratic</span><span class="p">,</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Cubic&quot;</span><span class="p">:</span> <span class="n">cubic</span><span class="p">,</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Polynomial (10th)&quot;</span><span class="p">:</span> <span class="n">poly10</span><span class="p">,</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Tarvainen&quot;</span><span class="p">:</span> <span class="n">tarvainen</span><span class="p">,</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;LOESS&quot;</span><span class="p">:</span> <span class="n">loess</span><span class="p">,</span>
<span class="gp">   ....: </span>                     <span class="s2">&quot;Local Regression&quot;</span><span class="p">:</span> <span class="n">locreg</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="go"># Plot horizontal lines to better visualize the detrending</span>
<span class="gp">In [16]: </span><span class="k">for</span> <span class="n">subplot</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
<span class="gp">   ....: </span>    <span class="n">subplot</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/signal_detrend1.png"><img alt="../_images/signal_detrend1.png" src="../_images/signal_detrend1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Tarvainen, M. P., Ranta-Aho, P. O., &amp; Karjalainen, P. A. (2002). An advanced detrending
method with application to HRV analysis. IEEE Transactions on Biomedical Engineering, 49(2),
172-175</p></li>
</ul>
</dd></dl>

</section>
<section id="signal-distort">
<h2><em>signal_distort()</em><a class="headerlink" href="#signal-distort" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_distort">
<span class="sig-name descname"><span class="pre">signal_distort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'laplace'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">powerline_amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">powerline_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">artifacts_amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">artifacts_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">artifacts_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_drift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_distort.html#signal_distort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_distort" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Signal distortion</strong></p>
<p>Add noise of a given frequency, amplitude and shape to a signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
<li><p><strong>noise_shape</strong> (<em>str</em>) – The shape of the noise. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;laplace&quot;</span></code> (default) or
<code class="docutils literal notranslate"><span class="pre">&quot;gaussian&quot;</span></code>.</p></li>
<li><p><strong>noise_amplitude</strong> (<em>float</em>) – The amplitude of the noise (the scale of the random function, relative
to the standard deviation of the signal).</p></li>
<li><p><strong>noise_frequency</strong> (<em>float</em>) – The frequency of the noise (in Hz, i.e., samples/second).</p></li>
<li><p><strong>powerline_amplitude</strong> (<em>float</em>) – The amplitude of the powerline noise (relative to the standard
deviation of the signal).</p></li>
<li><p><strong>powerline_frequency</strong> (<em>float</em>) – The frequency of the powerline noise (in Hz, i.e., samples/second).</p></li>
<li><p><strong>artifacts_amplitude</strong> (<em>float</em>) – The amplitude of the artifacts (relative to the standard deviation of
the signal).</p></li>
<li><p><strong>artifacts_frequency</strong> (<em>int</em>) – The frequency of the artifacts (in Hz, i.e., samples/second).</p></li>
<li><p><strong>artifacts_number</strong> (<em>int</em>) – The number of artifact bursts. The bursts have a random duration
between 1 and 10% of the signal duration.</p></li>
<li><p><strong>linear_drift</strong> (<em>bool</em>) – Whether or not to add linear drift to the signal.</p></li>
<li><p><strong>random_state</strong> (<em>int</em>) – Seed for the random number generator. Keep it fixed for reproducible
results.</p></li>
<li><p><strong>silent</strong> (<em>bool</em>) – Whether or not to display warning messages.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – Vector containing the distorted signal.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="go"># Noise</span>
<span class="gp">In [5]: </span><span class="n">noise</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Freq100&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_distort</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise_frequency</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span>
<span class="gp">   ...: </span>                     <span class="s2">&quot;Freq50&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_distort</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise_frequency</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
<span class="gp">   ...: </span>                     <span class="s2">&quot;Freq10&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_distort</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise_frequency</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
<span class="gp">   ...: </span>                     <span class="s2">&quot;Freq5&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_distort</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise_frequency</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">   ...: </span>                     <span class="s2">&quot;Raw&quot;</span><span class="p">:</span> <span class="n">signal</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_distort1.png"><img alt="../_images/p_signal_distort1.png" src="../_images/p_signal_distort1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Artifacts</span>
<span class="gp">In [6]: </span><span class="n">artifacts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;1Hz&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_distort</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise_amplitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">   ...: </span>                                                  <span class="n">artifacts_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">   ...: </span>                                                  <span class="n">artifacts_amplitude</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
<span class="gp">   ...: </span>                         <span class="s2">&quot;5Hz&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_distort</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise_amplitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">   ...: </span>                                                  <span class="n">artifacts_frequency</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">   ...: </span>                                                  <span class="n">artifacts_amplitude</span><span class="o">=</span><span class="mf">0.2</span><span class="p">),</span>
<span class="gp">   ...: </span>                         <span class="s2">&quot;Raw&quot;</span><span class="p">:</span> <span class="n">signal</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_distort2.png"><img alt="../_images/p_signal_distort2.png" src="../_images/p_signal_distort2.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-flatline">
<h2><em>signal_flatline()</em><a class="headerlink" href="#signal-flatline" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_flatline">
<span class="sig-name descname"><span class="pre">signal_flatline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_flatline.html#signal_flatline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_flatline" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Return the Flatline Percentage of the Signal</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>threshold</strong> (<em>float, optional</em>) – Flatline threshold relative to the biggest change in the signal.
This is the percentage of the maximum value of absolute consecutive
differences.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – Percentage of signal where the absolute value of the derivative is lower then the threshold.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_flatline</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="gh">Out[3]: </span><span class="go">0.008</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="signal-interpolate">
<h2><em>signal_interpolate()</em><a class="headerlink" href="#signal-interpolate" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_interpolate">
<span class="sig-name descname"><span class="pre">signal_interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'quadratic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_interpolate.html#signal_interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_interpolate" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Interpolate a signal</strong></p>
<p>Interpolate a signal using different methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_values</strong> (<em>Union[list, np.array, pd.Series]</em>) – The samples corresponding to the values to be interpolated.</p></li>
<li><p><strong>y_values</strong> (<em>Union[list, np.array, pd.Series]</em>) – The values to be interpolated.</p></li>
<li><p><strong>x_new</strong> (<em>Union[list, np.array, pd.Series] or int</em>) – The samples at which to interpolate the y_values. Samples before the first value in x_values
or after the last value in x_values will be extrapolated. If an integer is passed, nex_x
will be considered as the desired length of the interpolated signal between the first and
the last values of x_values. No extrapolation will be done for values before or after the
first and the last values of x_values.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Method of interpolation. Can be <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;zero&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;slinear&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;quadratic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;cubic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;previous&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;next&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;monotone_cubic&quot;</span></code>. The
methods <code class="docutils literal notranslate"><span class="pre">&quot;zero&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;slinear&quot;</span></code>,``”quadratic”`` and <code class="docutils literal notranslate"><span class="pre">&quot;cubic&quot;</span></code> refer to a spline
interpolation of zeroth, first, second or third order; whereas <code class="docutils literal notranslate"><span class="pre">&quot;previous&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&quot;next&quot;</span></code> simply return the previous or next value of the point. An integer specifying the
order of the spline interpolator to use.
See <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.PchipInterpolator.html">here</a> for details on the <code class="docutils literal notranslate"><span class="pre">&quot;monotone_cubic&quot;</span></code> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – Vector of interpolated samples.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="go"># Generate Simulated Signal</span>
<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="go"># We want to interpolate to 2000 samples</span>
<span class="gp">In [5]: </span><span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">),</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">x_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="go"># Visualize all interpolation methods</span>
<span class="gp">In [7]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span>
<span class="gp">   ...: </span>    <span class="n">nk</span><span class="o">.</span><span class="n">signal_interpolate</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">x_new</span><span class="o">=</span><span class="n">x_new</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;zero&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>    <span class="n">nk</span><span class="o">.</span><span class="n">signal_interpolate</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">x_new</span><span class="o">=</span><span class="n">x_new</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>    <span class="n">nk</span><span class="o">.</span><span class="n">signal_interpolate</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">x_new</span><span class="o">=</span><span class="n">x_new</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;quadratic&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>    <span class="n">nk</span><span class="o">.</span><span class="n">signal_interpolate</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">x_new</span><span class="o">=</span><span class="n">x_new</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;cubic&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>    <span class="n">nk</span><span class="o">.</span><span class="n">signal_interpolate</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">x_new</span><span class="o">=</span><span class="n">x_new</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;previous&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>    <span class="n">nk</span><span class="o">.</span><span class="n">signal_interpolate</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">x_new</span><span class="o">=</span><span class="n">x_new</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;next&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>    <span class="n">nk</span><span class="o">.</span><span class="n">signal_interpolate</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">x_new</span><span class="o">=</span><span class="n">x_new</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;monotone_cubic&quot;</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="p">],</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Zero&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Quadratic&quot;</span><span class="p">,</span> <span class="s2">&quot;Cubic&quot;</span><span class="p">,</span> <span class="s2">&quot;Previous&quot;</span><span class="p">,</span> <span class="s2">&quot;Next&quot;</span><span class="p">,</span> <span class="s2">&quot;Monotone Cubic&quot;</span><span class="p">])</span>
<span class="gp">   ...: </span>

<span class="go"># Add original data points</span>
<span class="gp">In [8]: </span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;original datapoints&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gh">Out[8]: </span><span class="go">&lt;matplotlib.collections.PathCollection at 0x7f6c00b54ee0&gt;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_interpolate1.png"><img alt="../_images/p_signal_interpolate1.png" src="../_images/p_signal_interpolate1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-merge">
<h2><em>signal_merge()</em><a class="headerlink" href="#signal-merge" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_merge">
<span class="sig-name descname"><span class="pre">signal_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">10]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">10]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_merge.html#signal_merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_merge" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Arbitrary addition of two signals with different time ranges</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal1</strong> (<em>Union[list, np.array, pd.Series]</em>) – The first signal (i.e., a time series)s in the form of a vector of values.</p></li>
<li><p><strong>signal2</strong> (<em>Union[list, np.array, pd.Series]</em>) – The second signal (i.e., a time series)s in the form of a vector of values.</p></li>
<li><p><strong>time1</strong> (<em>list</em>) – Lists containing two numeric values corresponding to the beginning and end of <code class="docutils literal notranslate"><span class="pre">signal1</span></code>.</p></li>
<li><p><strong>time2</strong> (<em>list</em>) – Same as above, but for <code class="docutils literal notranslate"><span class="pre">signal2</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – Vector containing the sum of the two signals.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [4]: </span><span class="n">signal1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>

<span class="gp">In [5]: </span><span class="n">signal2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>

<span class="gp">In [6]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_merge</span><span class="p">(</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">time1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">time2</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="gp">In [7]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_merge_1.png"><img alt="../_images/p_signal_merge_1.png" src="../_images/p_signal_merge_1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-noise">
<h2><em>signal_noise()</em><a class="headerlink" href="#signal-noise" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_noise">
<span class="sig-name descname"><span class="pre">signal_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_noise.html#signal_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_noise" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Simulate noise</strong></p>
<p>This function generates pure Gaussian <code class="docutils literal notranslate"><span class="pre">(1/f)**beta</span></code> noise. The power-spectrum of the generated
noise is proportional to <code class="docutils literal notranslate"><span class="pre">S(f)</span> <span class="pre">=</span> <span class="pre">(1</span> <span class="pre">/</span> <span class="pre">f)**beta</span></code>. The following categories of noise have been
described:</p>
<ul class="simple">
<li><p>violet noise: beta = -2</p></li>
<li><p>blue noise: beta = -1</p></li>
<li><p>white noise: beta = 0</p></li>
<li><p>flicker / pink noise: beta = 1</p></li>
<li><p>brown noise: beta = 2</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>float</em>) – Desired length of duration (s).</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The desired sampling rate (in Hz, i.e., samples/second).</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – The noise exponent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>noise</strong> (<em>array</em>) – The signal of pure noise.</p>
</dd>
</dl>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Timmer, J., &amp; Koenig, M. (1995). On generating power law noise. Astronomy and Astrophysics,
300, 707.</p></li>
<li><p><a class="reference external" href="https://github.com/felixpatzelt/colorednoise">https://github.com/felixpatzelt/colorednoise</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Colors_of_noise">https://en.wikipedia.org/wiki/Colors_of_noise</a></p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="go"># Generate pure noise</span>
<span class="gp">In [3]: </span><span class="n">violet</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_noise</span><span class="p">(</span><span class="n">beta</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">blue</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_noise</span><span class="p">(</span><span class="n">beta</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">white</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_noise</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">pink</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_noise</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">brown</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_noise</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="go"># Visualize</span>
<span class="gp">In [8]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">violet</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> <span class="n">white</span><span class="p">,</span> <span class="n">pink</span><span class="p">,</span> <span class="n">brown</span><span class="p">],</span>
<span class="gp">   ...: </span>                <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">   ...: </span>                <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Violet&quot;</span><span class="p">,</span> <span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="s2">&quot;White&quot;</span><span class="p">,</span> <span class="s2">&quot;Pink&quot;</span><span class="p">,</span> <span class="s2">&quot;Brown&quot;</span><span class="p">])</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_noise1.png"><img alt="../_images/p_signal_noise1.png" src="../_images/p_signal_noise1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Visualize spectrum</span>
<span class="gp">In [9]: </span><span class="n">psd_violet</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">violet</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fft&quot;</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">psd_blue</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">blue</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fft&quot;</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">psd_white</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">white</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fft&quot;</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">psd_pink</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">pink</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fft&quot;</span><span class="p">)</span>

<span class="gp">In [13]: </span><span class="n">psd_brown</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">brown</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fft&quot;</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">psd_violet</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">],</span> <span class="n">psd_violet</span><span class="p">[</span><span class="s2">&quot;Power&quot;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;violet&quot;</span><span class="p">)</span>
<span class="gh">Out[14]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7f6c09f1edd0&gt;]</span>

<span class="gp">In [15]: </span><span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">psd_blue</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">],</span> <span class="n">psd_blue</span><span class="p">[</span><span class="s2">&quot;Power&quot;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="gh">Out[15]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7f6bf5307040&gt;]</span>

<span class="gp">In [16]: </span><span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">psd_white</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">],</span> <span class="n">psd_white</span><span class="p">[</span><span class="s2">&quot;Power&quot;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>
<span class="gh">Out[16]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7f6c0548ebf0&gt;]</span>

<span class="gp">In [17]: </span><span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">psd_pink</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">],</span> <span class="n">psd_pink</span><span class="p">[</span><span class="s2">&quot;Power&quot;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;pink&quot;</span><span class="p">)</span>
<span class="gh">Out[17]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7f6bf56e0070&gt;]</span>

<span class="gp">In [18]: </span><span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">psd_brown</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">],</span> <span class="n">psd_brown</span><span class="p">[</span><span class="s2">&quot;Power&quot;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;brown&quot;</span><span class="p">)</span>
<span class="gh">Out[18]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7f6c03231450&gt;]</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_noise2.png"><img alt="../_images/p_signal_noise2.png" src="../_images/p_signal_noise2.png" style="width: 1200.0px; height: 1200.0px;" /></a>
</dd></dl>

</section>
<section id="signal-surrogate">
<h2><em>signal_surrogate()</em><a class="headerlink" href="#signal-surrogate" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_surrogate">
<span class="sig-name descname"><span class="pre">signal_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'IAAFT'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_surrogate.html#signal_surrogate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_surrogate" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Create Signal Surrogates</strong></p>
<p>Generate a surrogate version of a signal. Different methods are available, such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code>: Performs a random permutation of the signal value. This way, the signal
distribution is unaffected and the serial correlations are cancelled, yielding a whitened
signal with an distribution identical to that of the original.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;IAAFT&quot;</span></code>: Returns an Iterative Amplitude Adjusted Fourier Transform (IAAFT) surrogate.
It is a phase randomized, amplitude adjusted surrogates with the same power spectrum (to a
very high accuracy) and distribution as the original data, using an iterative scheme.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Can be <code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;IAAFT&quot;</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Other keywords arguments, such as <a href="#id1"><span class="problematic" id="id2">``</span></a>max_iter``(by default 1000).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>surrogate</strong> (<em>array</em>) – Surrogate signal.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create surrogates using different methods.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="gp">In [3]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">noise</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">surrogate_iaaft</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_surrogate</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;IAAFT&quot;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">surrogate_random</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_surrogate</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">surrogate_random</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Random Surrogate&quot;</span><span class="p">)</span>
<span class="gh">Out[6]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7f6c09d57280&gt;]</span>

<span class="gp">In [7]: </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">surrogate_iaaft</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;IAAFT Surrogate&quot;</span><span class="p">)</span>
<span class="gh">Out[7]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7f6c09fc9c60&gt;]</span>

<span class="gp">In [8]: </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Original&quot;</span><span class="p">)</span>
<span class="gh">Out[8]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7f6c09fca6b0&gt;]</span>

<span class="gp">In [9]: </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gh">Out[9]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x7f6c07271c30&gt;</span>

<span class="gp">In [10]: </span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_surrogate1.png"><img alt="../_images/p_signal_surrogate1.png" src="../_images/p_signal_surrogate1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p>As we can see, the signal pattern is destroyed by random surrogates, but not in the IAAFT one.
And their distributions are identical:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">nk</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">signal</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Original&quot;</span><span class="p">)</span>
<span class="gh">Out[11]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7f6c01db3940&gt;]</span>

<span class="gp">In [12]: </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">nk</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">surrogate_iaaft</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;IAAFT Surrogate&quot;</span><span class="p">)</span>
<span class="gh">Out[12]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7f6c09d77610&gt;]</span>

<span class="gp">In [13]: </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">nk</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">surrogate_random</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Random Surrogate&quot;</span><span class="p">)</span>
<span class="gh">Out[13]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x7f6c09d76fb0&gt;]</span>

<span class="gp">In [14]: </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gh">Out[14]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x7f6c084b7c40&gt;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_surrogate2.png"><img alt="../_images/p_signal_surrogate2.png" src="../_images/p_signal_surrogate2.png" style="width: 640.0px; height: 480.0px;" /></a>
<p>However, the power spectrum of the IAAFT surrogate is preserved.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">f</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">max_frequency</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="gp">In [16]: </span><span class="n">f</span><span class="p">[</span><span class="s2">&quot;IAAFT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">surrogate_iaaft</span><span class="p">,</span> <span class="n">max_frequency</span><span class="o">=</span><span class="mi">20</span><span class="p">)[</span><span class="s2">&quot;Power&quot;</span><span class="p">]</span>

<span class="gp">In [17]: </span><span class="n">f</span><span class="p">[</span><span class="s2">&quot;Random&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">surrogate_random</span><span class="p">,</span> <span class="n">max_frequency</span><span class="o">=</span><span class="mi">20</span><span class="p">)[</span><span class="s2">&quot;Power&quot;</span><span class="p">]</span>

<span class="gp">In [18]: </span><span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Power&quot;</span><span class="p">,</span> <span class="s2">&quot;IAAFT&quot;</span><span class="p">,</span> <span class="s2">&quot;Random&quot;</span><span class="p">])</span>
<span class="gh">Out[18]: </span><span class="go">&lt;AxesSubplot:xlabel=&#39;Frequency&#39;&gt;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_surrogate3.png"><img alt="../_images/p_signal_surrogate3.png" src="../_images/p_signal_surrogate3.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Schreiber, T., &amp; Schmitz, A. (1996). Improved surrogate data for nonlinearity tests. Physical
review letters, 77(4), 635.</p></li>
</ul>
</dd></dl>

<section id="peaks">
<h3>Peaks<a class="headerlink" href="#peaks" title="Permalink to this headline">#</a></h3>
</section>
</section>
<section id="signal-findpeaks">
<h2><em>signal_findpeaks()</em><a class="headerlink" href="#signal-findpeaks" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_findpeaks">
<span class="sig-name descname"><span class="pre">signal_findpeaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_height_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_height_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_median</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_findpeaks.html#signal_findpeaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_findpeaks" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Find peaks in a signal</strong></p>
<p>Locate peaks (local maxima) in a signal and their related characteristics, such as height
(prominence), width and distance with other peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>height_min</strong> (<em>float</em>) – The minimum height (i.e., amplitude in terms of absolute values). For example,
<code class="docutils literal notranslate"><span class="pre">height_min=20</span></code> will remove all peaks which height is smaller or equal to 20 (in the
provided signal’s values).</p></li>
<li><p><strong>height_max</strong> (<em>float</em>) – The maximum height (i.e., amplitude in terms of absolute values).</p></li>
<li><p><strong>relative_height_min</strong> (<em>float</em>) – The minimum height (i.e., amplitude) relative to the sample (see below). For example,
<code class="docutils literal notranslate"><span class="pre">relative_height_min=-2.96</span></code> will remove all peaks which height lies below 2.96 standard
deviations from the mean of the heights.</p></li>
<li><p><strong>relative_height_max</strong> (<em>float</em>) – The maximum height (i.e., amplitude) relative to the sample (see below).</p></li>
<li><p><strong>relative_mean</strong> (<em>bool</em>) – If a relative threshold is specified, how should it be computed (i.e., relative to what?).
<code class="docutils literal notranslate"><span class="pre">relative_mean=True</span></code> will use Z-scores.</p></li>
<li><p><strong>relative_median</strong> (<em>bool</em>) – If a relative threshold is specified, how should it be computed (i.e., relative to what?).
Relative to median uses a more robust form of standardization (see <a class="reference internal" href="functions_stats.html#neurokit2.standardize" title="neurokit2.standardize"><code class="xref py py-func docutils literal notranslate"><span class="pre">standardize()</span></code></a>).</p></li>
<li><p><strong>relative_max</strong> (<em>bool</em>) – If a relative threshold is specified, how should it be computed (i.e., relative to what?).
Relative to max will consider the maximum height as the reference.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>dict</em> –</p>
<p>Returns a dict itself containing 5 arrays:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Peaks&quot;</span></code>: contains the peaks indices (as relative to the given signal). For instance,
the value 3 means that the third data point of the signal is a peak.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Distance&quot;</span></code>: contains, for each peak, the closest distance with another peak. Note
that these values will be recomputed after filtering to match the selected peaks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Height&quot;</span></code>: contains the prominence of each peak.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.peak_prominences()</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Width&quot;</span></code>: contains the width of each peak. See <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.peak_widths()</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Onset&quot;</span></code>: contains the onset, start (or left trough), of each peak.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Offset&quot;</span></code>: contains the offset, end (or right trough), of each peak.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Simulate a Signal</span>
<span class="gp">In [2]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_findpeaks</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>

<span class="go"># Visualize Onsets of Peaks and Peaks of Signal</span>
<span class="gp">In [4]: </span><span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">([</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Onsets&quot;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;Peaks&quot;</span><span class="p">]],</span> <span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_findpeaks1.png"><img alt="../_images/p_signal_findpeaks1.png" src="../_images/p_signal_findpeaks1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="kn">import</span> <span class="nn">scipy.misc</span>

<span class="go"># Load actual ECG Signal</span>
<span class="gp">In [6]: </span><span class="n">ecg</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">electrocardiogram</span><span class="p">()</span>

<span class="gp">In [7]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">ecg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1000</span><span class="p">]</span>

<span class="go"># Find Unfiltered and Filtered Peaks</span>
<span class="gp">In [8]: </span><span class="n">info1</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_findpeaks</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">relative_height_min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">info2</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_findpeaks</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">relative_height_min</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="go"># Visualize Peaks</span>
<span class="gp">In [10]: </span><span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">([</span><span class="n">info1</span><span class="p">[</span><span class="s2">&quot;Peaks&quot;</span><span class="p">],</span> <span class="n">info2</span><span class="p">[</span><span class="s2">&quot;Peaks&quot;</span><span class="p">]],</span> <span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_findpeaks2.png"><img alt="../_images/p_signal_findpeaks2.png" src="../_images/p_signal_findpeaks2.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_fixpeaks" title="neurokit2.signal_fixpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_fixpeaks</span></code></a></p>
</div>
</dd></dl>

</section>
<section id="signal-fixpeaks">
<h2><em>signal_fixpeaks()</em><a class="headerlink" href="#signal-fixpeaks" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_fixpeaks">
<span class="sig-name descname"><span class="pre">signal_fixpeaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_interval_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_interval_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Kubios'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_fixpeaks.html#signal_fixpeaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_fixpeaks" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Correct Erroneous Peak Placements</strong></p>
<p>Identify and correct erroneous peak placements based on outliers in peak-to-peak differences
(period).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the peaks occur. If an array is passed in, it is assumed that it was
obtained with <a class="reference internal" href="#neurokit2.signal_findpeaks" title="neurokit2.signal_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_findpeaks()</span></code></a>. If a DataFrame is passed in, it is assumed to be
obtained with <a class="reference internal" href="functions_ecg.html#neurokit2.ecg.ecg_findpeaks" title="neurokit2.ecg.ecg_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">ecg_findpeaks()</span></code></a> or <a class="reference internal" href="functions_ppg.html#neurokit2.ppg.ppg_findpeaks" title="neurokit2.ppg.ppg_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">ppg_findpeaks()</span></code></a> and to be of the same length
as the input signal.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal that contains the peaks (in Hz, i.e., samples/second).</p></li>
<li><p><strong>iterative</strong> (<em>bool</em>) – Whether or not to apply the artifact correction repeatedly (results in superior artifact
correction).</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – Whether or not to visualize artifacts and artifact thresholds.</p></li>
<li><p><strong>interval_min</strong> (<em>float</em>) – Only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">&quot;neurokit&quot;</span></code>. The minimum interval between the peaks.</p></li>
<li><p><strong>interval_max</strong> (<em>float</em>) – Only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">&quot;neurokit&quot;</span></code>. The maximum interval between the peaks.</p></li>
<li><p><strong>relative_interval_min</strong> (<em>float</em>) – Only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">&quot;neurokit&quot;</span></code>. The minimum interval between the peaks as relative to
the sample (expressed in standard deviation from the mean).</p></li>
<li><p><strong>relative_interval_max</strong> (<em>float</em>) – Only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">&quot;neurokit&quot;</span></code>. The maximum interval between the peaks as relative to
the sample (expressed in standard deviation from the mean).</p></li>
<li><p><strong>robust</strong> (<em>bool</em>) – Only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">&quot;neurokit&quot;</span></code>. Use a robust method of standardization (see
<cite>standardize</cite>) for the relative thresholds.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">&quot;Kubios&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;neurokit&quot;</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;Kubios&quot;</span></code> uses the artifact detection and
correction described in Lipponen, J. A., &amp; Tarvainen, M. P. (2019). Note that <code class="docutils literal notranslate"><span class="pre">&quot;Kubios&quot;</span></code>
is only meant for peaks in ECG or PPG. <code class="docutils literal notranslate"><span class="pre">&quot;neurokit&quot;</span></code> can be used with peaks in ECG, PPG,
or respiratory data.</p></li>
<li><p><strong>**kwargs</strong> – Other keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>peaks_clean</strong> (<em>array</em>) – The corrected peak locations.</p></li>
<li><p><strong>artifacts</strong> (<em>dict</em>) – Only if <code class="docutils literal notranslate"><span class="pre">method=&quot;Kubios&quot;</span></code>. A dictionary containing the indices of artifacts, accessible
with the keys <code class="docutils literal notranslate"><span class="pre">&quot;ectopic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;missed&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;extra&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;longshort&quot;</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_findpeaks" title="neurokit2.signal_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_findpeaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">ecg_findpeaks</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">ecg_peaks</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">ppg_findpeaks</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">ppg_peaks</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Simulate ECG data</span>
<span class="gp">In [2]: </span><span class="n">ecg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">240</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">heart_rate</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="go"># Identify and Correct Peaks using &quot;Kubios&quot; Method</span>
<span class="gp">In [3]: </span><span class="n">rpeaks_uncorrected</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_findpeaks</span><span class="p">(</span><span class="n">ecg</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">artifacts</span><span class="p">,</span> <span class="n">rpeaks_corrected</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_fixpeaks</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="n">rpeaks_uncorrected</span><span class="p">,</span> <span class="n">iterative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Kubios&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">   ...: </span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_fixpeaks1.png"><img alt="../_images/p_signal_fixpeaks1.png" src="../_images/p_signal_fixpeaks1.png" style="width: 1500.0px; height: 1000.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Visualize Artifact Correction</span>
<span class="gp">In [5]: </span><span class="n">rate_corrected</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_rate</span><span class="p">(</span><span class="n">rpeaks_corrected</span><span class="p">,</span> <span class="n">desired_length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ecg</span><span class="p">))</span>

<span class="gp">In [6]: </span><span class="n">rate_uncorrected</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_rate</span><span class="p">(</span><span class="n">rpeaks_uncorrected</span><span class="p">,</span> <span class="n">desired_length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ecg</span><span class="p">))</span>

<span class="gp">In [7]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="p">[</span><span class="n">rate_uncorrected</span><span class="p">,</span> <span class="n">rate_corrected</span><span class="p">],</span>
<span class="gp">   ...: </span>    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Heart Rate Uncorrected&quot;</span><span class="p">,</span> <span class="s2">&quot;Heart Rate Corrected&quot;</span><span class="p">]</span>
<span class="gp">   ...: </span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_fixpeaks2.png"><img alt="../_images/p_signal_fixpeaks2.png" src="../_images/p_signal_fixpeaks2.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="go"># Simulate Abnormal Signals</span>
<span class="gp">In [9]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">peaks_true</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_findpeaks</span><span class="p">(</span><span class="n">signal</span><span class="p">)[</span><span class="s2">&quot;Peaks&quot;</span><span class="p">]</span>

<span class="gp">In [11]: </span><span class="n">peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">peaks_true</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># create gaps due to missing peaks</span>

<span class="gp">In [12]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [13]: </span><span class="n">peaks_true</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_findpeaks</span><span class="p">(</span><span class="n">signal</span><span class="p">)[</span><span class="s2">&quot;Peaks&quot;</span><span class="p">]</span>

<span class="gp">In [14]: </span><span class="n">peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">peaks_true</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>  <span class="c1"># create gaps</span>

<span class="gp">In [15]: </span><span class="n">peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="p">[</span><span class="mi">1350</span><span class="p">,</span> <span class="mi">11350</span><span class="p">,</span> <span class="mi">18350</span><span class="p">]))</span>  <span class="c1"># add artifacts</span>

<span class="go"># Identify and Correct Peaks using &#39;Neurokit&#39; Method</span>
<span class="gp">In [16]: </span><span class="n">peaks_corrected</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_fixpeaks</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">peaks</span><span class="o">=</span><span class="n">peaks</span><span class="p">,</span> <span class="n">interval_min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">interval_max</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;neurokit&quot;</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="go"># Plot and shift original peaks to the right to see the difference.</span>
<span class="gp">In [17]: </span><span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">([</span><span class="n">peaks</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span> <span class="n">peaks_corrected</span><span class="p">],</span> <span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_fixpeaks3.png"><img alt="../_images/p_signal_fixpeaks3.png" src="../_images/p_signal_fixpeaks3.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Lipponen, J. A., &amp; Tarvainen, M. P. (2019). A robust algorithm for heart rate variability time
series artefact correction using novel beat classification. Journal of medical engineering &amp;
technology, 43(3), 173-181. 10.1080/03091902.2019.1640306</p></li>
</ul>
</dd></dl>

<section id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">#</a></h3>
</section>
</section>
<section id="signal-autocor">
<h2><em>signal_autocor()</em><a class="headerlink" href="#signal-autocor" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_autocor">
<span class="sig-name descname"><span class="pre">signal_autocor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">demean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fft'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_autocor.html#signal_autocor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_autocor" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Autocorrelation (ACF)</strong></p>
<p>Compute the autocorrelation of a signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – Vector of values.</p></li>
<li><p><strong>lag</strong> (<em>int</em>) – Time lag. If specified, one value of autocorrelation between signal with its lag self will
be returned.</p></li>
<li><p><strong>demean</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the mean of the signal will be subtracted from the signal before ACF
computation.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Can be <code class="docutils literal notranslate"><span class="pre">&quot;correlation&quot;</span></code> (using <code class="xref py py-func docutils literal notranslate"><span class="pre">np.correlate()</span></code>) or <code class="docutils literal notranslate"><span class="pre">&quot;fft&quot;</span></code> (Fast Fourier Transform;
default).</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, plot the autocorrelation at all values of lag.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – The cross-correlation of the signal with itself at different time lags. Minimum time lag is
0, maximum time lag is the length of the signal. Or a correlation value at a specific lag
if lag is not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – A dictionary containing additional information, such as the confidence interval.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Example 1: Using &#39;Correlation&#39; Method</span>
<span class="gp">In [2]: </span><span class="n">signal</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="gp">In [3]: </span><span class="n">r</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_autocor</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;correlate&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_autocor1.png"><img alt="../_images/p_signal_autocor1.png" src="../_images/p_signal_autocor1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Example 2: Using &#39;FFT&#39; Method</span>
<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">r</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_autocor</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">lag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fft&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_autocor2.png"><img alt="../_images/p_signal_autocor2.png" src="../_images/p_signal_autocor2.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-changepoints">
<h2><em>signal_changepoints()</em><a class="headerlink" href="#signal-changepoints" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_changepoints">
<span class="sig-name descname"><span class="pre">signal_changepoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'meanvar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_changepoints.html#signal_changepoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_changepoints" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Change Point Detection</strong></p>
<p>Only the PELT method is implemented for now.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – Vector of values.</p></li>
<li><p><strong>change</strong> (<em>str</em>) – Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;meanvar&quot;</span></code> (default), <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;var&quot;</span></code>.</p></li>
<li><p><strong>penalty</strong> (<em>float</em>) – The algorithm penalty. Defaults to <code class="docutils literal notranslate"><span class="pre">np.log(len(signal))</span></code>.</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Array</em> – Values indicating the samples at which the changepoints occur.</p></li>
<li><p><em>Fig</em> – Figure of plot of signal with markers of changepoints.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">emg_simulate</span><span class="p">(</span><span class="n">burst_number</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_changepoints</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">change</span><span class="o">=</span><span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[3]: </span><span class="go">array([1750, 2750, 4500, 5500, 7250, 8250])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_changepoints1.png"><img alt="../_images/p_signal_changepoints1.png" src="../_images/p_signal_changepoints1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Killick, R., Fearnhead, P., &amp; Eckley, I. A. (2012). Optimal detection of changepoints with a
linear computational cost. Journal of the American Statistical Association, 107(500), 1590-1598.</p></li>
</ul>
</dd></dl>

</section>
<section id="signal-period">
<h2><em>signal_period()</em><a class="headerlink" href="#signal-period" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_period">
<span class="sig-name descname"><span class="pre">signal_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'monotone_cubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_period.html#signal_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_period" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Calculate signal period from a series of peaks</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<em>Union[list, np.array, pd.DataFrame, pd.Series, dict]</em>) – The samples at which the peaks occur. If an array is passed in, it is assumed that it was
obtained with <a class="reference internal" href="#neurokit2.signal_findpeaks" title="neurokit2.signal_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_findpeaks()</span></code></a>. If a DataFrame is passed in, it is assumed it is
of the same length as the input signal in which occurrences of R-peaks are marked as “1”,
with such containers obtained with e.g., <a class="reference internal" href="functions_ecg.html#neurokit2.ecg.ecg_findpeaks" title="neurokit2.ecg.ecg_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">ecg_findpeaks()</span></code></a> or <a class="reference internal" href="functions_rsp.html#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal that contains peaks (in Hz, i.e., samples/second).
Defaults to 1000.</p></li>
<li><p><strong>desired_length</strong> (<em>int</em>) – If left at the default <code class="docutils literal notranslate"><span class="pre">None</span></code>, the returned period will have the same number of elements
as <code class="docutils literal notranslate"><span class="pre">peaks</span></code>. If set to a value larger than the sample at which the last peak occurs in the
signal (i.e., <code class="docutils literal notranslate"><span class="pre">peaks[-1]</span></code>), the returned period will be interpolated between peaks over
<code class="docutils literal notranslate"><span class="pre">desired_length</span></code> samples. To interpolate the period over the entire duration of the
signal, set <code class="docutils literal notranslate"><span class="pre">desired_length</span></code> to the number of samples in the signal. Cannot be smaller
than or equal to the sample at which the last peak occurs in the signal.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>interpolation_method</strong> (<em>str</em>) – Method used to interpolate the rate between peaks. See <a class="reference internal" href="#neurokit2.signal_interpolate" title="neurokit2.signal_interpolate"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_interpolate()</span></code></a>.
<code class="docutils literal notranslate"><span class="pre">&quot;monotone_cubic&quot;</span></code> is chosen as the default interpolation method since it ensures monotone
interpolation between data points (i.e., it prevents physiologically implausible
“overshoots” or “undershoots” in the y-direction). In contrast, the widely used cubic
spline interpolation does not ensure monotonicity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – A vector containing the period.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_findpeaks" title="neurokit2.signal_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_findpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.signal_fixpeaks" title="neurokit2.signal_fixpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_fixpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.signal_plot" title="neurokit2.signal_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_findpeaks</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">period</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_period</span><span class="p">(</span><span class="n">peaks</span><span class="o">=</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Peaks&quot;</span><span class="p">],</span> <span class="n">desired_length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>

<span class="gp">In [5]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_period.png"><img alt="../_images/p_signal_period.png" src="../_images/p_signal_period.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-phase">
<h2><em>signal_phase()</em><a class="headerlink" href="#signal-phase" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_phase">
<span class="sig-name descname"><span class="pre">signal_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'radians'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_phase.html#signal_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_phase" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Compute the phase of the signal</strong></p>
<p>The real phase has the property to rotate uniformly, leading to a uniform distribution density.
The prophase typically doesn’t fulfill this property. The following functions applies a
nonlinear transformation to the phase signal that makes its distribution exactly uniform. If a
binary vector is provided (containing 2 unique values), the function will compute the phase of
completion of each phase as denoted by each value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The values in which the phase is expressed. Can be <code class="docutils literal notranslate"><span class="pre">&quot;radians&quot;</span></code> (default),
<code class="docutils literal notranslate"><span class="pre">&quot;degrees&quot;</span></code> (for values between 0 and 360) or <code class="docutils literal notranslate"><span class="pre">&quot;percents&quot;</span></code> (for values between 0 and 1).</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_filter" title="neurokit2.signal_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_filter</span></code></a>, <a class="reference internal" href="#neurokit2.signal_zerocrossings" title="neurokit2.signal_zerocrossings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_zerocrossings</span></code></a>, <a class="reference internal" href="#neurokit2.signal_findpeaks" title="neurokit2.signal_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_findpeaks</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>array</em> – A vector containing the phase of the signal, between 0 and 2*pi.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">phase</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_phase</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">signal</span><span class="p">,</span> <span class="n">phase</span><span class="p">])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_phase1.png"><img alt="../_images/p_signal_phase1.png" src="../_images/p_signal_phase1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p>..ipython:: python</p>
<blockquote>
<div><p>rsp = nk.rsp_simulate(duration=30)
phase = nk.signal_phase(rsp, method=”degrees”)
&#64;savefig p_signal_phase2.png scale=100%
nk.signal_plot([rsp, phase])
&#64;suppress
plt.close()</p>
</div></blockquote>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Percentage of completion of two phases</span>
<span class="gp">In [5]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_binarize</span><span class="p">(</span><span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>

<span class="gp">In [6]: </span><span class="n">phase</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_phase</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;percents&quot;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">signal</span><span class="p">,</span> <span class="n">phase</span><span class="p">])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_phase3.png"><img alt="../_images/p_signal_phase3.png" src="../_images/p_signal_phase3.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-plot">
<h2><em>signal_plot()</em><a class="headerlink" href="#signal-plot" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_plot">
<span class="sig-name descname"><span class="pre">signal_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_plot.html#signal_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_plot" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Plot signal with events as vertical lines</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>array or DataFrame</em>) – Signal array (can be a dataframe with many signals).</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second). Needs to be supplied if
the data should be plotted over time in seconds. Otherwise the data is plotted over samples.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>subplots</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, each signal is plotted in a subplot.</p></li>
<li><p><strong>standardize</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, all signals will have the same scale (useful for visualisation).</p></li>
<li><p><strong>labels</strong> (<em>str or list</em>) – Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>**kwargs</strong> (<em>optional</em>) – Arguments passed to matplotlib plotting.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_plot1.png"><img alt="../_images/p_signal_plot1.png" src="../_images/p_signal_plot1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Signal2&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)),</span>
<span class="gp">   ...: </span>                     <span class="s2">&quot;Signal3&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)),</span>
<span class="gp">   ...: </span>                     <span class="s2">&quot;Signal4&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_binarize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)))})</span>
<span class="gp">   ...: </span>

<span class="gp">In [7]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;signal_1&#39;</span><span class="p">,</span> <span class="s1">&#39;signal_2&#39;</span><span class="p">,</span> <span class="s1">&#39;signal_3&#39;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">signal</span><span class="p">,</span> <span class="n">data</span><span class="p">],</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_plot2.png"><img alt="../_images/p_signal_plot2.png" src="../_images/p_signal_plot2.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-power">
<h2><em>signal_power()</em><a class="headerlink" href="#signal-power" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_power">
<span class="sig-name descname"><span class="pre">signal_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency_band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_power.html#signal_power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_power" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Compute the power of a signal in a given frequency band</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>frequency_band</strong> (<em>tuple or list</em>) – Tuple or list of tuples indicating the range of frequencies to compute the power in.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
<li><p><strong>continuous</strong> (<em>bool</em>) – Compute instant frequency, or continuous power.</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, will return a Poincaré plot. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Normalization of power by maximum PSD value. Default to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
Normalization allows comparison between different PSD methods.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments to be passed to <a class="reference internal" href="#neurokit2.signal_psd" title="neurokit2.signal_psd"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_psd()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_filter" title="neurokit2.signal_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_filter</span></code></a>, <a class="reference internal" href="#neurokit2.signal_psd" title="neurokit2.signal_psd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_psd</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>pd.DataFrame</em> – A DataFrame containing the Power Spectrum values and a plot if
<code class="docutils literal notranslate"><span class="pre">show</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="go"># Instant power</span>
<span class="gp">In [3]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<span class="gp">   ...: </span>                            <span class="n">amplitude</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">noise</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [4]: </span><span class="n">power_plot</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_power</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">frequency_band</span><span class="o">=</span><span class="p">[(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">22</span><span class="p">)],</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;welch&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_power1.png"><img alt="../_images/p_signal_power1.png" src="../_images/p_signal_power1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p>..ipython:: python</p>
<blockquote>
<div><p># Continuous (simulated signal)
signal = np.concatenate((nk.ecg_simulate(duration=30, heart_rate=75), nk.ecg_simulate(duration=30, heart_rate=85)))
power = nk.signal_power(signal, frequency_band=[(72/60, 78/60), (82/60, 88/60)], continuous=True)
processed, _ = nk.ecg_process(signal)
power[“ECG_Rate”] = processed[“ECG_Rate”]</p>
<p>&#64;savefig p_signal_power2.png scale=100%
nk.signal_plot(power, standardize=True)
&#64;suppress
plt.close()</p>
</div></blockquote>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Continuous (real signal)</span>
<span class="gp">In [5]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;bio_eventrelated_100hz&quot;</span><span class="p">)[</span><span class="s2">&quot;ECG&quot;</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">power</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_power</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">frequency_band</span><span class="o">=</span><span class="p">[(</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)],</span> <span class="n">continuous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">processed</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_process</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">power</span><span class="p">[</span><span class="s2">&quot;ECG_Rate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed</span><span class="p">[</span><span class="s2">&quot;ECG_Rate&quot;</span><span class="p">]</span>

<span class="gp">In [9]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_power3.png"><img alt="../_images/p_signal_power3.png" src="../_images/p_signal_power3.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-psd">
<h2><em>signal_psd()</em><a class="headerlink" href="#signal-psd" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_psd">
<span class="sig-name descname"><span class="pre">signal_psd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'welch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hann'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'KIC'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_corrected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_psd.html#signal_psd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_psd" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Compute the Power Spectral Density (PSD)</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">&quot;welch&quot;</span></code> (default), <code class="docutils literal notranslate"><span class="pre">&quot;fft&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;multitapers&quot;</span></code> (requires the ‘mne’ package),
<code class="docutils literal notranslate"><span class="pre">&quot;lombscargle&quot;</span></code> (requires the ‘astropy’ package) or <code class="docutils literal notranslate"><span class="pre">&quot;burg&quot;</span></code>.</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, will return a plot. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, will return the density values that can be
plotted externally.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Normalization of power by maximum PSD value. Default to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
Normalization allows comparison between different PSD methods.</p></li>
<li><p><strong>min_frequency</strong> (<em>str, float</em>) – The minimum frequency. If default, min_frequency is chosen based on the sampling rate and
length of signal to optimize the frequency resolution.</p></li>
<li><p><strong>max_frequency</strong> (<em>float</em>) – The maximum frequency.</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Length of each window in seconds (for “Welch” method). If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), window will be
automatically calculated to capture at least 2 cycles of min_frequency. If the length of
recording does not allow the formal, window will be default to half of the length of
recording.</p></li>
<li><p><strong>window_type</strong> (<em>str</em>) – Desired window to use. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;hann&quot;</span></code>. See <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.get_window()</span></code> for list
of windows.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – The order of autoregression (only used for autoregressive (AR) methods such as <code class="docutils literal notranslate"><span class="pre">&quot;burg&quot;</span></code>).</p></li>
<li><p><strong>order_criteria</strong> (<em>str</em>) – The criteria to automatically select order in parametric PSD (only used for autoregressive
(AR) methods such as <code class="docutils literal notranslate"><span class="pre">&quot;burg&quot;</span></code>).</p></li>
<li><p><strong>order_corrected</strong> (<em>bool</em>) – Should the order criteria (AIC or KIC) be corrected? If unsure which method to use to choose
the order, rely on the default (i.e., the corrected KIC).</p></li>
<li><p><strong>silent</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, warnings will be printed. Default to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>**kwargs</strong> (<em>optional</em>) – Keyword arguments to be passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.welch()</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_filter" title="neurokit2.signal_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_filter</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">mne.time_frequency.psd_array_multitaper</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.welch</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – A DataFrame containing the Power Spectrum values and a plot if
<code class="docutils literal notranslate"><span class="pre">show</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="go"># FFT method (based on numpy)</span>
<span class="gp">In [3]: </span><span class="n">psd_multitapers</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fft&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_psd1.png"><img alt="../_images/p_signal_psd1.png" src="../_images/p_signal_psd1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Welch method (based on scipy)</span>
<span class="gp">In [4]: </span><span class="n">psd_welch</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;welch&quot;</span><span class="p">,</span> <span class="n">min_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_psd2.png"><img alt="../_images/p_signal_psd2.png" src="../_images/p_signal_psd2.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Multitapers method (requires MNE)</span>
<span class="gp">In [5]: </span><span class="n">psd_multitapers</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;multitapers&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_psd3.png"><img alt="../_images/p_signal_psd3.png" src="../_images/p_signal_psd3.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Burg method</span>
<span class="gp">In [6]: </span><span class="n">psd_burg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;burg&quot;</span><span class="p">,</span> <span class="n">min_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_psd4.png"><img alt="../_images/p_signal_psd4.png" src="../_images/p_signal_psd4.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Lomb method (requires AstroPy)</span>
<span class="gp">In [7]: </span><span class="n">psd_lomb</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_psd</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;lomb&quot;</span><span class="p">,</span> <span class="n">min_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_psd5.png"><img alt="../_images/p_signal_psd5.png" src="../_images/p_signal_psd5.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-rate">
<h2><em>signal_rate()</em><a class="headerlink" href="#signal-rate" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_rate">
<span class="sig-name descname"><span class="pre">signal_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'monotone_cubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_rate.html#signal_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_rate" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Compute Signal Rate</strong></p>
<p>Calculate signal rate (per minute) from a series of peaks. It is a general function that works
for any series of peaks (i.e., not specific to a particular type of signal). It is computed as
<code class="docutils literal notranslate"><span class="pre">60</span> <span class="pre">/</span> <span class="pre">period</span></code>, where the period is the time between the peaks (see func:<cite>.signal_period</cite>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is implemented under <a class="reference internal" href="#neurokit2.signal_rate" title="neurokit2.signal_rate"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_rate()</span></code></a>, but it also re-exported under
different names, such as <a class="reference internal" href="functions_ecg.html#neurokit2.ecg.ecg_rate" title="neurokit2.ecg.ecg_rate"><code class="xref py py-func docutils literal notranslate"><span class="pre">ecg_rate()</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">ppg_rate()</span></code>, or <a class="reference internal" href="functions_rsp.html#neurokit2.rsp.rsp_rate" title="neurokit2.rsp.rsp_rate"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_rate()</span></code></a>. The
aliases provided for consistency.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<em>Union[list, np.array, pd.DataFrame, pd.Series, dict]</em>) – The samples at which the peaks occur. If an array is passed in, it is assumed that it was
obtained with <a class="reference internal" href="#neurokit2.signal_findpeaks" title="neurokit2.signal_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_findpeaks()</span></code></a>. If a DataFrame is passed in, it is assumed it is
of the same length as the input signal in which occurrences of R-peaks are marked as “1”,
with such containers obtained with e.g., :func:.`ecg_findpeaks` or <a class="reference internal" href="functions_rsp.html#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal that contains peaks (in Hz, i.e., samples/second).
Defaults to 1000.</p></li>
<li><p><strong>desired_length</strong> (<em>int</em>) – If left at the default None, the returned rated will have the same number of elements as
<code class="docutils literal notranslate"><span class="pre">peaks</span></code>. If set to a value larger than the sample at which the last peak occurs in the
signal (i.e., <code class="docutils literal notranslate"><span class="pre">peaks[-1]</span></code>), the returned rate will be interpolated between peaks over
<code class="docutils literal notranslate"><span class="pre">desired_length</span></code> samples. To interpolate the rate over the entire duration of the signal,
set <code class="docutils literal notranslate"><span class="pre">desired_length</span></code> to the number of samples in the signal. Cannot be smaller than or
equal to the sample at which the last peak occurs in the signal. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>interpolation_method</strong> (<em>str</em>) – Method used to interpolate the rate between peaks. See <a class="reference internal" href="#neurokit2.signal_interpolate" title="neurokit2.signal_interpolate"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_interpolate()</span></code></a>.
<code class="docutils literal notranslate"><span class="pre">&quot;monotone_cubic&quot;</span></code> is chosen as the default interpolation method since it ensures monotone
interpolation between data points (i.e., it prevents physiologically implausible
“overshoots” or “undershoots” in the y-direction). In contrast, the widely used cubic
spline interpolation does not ensure monotonicity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – A vector containing the rate (peaks per minute).</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_period" title="neurokit2.signal_period"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_period</span></code></a>, <a class="reference internal" href="#neurokit2.signal_findpeaks" title="neurokit2.signal_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_findpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.signal_fixpeaks" title="neurokit2.signal_fixpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_fixpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.signal_plot" title="neurokit2.signal_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Create signal of varying frequency</span>
<span class="gp">In [9]: </span><span class="n">freq</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">freq</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="go"># Find peaks</span>
<span class="gp">In [11]: </span><span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_findpeaks</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>

<span class="go"># Compute rate using 2 methods</span>
<span class="gp">In [12]: </span><span class="n">rate1</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_rate</span><span class="p">(</span><span class="n">peaks</span><span class="o">=</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Peaks&quot;</span><span class="p">],</span>
<span class="gp">   ....: </span>                       <span class="n">desired_length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">),</span>
<span class="gp">   ....: </span>                       <span class="n">interpolation_method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [13]: </span><span class="n">rate2</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_rate</span><span class="p">(</span><span class="n">peaks</span><span class="o">=</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Peaks&quot;</span><span class="p">],</span>
<span class="gp">   ....: </span>                       <span class="n">desired_length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">),</span>
<span class="gp">   ....: </span>                       <span class="n">interpolation_method</span><span class="o">=</span><span class="s2">&quot;monotone_cubic&quot;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="go"># Visualize signal and rate on the same scale</span>
<span class="gp">In [14]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">signal</span><span class="p">,</span> <span class="n">rate1</span><span class="p">,</span> <span class="n">rate2</span><span class="p">],</span>
<span class="gp">   ....: </span>               <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Original signal&quot;</span><span class="p">,</span> <span class="s2">&quot;Rate (nearest)&quot;</span><span class="p">,</span> <span class="s2">&quot;Rate (monotone cubic)&quot;</span><span class="p">],</span>
<span class="gp">   ....: </span>               <span class="n">standardize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_rate1.png"><img alt="../_images/p_signal_rate1.png" src="../_images/p_signal_rate1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-smooth">
<h2><em>signal_smooth()</em><a class="headerlink" href="#signal-smooth" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_smooth">
<span class="sig-name descname"><span class="pre">signal_smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'convolution'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boxzen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_smooth.html#signal_smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_smooth" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Signal smoothing</strong></p>
<p>Signal smoothing can be achieved using either the convolution of a filter kernel with the input
signal to compute the smoothed signal (Smith, 1997) or a LOESS regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;convolution&quot;</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">&quot;loess&quot;</span></code>.</p></li>
<li><p><strong>kernel</strong> (<em>Union[str, np.array]</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;convolution&quot;</span></code>. Type of kernel to use; if array, use directly
as the kernel. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;median&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;boxzen&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;boxcar&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;triang&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;blackman&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;hamming&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;hann&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bartlett&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;flattop&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;parzen&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;bohman&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;blackmanharris&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nuttall&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;barthann&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;kaiser&quot;</span></code> (needs beta), <code class="docutils literal notranslate"><span class="pre">&quot;gaussian&quot;</span></code> (needs std), <code class="docutils literal notranslate"><span class="pre">&quot;general_gaussian&quot;</span></code> (needs power
width), <code class="docutils literal notranslate"><span class="pre">&quot;slepian&quot;</span></code> (needs width) or <code class="docutils literal notranslate"><span class="pre">&quot;chebwin&quot;</span></code> (needs attenuation).</p></li>
<li><p><strong>size</strong> (<em>int</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;convolution&quot;</span></code>. Size of the kernel; ignored if kernel is an
array.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;loess&quot;</span></code>. The parameter which controls the degree of
smoothing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – Smoothed signal.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="functions_stats.html#neurokit2.fit_loess" title="neurokit2.fit_loess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_loess</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>

<span class="gp">In [5]: </span><span class="n">distorted</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_distort</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span>
<span class="gp">   ...: </span>                              <span class="n">noise_amplitude</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
<span class="gp">   ...: </span>                              <span class="n">noise_frequency</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="gp">   ...: </span>

<span class="gp">In [6]: </span><span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span>

<span class="gp">In [7]: </span><span class="n">signals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Raw&quot;</span><span class="p">:</span> <span class="n">distorted</span><span class="p">,</span>
<span class="gp">   ...: </span>                        <span class="s2">&quot;Median&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_smooth</span><span class="p">(</span><span class="n">distorted</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<span class="gp">   ...: </span>                        <span class="s2">&quot;BoxZen&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_smooth</span><span class="p">(</span><span class="n">distorted</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;boxzen&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">),</span>
<span class="gp">   ...: </span>                        <span class="s2">&quot;Triang&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_smooth</span><span class="p">(</span><span class="n">distorted</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;triang&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">),</span>
<span class="gp">   ...: </span>                        <span class="s2">&quot;Blackman&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_smooth</span><span class="p">(</span><span class="n">distorted</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;blackman&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">),</span>
<span class="gp">   ...: </span>                        <span class="s2">&quot;Loess_01&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_smooth</span><span class="p">(</span><span class="n">distorted</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;loess&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span>
<span class="gp">   ...: </span>                        <span class="s2">&quot;Loess_02&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_smooth</span><span class="p">(</span><span class="n">distorted</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;loess&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">),</span>
<span class="gp">   ...: </span>                        <span class="s2">&quot;Loess_05&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_smooth</span><span class="p">(</span><span class="n">distorted</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;loess&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)})</span>
<span class="gp">   ...: </span>

<span class="gp">In [8]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">signals</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_smooth1.png"><img alt="../_images/p_signal_smooth1.png" src="../_images/p_signal_smooth1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Magnify the plot</span>
<span class="gp">In [9]: </span><span class="n">fig_magnify</span> <span class="o">=</span> <span class="n">signals</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">150</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_smooth2.png"><img alt="../_images/p_signal_smooth2.png" src="../_images/p_signal_smooth2.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Smith, S. W. (1997). The scientist and engineer’s guide to digital signal processing.</p></li>
</ul>
</dd></dl>

</section>
<section id="signal-synchrony">
<h2><em>signal_synchrony()</em><a class="headerlink" href="#signal-synchrony" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_synchrony">
<span class="sig-name descname"><span class="pre">signal_synchrony</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hilbert'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_synchrony.html#signal_synchrony"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_synchrony" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the synchrony (coupling) between two signals.</p>
<p>Compute a continuous index of coupling between two signals either using the <code class="docutils literal notranslate"><span class="pre">&quot;hilbert&quot;</span></code>
method to get the instantaneous phase synchrony, or using rolling window correlation.</p>
<p>The instantaneous phase synchrony measures the phase similarities between signals at each
timepoint. The phase refers to the angle of the signal, calculated through the hilbert
transform, when it is resonating between -pi to pi degrees. When two signals line up in phase
their angular difference becomes zero.</p>
<p>For less clean signals, windowed correlations are widely used because of their simplicity, and
can be a good a robust approximation of synchrony between two signals. The limitation is the
need to select a window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal1</strong> (<em>Union[list, np.array, pd.Series]</em>) – Time series in the form of a vector of values.</p></li>
<li><p><strong>signal2</strong> (<em>Union[list, np.array, pd.Series]</em>) – Time series in the form of a vector of values.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The method to use. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;hilbert&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;correlation&quot;</span></code>.</p></li>
<li><p><strong>window_size</strong> (<em>int</em>) – Only used if <code class="docutils literal notranslate"><span class="pre">method='correlation'</span></code>. The number of samples to use for rolling correlation.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.signal_filter" title="neurokit2.signal_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_filter</span></code></a>, <a class="reference internal" href="#neurokit2.signal_zerocrossings" title="neurokit2.signal_zerocrossings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_zerocrossings</span></code></a>, <a class="reference internal" href="#neurokit2.signal_findpeaks" title="neurokit2.signal_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_findpeaks</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>array</em> – A vector containing the phase of the signal, between 0 and 2*pi.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">signal1</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">signal2</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">coupling_h</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_synchrony</span><span class="p">(</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;hilbert&quot;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">coupling_c</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_synchrony</span><span class="p">(</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;correlation&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">1000</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">coupling_h</span><span class="p">,</span> <span class="n">coupling_c</span><span class="p">])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_synchrony1.png"><img alt="../_images/p_signal_synchrony1.png" src="../_images/p_signal_synchrony1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="http://jinhyuncheong.com/jekyll/update/2017/12/10/Timeseries_synchrony_tutorial_and_simulations.html">http://jinhyuncheong.com/jekyll/update/2017/12/10/Timeseries_synchrony_tutorial_and_simulations.html</a></p></li>
</ul>
</dd></dl>

</section>
<section id="signal-timefrequency">
<h2><em>signal_timefrequency()</em><a class="headerlink" href="#signal-timefrequency" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_timefrequency">
<span class="sig-name descname"><span class="pre">signal_timefrequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.04</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stft'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hann'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'psd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreqbin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analytical_signal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_timefrequency.html#signal_timefrequency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_timefrequency" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Quantify changes of a nonstationary signal’s frequency over time</strong>
The objective of time-frequency analysis is to offer a more informative description of the
signal which reveals the temporal variation of its frequency contents.</p>
<p>There are many different Time-Frequency Representations (TFRs) available:</p>
<ul>
<li><p>Linear TFRs: efficient but create tradeoff between time and frequency resolution</p>
<blockquote>
<div><ul class="simple">
<li><p>Short Time Fourier Transform (STFT): the time-domain signal is windowed into short
segments and FT is applied to each segment, mapping the signal into the TF plane. This
method assumes that the signal is quasi-stationary (stationary over the duration of the
window). The width of the window is the trade-off between good time (requires short
duration window) versus good frequency resolution (requires long duration windows)</p></li>
<li><p>Wavelet Transform (WT): similar to STFT but instead of a fixed duration window function,
a varying window length by scaling the axis of the window is used. At low frequency, WT
proves high spectral resolution but poor temporal resolution. On the other hand, for high
frequencies, the WT provides high temporal resolution but poor spectral resolution.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Quadratic TFRs: better resolution but computationally expensive and suffers from having
cross terms between multiple signal components</p>
<blockquote>
<div><ul class="simple">
<li><p>Wigner Ville Distribution (WVD): while providing very good resolution in time and
frequency of the underlying signal structure, because of its bilinear nature, existence
of negative values, the WVD has misleading TF results in the case of multi-component
signals such as EEG due to the presence of cross terms and inference terms. Cross WVD
terms can be reduced by using smoothing kernel functions as well as analyzing the
analytic signal (instead of the original signal)</p></li>
<li><p>Smoothed Pseudo Wigner Ville Distribution (SPWVD): to address the problem of cross-terms
suppression, SPWVD allows two independent analysis windows, one in time and the other in
frequency domains.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Time-Frequency decomposition method.</p></li>
<li><p><strong>min_frequency</strong> (<em>float</em>) – The minimum frequency.</p></li>
<li><p><strong>max_frequency</strong> (<em>float</em>) – The maximum frequency.</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Length of each segment in seconds. If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), window will be automatically
calculated. For <code class="docutils literal notranslate"><span class="pre">&quot;STFT&quot;</span> <span class="pre">method</span></code>.</p></li>
<li><p><strong>window_type</strong> (<em>str</em>) – Type of window to create, defaults to <code class="docutils literal notranslate"><span class="pre">&quot;hann&quot;</span></code>. See <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.get_window()</span></code> to
see full options of windows. For <code class="docutils literal notranslate"><span class="pre">&quot;STFT&quot;</span> <span class="pre">method</span></code>.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – Type of return values for <code class="docutils literal notranslate"><span class="pre">&quot;STFT&quot;</span> <span class="pre">method</span></code>. Can be <code class="docutils literal notranslate"><span class="pre">&quot;psd&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;complex&quot;</span></code> (default,
equivalent to output of <code class="docutils literal notranslate"><span class="pre">&quot;STFT&quot;</span></code> with no padding or boundary extension), <code class="docutils literal notranslate"><span class="pre">&quot;magnitude&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;angle&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;phase&quot;</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;psd&quot;</span></code>.</p></li>
<li><p><strong>nfreqbin</strong> (<em>int, float</em>) – Number of frequency bins. If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), nfreqbin will be set to
<code class="docutils literal notranslate"><span class="pre">0.5*sampling_rate</span></code>.</p></li>
<li><p><strong>overlap</strong> (<em>int</em>) – Number of points to overlap between segments. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">noverlap</span> <span class="pre">=</span> <span class="pre">nperseg</span> <span class="pre">//</span> <span class="pre">8</span></code>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>analytical_signal</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, analytical signal instead of actual signal is used in <cite>Wigner Ville
Distribution</cite> methods.</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, will return two PSD plots.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>frequency</strong> (<em>np.array</em>) – Frequency.</p></li>
<li><p><strong>time</strong> (<em>np.array</em>) – Time array.</p></li>
<li><p><strong>stft</strong> (<em>np.array</em>) – Short Term Fourier Transform. Time increases across its columns and frequency increases
down the rows.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">sampling_rate</span> <span class="o">=</span> <span class="mi">100</span>

<span class="gp">In [3]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="go"># STFT Method</span>
<span class="gp">In [4]: </span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">stft</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_timefrequency</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">sampling_rate</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">max_frequency</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">method</span><span class="o">=</span><span class="s2">&quot;stft&quot;</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_timefrequency1.png"><img alt="../_images/p_signal_timefrequency1.png" src="../_images/p_signal_timefrequency1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># CWTM Method</span>
<span class="gp">In [5]: </span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">cwtm</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_timefrequency</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">sampling_rate</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">max_frequency</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">method</span><span class="o">=</span><span class="s2">&quot;cwt&quot;</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_timefrequency2.png"><img alt="../_images/p_signal_timefrequency2.png" src="../_images/p_signal_timefrequency2.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># WVD Method</span>
<span class="gp">In [6]: </span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">wvd</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_timefrequency</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span>
<span class="gp">   ...: </span>                                    <span class="n">sampling_rate</span><span class="p">,</span>
<span class="gp">   ...: </span>                                    <span class="n">max_frequency</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">   ...: </span>                                    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;wvd&quot;</span><span class="p">,</span>
<span class="gp">   ...: </span>                                    <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_timefrequency3.png"><img alt="../_images/p_signal_timefrequency3.png" src="../_images/p_signal_timefrequency3.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># PWVD Method</span>
<span class="gp">In [7]: </span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">pwvd</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_timefrequency</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">sampling_rate</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">max_frequency</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pwvd&quot;</span><span class="p">,</span>
<span class="gp">   ...: </span>                                     <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_timefrequency4.png"><img alt="../_images/p_signal_timefrequency4.png" src="../_images/p_signal_timefrequency4.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="signal-zerocrossings">
<h2><em>signal_zerocrossings()</em><a class="headerlink" href="#signal-zerocrossings" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal_zerocrossings">
<span class="sig-name descname"><span class="pre">signal_zerocrossings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_zerocrossings.html#signal_zerocrossings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal_zerocrossings" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Locate the indices where the signal crosses zero</strong></p>
<p>Note that when the signal crosses zero between two points, the first index is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The signal (i.e., a time series) in the form of a vector of values.</p></li>
<li><p><strong>direction</strong> (<em>str</em>) – Direction in which the signal crosses zero, can be <code class="docutils literal notranslate"><span class="pre">&quot;positive&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;negative&quot;</span></code> or
<code class="docutils literal notranslate"><span class="pre">&quot;both&quot;</span></code> (default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – Vector containing the indices of zero crossings.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">zeros</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_zerocrossings</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">(</span><span class="n">zeros</span><span class="p">,</span> <span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_zerocrossings1.png"><img alt="../_images/p_signal_zerocrossings1.png" src="../_images/p_signal_zerocrossings1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Only upward or downward zerocrossings</span>
<span class="gp">In [5]: </span><span class="n">up</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_zerocrossings</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;up&quot;</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">down</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_zerocrossings</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;down&quot;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">([</span><span class="n">up</span><span class="p">,</span> <span class="n">down</span><span class="p">],</span> <span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_signal_zerocrossings2.png"><img alt="../_images/p_signal_zerocrossings2.png" src="../_images/p_signal_zerocrossings2.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

<p><em>Any function appearing below this point is not explicitly part of the documentation and should be added. Please open an issue if there is one.</em></p>
<span class="target" id="module-neurokit2.signal"></span><p>Submodule for NeuroKit.</p>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.signal.signal_formatpeaks">
<span class="sig-name descname"><span class="pre">signal_formatpeaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/signal/signal_formatpeaks.html#signal_formatpeaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.signal.signal_formatpeaks" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Format Peaks</strong></p>
<p>Transforms a peak-info dict to a signal of given length</p>
</dd></dl>

</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="functions_microstates.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Microstates</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="functions_events.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Events</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By <a href="https://dominiquemakowski.github.io/">Dominique Makowski</a> and the <a href="https://github.com/neuropsychology/NeuroKit/blob/master/AUTHORS.rst">Team</a><br/>
  
      &copy; Copyright 2020–2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>
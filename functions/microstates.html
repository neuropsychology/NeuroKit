
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>M/EEG Microstates &#8212; NeuroKit2 0.2.11 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=a64840b6"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'functions/microstates';</script>
    <link rel="icon" href="../_static/icon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Signal Processing" href="signal.html" />
    <link rel="prev" title="Video Analysis" href="video.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/neurokit.png" class="logo__image only-light" alt="NeuroKit2 0.2.11 documentation - Home"/>
    <script>document.write(`<img src="../_static/neurokit.png" class="logo__image only-dark" alt="NeuroKit2 0.2.11 documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Menu</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite_us.html">Cite us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../codebook.html">Codebook</a></li>

<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/bio_eventrelated/bio_eventrelated.html">Event-related Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/bio_intervalrelated/bio_intervalrelated.html">Interval-related Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/bio_custom/bio_custom.html">Customize your Processing Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ecg_hrv/ecg_hrv.html">Heart Rate Variability (HRV)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ecg_heartbeats/ecg_heartbeats.html">Extract and Visualize Individual Heartbeats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ecg_delineate/ecg_delineate.html">Locate P, Q, S and T waves in ECG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ecg_edr/ecg_edr.html">ECG-Derived Respiration (EDR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ecg_generate_12leads/ecg_generate_12leads.html">Generating Abnormal 12-leads ECG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/eda_peaks/eda_peaks.html">Analyze Electrodermal Activity (EDA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/rsp_rrv/rsp_rrv.html">Respiratory Rate Variability (RRV)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/eog_analyze/eog_analyze.html">Analyze Electrooculography (EOG)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/signal_simulation/signal_simulation.html">Simulate Artificial Physiological Signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ppg_report/ppg_report.html">Save Preprocessing Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/eeg_power/eeg_power.html">EEG Power in Frequency Bands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/eeg_complexity/eeg_complexity.html">EEG Complexity Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/eeg_microstates/eeg_microstates.html">EEG Microstates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/misc_fit_function/misc_fit_function.html">Fit a function to a non-linear pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/misc_epochs_create/misc_epochs_create.html">Create epochs</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Functions</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bio.html">Bio</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecg.html">ECG</a></li>
<li class="toctree-l2"><a class="reference internal" href="ppg.html">PPG</a></li>
<li class="toctree-l2"><a class="reference internal" href="hrv.html">HRV</a></li>
<li class="toctree-l2"><a class="reference internal" href="rsp.html">RSP</a></li>
<li class="toctree-l2"><a class="reference internal" href="eda.html">EDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="emg.html">EMG</a></li>
<li class="toctree-l2"><a class="reference internal" href="eog.html">EOG</a></li>
<li class="toctree-l2"><a class="reference internal" href="eeg.html">EEG</a></li>
<li class="toctree-l2"><a class="reference internal" href="video.html">Video Analysis</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Microstates</a></li>
<li class="toctree-l2"><a class="reference internal" href="signal.html">Signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="epochs.html">Epochs</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="complexity.html">Complexity</a></li>
<li class="toctree-l2"><a class="reference internal" href="markov.html">Markov Chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats.html">Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">Misc</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmark.html">Benchmarking</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../resources/index.html">Resources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../resources/learn_python.html">Learn Python in 10 minutes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources/contributing.html">Contributing guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources/recording.html">Recording good quality signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources/resources.html">Additional Resources</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../studies/index.html">Studies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference external" href="https://www.mdpi.com/1424-8220/21/12/3998">HRV Review</a></li>
<li class="toctree-l2"><a class="reference external" href="https://psyarxiv.com/mwa6x/">HRV Indices</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9307944/">HRV Tutorial</a></li>
<li class="toctree-l2"><a class="reference external" href="https://onlinelibrary.wiley.com/doi/10.1111/ejn.15800">Complexity Review</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.mdpi.com/1099-4300/24/8/1036">Complexity Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../studies/complexity_eeg.html">EEG Complexity: Parameters Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../studies/erp_gam.html">EEG Analysis with GAMs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../studies/ecg_benchmark.html">ECG Benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../studies/eog_blinktemplate.html">EOG blink template</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/neuropsychology/NeuroKit">Repository</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/neuropsychology/NeuroKit" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/neuropsychology/NeuroKit/edit/dev/docs/functions/microstates.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/neuropsychology/NeuroKit/issues/new?title=Issue%20on%20page%20%2Ffunctions/microstates.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/functions/microstates.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>M/EEG Microstates</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main">Main</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-segment"><em>microstates_segment()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_segment"><code class="docutils literal notranslate"><span class="pre">microstates_segment()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-plot"><em>microstates_plot()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_plot"><code class="docutils literal notranslate"><span class="pre">microstates_plot()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-classify"><em>microstates_classify()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_classify"><code class="docutils literal notranslate"><span class="pre">microstates_classify()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-clean"><em>microstates_clean()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_clean"><code class="docutils literal notranslate"><span class="pre">microstates_clean()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-dynamic"><em>microstates_dynamic()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_dynamic"><code class="docutils literal notranslate"><span class="pre">microstates_dynamic()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-findnumber"><em>microstates_findnumber()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_findnumber"><code class="docutils literal notranslate"><span class="pre">microstates_findnumber()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-peaks"><em>microstates_peaks()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_peaks"><code class="docutils literal notranslate"><span class="pre">microstates_peaks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-static"><em>microstates_static()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_static"><code class="docutils literal notranslate"><span class="pre">microstates_static()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="m-eeg-microstates">
<h1>M/EEG Microstates<a class="headerlink" href="#m-eeg-microstates" title="Link to this heading">#</a></h1>
<section id="main">
<h2>Main<a class="headerlink" href="#main" title="Link to this heading">#</a></h2>
<section id="microstates-segment">
<h3><em>microstates_segment()</em><a class="headerlink" href="#microstates-segment" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.microstates.microstates_segment">
<span class="sig-name descname"><span class="pre">microstates_segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eeg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_microstates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gfp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kmod'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gfp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'l1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize_eeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gev'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/microstates/microstates_segment.html#microstates_segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.microstates.microstates_segment" title="Link to this definition">#</a></dt>
<dd><p><strong>Segment M/EEG signal into Microstates</strong></p>
<p>This functions identifies and extracts the microstates from an M/EEG signal using different
clustering algorithms. Several runs of the clustering algorithm are performed, using different
random initializations.The run that resulted in the best segmentation, as measured by global
explained variance (GEV), is used.</p>
<ul class="simple">
<li><p><strong>kmod</strong>: Modified k-means algorithm. It differs from a traditional k-means in that it is
<em>polarity-invariant</em>, which means that samples with EEG potential distribution maps that are
similar but have opposite polarity will be assigned the <em>same</em> microstate class.</p></li>
<li><p><strong>kmeans</strong>: Normal k-means.</p></li>
<li><p><strong>kmedoids</strong>: k-medoids clustering, a more stable version of k-means.</p></li>
<li><p><strong>pca</strong>: Principal Component Analysis.</p></li>
<li><p><strong>ica</strong>: Independent Component Analysis.</p></li>
<li><p><strong>aahc</strong>: Atomize and Agglomerate Hierarchical Clustering. Computationally heavy.</p></li>
</ul>
<p>The microstates clustering is typically fitted on the EEG data at the global field power (GFP)
peaks to maximize the signal to noise ratio and focus on moments of high global neuronal
synchronization. It is assumed that the topography around a GFP peak remains stable and is at
its highest signal-to-noise ratio at the GFP peak.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eeg</strong> (<em>np.ndarray</em>) – An array (channels, times) of M/EEG data or a Raw or Epochs object from MNE.</p></li>
<li><p><strong>n_microstates</strong> (<em>int</em>) – The number of unique microstates to find. Defaults to 4.</p></li>
<li><p><strong>train</strong> (<em>Union[str, int, float]</em>) – Method for selecting the timepoints how which to train the clustering algorithm. Can be
<code class="docutils literal notranslate"><span class="pre">&quot;gfp&quot;</span></code> to use the peaks found in the Peaks in the global field power. Can be <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>,
in which case it will select all the datapoints. It can also be a number or a ratio, in
which case it will select the corresponding number of evenly spread data points. For
instance, <code class="docutils literal notranslate"><span class="pre">train=10</span></code> will select 10 equally spaced datapoints, whereas <code class="docutils literal notranslate"><span class="pre">train=0.5</span></code> will
select half the data. See <a class="reference internal" href="#neurokit2.microstates.microstates_peaks" title="neurokit2.microstates.microstates_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">microstates_peaks()</span></code></a>.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The algorithm for clustering. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;kmod&quot;</span></code> (default), <code class="docutils literal notranslate"><span class="pre">&quot;kmeans&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;kmedoids&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pca&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;ica&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;aahc&quot;</span></code>.</p></li>
<li><p><strong>gfp_method</strong> (<em>str</em>) – The GFP extraction method, can be either <code class="docutils literal notranslate"><span class="pre">&quot;l1&quot;</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">&quot;l2&quot;</span></code> to use the L1 or L2
norm. See <code class="xref py py-func docutils literal notranslate"><span class="pre">nk.eeg_gfp()</span></code> for more details.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
<li><p><strong>standardize_eeg</strong> (<em>bool</em>) – Standardized (z-score) the data across time prior to GFP extraction
using <code class="xref py py-func docutils literal notranslate"><span class="pre">nk.standardize()</span></code>.</p></li>
<li><p><strong>n_runs</strong> (<em>int</em>) – The number of random initializations to use for the k-means algorithm. The best fitting
segmentation across all initializations is used. Defaults to 10.</p></li>
<li><p><strong>max_iterations</strong> (<em>int</em>) – The maximum number of iterations to perform in the k-means algorithm.
Defaults to 1000.</p></li>
<li><p><strong>criterion</strong> (<em>str</em>) – Which criterion to use to choose the best run for modified k-means algorithm,
can be <code class="docutils literal notranslate"><span class="pre">&quot;gev&quot;</span></code> (default) which selects the best run based on the highest global explained
variance, or <code class="docutils literal notranslate"><span class="pre">&quot;cv&quot;</span></code> which selects the best run based on the lowest cross-validation
criterion. See <code class="xref py py-func docutils literal notranslate"><span class="pre">nk.microstates_gev()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">nk.microstates_crossvalidation()</span></code> for
more details respectively.</p></li>
<li><p><strong>random_state</strong> (<em>Union[int, numpy.random.RandomState]</em>) – The seed or <code class="docutils literal notranslate"><span class="pre">RandomState</span></code> for the random number generator. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>, in which
case a different seed is chosen each time this function is called.</p></li>
<li><p><strong>optimize</strong> (<em>bool</em>) – Optimized method in Poulsen et al. (2018) for the <em>k</em>-means modified method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><em>dict</em> – Contains information about the segmented microstates:</p>
<ul class="simple">
<li><p><strong>Microstates</strong>: The topographic maps of the found unique microstates which has a shape of
n_channels x n_states</p></li>
<li><p><strong>Sequence</strong>: For each sample, the index of the microstate to which the sample has been
assigned.</p></li>
<li><p><strong>GEV</strong>: The global explained variance of the microstates.</p></li>
<li><p><strong>GFP</strong>: The global field power of the data.</p></li>
<li><p><strong>Cross-Validation Criterion</strong>: The cross-validation value of the iteration.</p></li>
<li><p><strong>Explained Variance</strong>: The explained variance of each cluster map generated by PCA.</p></li>
<li><p><strong>Total Explained Variance</strong>: The total explained variance of the cluster maps generated
by PCA.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ul class="simple">
<li><p><strong>Example 1</strong>: k-means Algorithm</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span><span class="w"> </span><span class="nn">neurokit2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nk</span>

<span class="go"># Download data</span>
<span class="gp">In [2]: </span><span class="n">eeg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">mne_data</span><span class="p">(</span><span class="s2">&quot;filt-0-40_raw&quot;</span><span class="p">)</span>

<span class="go"># Average rereference and band-pass filtering</span>
<span class="gp">In [3]: </span><span class="n">eeg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">eeg_rereference</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="go"># Cluster microstates</span>
<span class="gp">In [4]: </span><span class="n">microstates</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_segment</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">nk</span><span class="o">.</span><span class="n">microstates_plot</span><span class="p">(</span><span class="n">microstates</span> <span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">750</span><span class="p">))</span>

<span class="go"># Modified kmeans (currently comment out due to memory error)</span>
<span class="go">#out_kmod = nk.microstates_segment(eeg, method=&#39;kmod&#39;)</span>
<span class="go"># nk.microstates_plot(out_kmod, gfp=out_kmod[&quot;GFP&quot;][0:500])</span>
<span class="go"># K-medoids (currently comment out due to memory error)</span>
<span class="go">#out_kmedoids = nk.microstates_segment(eeg, method=&#39;kmedoids&#39;)</span>
<span class="go">#nk.microstates_plot(out_kmedoids, gfp=out_kmedoids[&quot;GFP&quot;][0:500])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_microstate_segment1.png"><img alt="../_images/p_microstate_segment1.png" src="../_images/p_microstate_segment1.png" style="width: 640.0px; height: 480.0px;" />
</a>
<ul class="simple">
<li><p><strong>Example with PCA</strong></p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">out_pca</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_segment</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;pca&#39;</span><span class="p">,</span> <span class="n">standardize_eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">nk</span><span class="o">.</span><span class="n">microstates_plot</span><span class="p">(</span><span class="n">out_pca</span><span class="p">,</span> <span class="n">gfp</span><span class="o">=</span><span class="n">out_pca</span><span class="p">[</span><span class="s2">&quot;GFP&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_microstate_segment2.png"><img alt="../_images/p_microstate_segment2.png" src="../_images/p_microstate_segment2.png" style="width: 640.0px; height: 480.0px;" />
</a>
<ul class="simple">
<li><p><strong>Example with ICA</strong></p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">out_ica</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_segment</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ica&#39;</span><span class="p">,</span> <span class="n">standardize_eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">nk</span><span class="o">.</span><span class="n">microstates_plot</span><span class="p">(</span><span class="n">out_ica</span><span class="p">,</span> <span class="n">gfp</span><span class="o">=</span><span class="n">out_ica</span><span class="p">[</span><span class="s2">&quot;GFP&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_microstate_segment3.png"><img alt="../_images/p_microstate_segment3.png" src="../_images/p_microstate_segment3.png" style="width: 640.0px; height: 480.0px;" />
</a>
<ul class="simple">
<li><p><strong>Example with AAHC</strong></p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">out_aahc</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_segment</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;aahc&#39;</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">nk</span><span class="o">.</span><span class="n">microstates_plot</span><span class="p">(</span><span class="n">out_aahc</span><span class="p">,</span> <span class="n">gfp</span><span class="o">=</span><span class="n">out_aahc</span><span class="p">[</span><span class="s2">&quot;GFP&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_microstate_segment4.png"><img alt="../_images/p_microstate_segment4.png" src="../_images/p_microstate_segment4.png" style="width: 640.0px; height: 480.0px;" />
</a>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eeg_gfp</span></code>, <a class="reference internal" href="#neurokit2.microstates.microstates_peaks" title="neurokit2.microstates.microstates_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">microstates_peaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">microstates_gev</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">microstates_crossvalidation</span></code>, <a class="reference internal" href="#neurokit2.microstates.microstates_classify" title="neurokit2.microstates.microstates_classify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">microstates_classify</span></code></a></p>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Poulsen, A. T., Pedroni, A., Langer, N., &amp; Hansen, L. K. (2018). Microstate EEGlab toolbox:
an introductory guide. BioRxiv, (289850).</p></li>
<li><p>Pascual-Marqui, R. D., Michel, C. M., &amp; Lehmann, D. (1995). Segmentation of brain
electrical activity into microstates: model estimation and validation. IEEE Transactions
on Biomedical Engineering.</p></li>
</ul>
</dd></dl>

</section>
<section id="microstates-plot">
<h3><em>microstates_plot()</em><a class="headerlink" href="#microstates-plot" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.microstates.microstates_plot">
<span class="sig-name descname"><span class="pre">microstates_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">microstates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segmentation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gfp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/microstates/microstates_plot.html#microstates_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.microstates.microstates_plot" title="Link to this definition">#</a></dt>
<dd><p><strong>Visualize Microstates</strong></p>
<p>Plots the clustered microstates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>microstates</strong> (<em>np.ndarray</em>) – The topographic maps of the found unique microstates which has a shape of n_channels x
n_states, generated from <a class="reference internal" href="#neurokit2.microstates.microstates_segment" title="neurokit2.microstates.microstates_segment"><code class="xref py py-func docutils literal notranslate"><span class="pre">microstates_segment()</span></code></a>.</p></li>
<li><p><strong>segmentation</strong> (<em>array</em>) – For each sample, the index of the microstate to which the sample has been assigned.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>gfp</strong> (<em>array</em>) – The range of global field power (GFP) values to visualize. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>, which will
plot the whole range of GFP values.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – The dictionary output of <code class="xref py py-func docutils literal notranslate"><span class="pre">nk.microstates_segment()</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>epoch</strong> (<em>tuple</em>) – A sub-epoch of GFP to plot in the shape <code class="docutils literal notranslate"><span class="pre">(beginning</span> <span class="pre">sample,</span> <span class="pre">end</span> <span class="pre">sample)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>fig</em> – Plot of prototypical microstates maps and GFP across time.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span><span class="w"> </span><span class="nn">neurokit2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nk</span>

<span class="go"># Download data</span>
<span class="gp">In [2]: </span><span class="n">eeg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">mne_data</span><span class="p">(</span><span class="s2">&quot;filt-0-40_raw&quot;</span><span class="p">)</span>

<span class="go"># Average rereference and band-pass filtering</span>
<span class="gp">In [3]: </span><span class="n">eeg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">eeg_rereference</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="go"># Cluster microstates</span>
<span class="gp">In [4]: </span><span class="n">microstates</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_segment</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;kmeans&#39;</span><span class="p">,</span> <span class="n">n_microstates</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">nk</span><span class="o">.</span><span class="n">microstates_plot</span><span class="p">(</span><span class="n">microstates</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">750</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_microstates_plot1.png"><img alt="../_images/p_microstates_plot1.png" src="../_images/p_microstates_plot1.png" style="width: 640.0px; height: 480.0px;" />
</a>
</dd></dl>

</section>
<section id="microstates-classify">
<h3><em>microstates_classify()</em><a class="headerlink" href="#microstates-classify" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.microstates.microstates_classify">
<span class="sig-name descname"><span class="pre">microstates_classify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">segmentation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">microstates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/microstates/microstates_classify.html#microstates_classify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.microstates.microstates_classify" title="Link to this definition">#</a></dt>
<dd><p><strong>Reorder (sort) the microstates (experimental)</strong></p>
<p>Reorder (sort) the microstates (experimental) based on the pattern of values in the vector of
channels (thus, depends on how channels are ordered).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segmentation</strong> (<em>Union[np.array, dict]</em>) – Vector containing the segmentation.</p></li>
<li><p><strong>microstates</strong> (<em>Union[np.array, dict]</em>) – Array of microstates maps . Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>segmentation, microstates</em> – Tuple containing re-ordered input.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span><span class="w"> </span><span class="nn">neurokit2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">eeg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">mne_data</span><span class="p">(</span><span class="s2">&quot;filt-0-40_raw&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">eeg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">eeg_rereference</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">)</span>

<span class="go"># Original order</span>
<span class="gp">In [4]: </span><span class="n">out</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_segment</span><span class="p">(</span><span class="n">eeg</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">nk</span><span class="o">.</span><span class="n">microstates_plot</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">gfp</span><span class="o">=</span><span class="n">out</span><span class="p">[</span><span class="s2">&quot;GFP&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="go"># Reorder</span>
<span class="gp">In [6]: </span><span class="n">out</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_classify</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s2">&quot;Sequence&quot;</span><span class="p">],</span> <span class="n">out</span><span class="p">[</span><span class="s2">&quot;Microstates&quot;</span><span class="p">])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_microstates_classify.png"><img alt="../_images/p_microstates_classify.png" src="../_images/p_microstates_classify.png" style="width: 640.0px; height: 480.0px;" />
</a>
</dd></dl>

</section>
<section id="microstates-clean">
<h3><em>microstates_clean()</em><a class="headerlink" href="#microstates-clean" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.microstates.microstates_clean">
<span class="sig-name descname"><span class="pre">microstates_clean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eeg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gfp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize_eeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gfp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'l1'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/microstates/microstates_clean.html#microstates_clean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.microstates.microstates_clean" title="Link to this definition">#</a></dt>
<dd><p><strong>Prepare eeg data for microstates extraction</strong></p>
<p>This is mostly a utility function to get the data ready for <a class="reference internal" href="#neurokit2.microstates.microstates_segment" title="neurokit2.microstates.microstates_segment"><code class="xref py py-func docutils literal notranslate"><span class="pre">microstates_segment()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eeg</strong> (<em>np.ndarray</em>) – An array (channels, times) of M/EEG data or a Raw or Epochs object from MNE.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second). Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>train</strong> (<em>Union[str, int, float]</em>) – Method for selecting the timepoints how which to train the clustering algorithm. Can be
<code class="docutils literal notranslate"><span class="pre">&quot;gfp&quot;</span></code> to use the peaks found in the global field power (GFP). Can be
<code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>, in which case it will select all the datapoints. It can also be a number or a
ratio, in which case it will select the corresponding number of evenly spread data points.
For instance, <code class="docutils literal notranslate"><span class="pre">train=10</span></code> will select 10 equally spaced datapoints, whereas <code class="docutils literal notranslate"><span class="pre">train=0.5</span></code>
will select half the data. See <a class="reference internal" href="#neurokit2.microstates.microstates_peaks" title="neurokit2.microstates.microstates_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">microstates_peaks()</span></code></a>.</p></li>
<li><p><strong>standardize_eeg</strong> (<em>bool</em>) – Standardize (z-score) the data across time using <code class="xref py py-func docutils literal notranslate"><span class="pre">nk.standardize()</span></code>, prior to GFP
extraction and running k-means algorithm. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Normalize (divide each data point by the maximum value of the data) across time prior to
GFP extraction and running k-means algorithm. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>gfp_method</strong> (<em>str</em>) – The GFP extraction method to be passed into <code class="xref py py-func docutils literal notranslate"><span class="pre">nk.eeg_gfp()</span></code>. Can be either <code class="docutils literal notranslate"><span class="pre">&quot;l1&quot;</span></code>
(default) or <code class="docutils literal notranslate"><span class="pre">&quot;l2&quot;</span></code> to use the L1 or L2 norm.</p></li>
<li><p><strong>**kwargs</strong> (<em>optional</em>) – Other arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eeg</strong> (<em>array</em>) – The eeg data which has a shape of channels x samples.</p></li>
<li><p><strong>peaks</strong> (<em>array</em>) – The index of the sample where GFP peaks occur.</p></li>
<li><p><strong>gfp</strong> (<em>array</em>) – The global field power of each sample point in the data.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Other information pertaining to the eeg raw object.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span><span class="w"> </span><span class="nn">neurokit2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">eeg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">mne_data</span><span class="p">(</span><span class="s2">&quot;filt-0-40_raw&quot;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">eeg</span><span class="p">,</span> <span class="n">peaks</span><span class="p">,</span> <span class="n">gfp</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_clean</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="s2">&quot;gfp&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="eeg.html#neurokit2.eeg.eeg_gfp" title="neurokit2.eeg.eeg_gfp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eeg_gfp</span></code></a>, <a class="reference internal" href="#neurokit2.microstates.microstates_peaks" title="neurokit2.microstates.microstates_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">microstates_peaks</span></code></a>, <a class="reference internal" href="#neurokit2.microstates.microstates_segment" title="neurokit2.microstates.microstates_segment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">microstates_segment</span></code></a></p>
</div>
</dd></dl>

</section>
<section id="microstates-dynamic">
<h3><em>microstates_dynamic()</em><a class="headerlink" href="#microstates-dynamic" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.microstates.microstates_dynamic">
<span class="sig-name descname"><span class="pre">microstates_dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">microstates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/microstates/microstates_dynamic.html#microstates_dynamic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.microstates.microstates_dynamic" title="Link to this definition">#</a></dt>
<dd><p><strong>Dynamic Properties of Microstates</strong></p>
<p>This computes statistics related to the transition pattern (based on the
<a class="reference internal" href="markov.html#neurokit2.markov.transition_matrix" title="neurokit2.markov.transition_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">transition_matrix()</span></code></a>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function does not compute all the features available under the markov submodule.
Don’t hesitate to open an issue to help us test and decide what features to include.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>microstates</strong> (<em>np.ndarray</em>) – The topographic maps of the found unique microstates which has a shape of n_channels x
n_states, generated from <code class="xref py py-func docutils literal notranslate"><span class="pre">nk.microstates_segment()</span></code>.</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – Show the transition matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>DataFrame</em> – Dynamic properties of microstates.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="markov.html#neurokit2.markov.transition_matrix" title="neurokit2.markov.transition_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transition_matrix</span></code></a>, <a class="reference internal" href="#neurokit2.microstates.microstates_static" title="neurokit2.microstates.microstates_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">microstates_static</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span><span class="w"> </span><span class="nn">neurokit2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">microstates</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="gp">In [3]: </span><span class="n">nk</span><span class="o">.</span><span class="n">microstates_dynamic</span><span class="p">(</span><span class="n">microstates</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[3]: </span>
<span class="go">   Microstate_0_to_0  Microstate_0_to_1  ...  Microstate_2_to_1  Microstate_2_to_2</span>
<span class="go">0                0.6                0.2  ...                0.2                0.8</span>

<span class="go">[1 rows x 9 columns]</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_microstates_dynamic1.png"><img alt="../_images/p_microstates_dynamic1.png" src="../_images/p_microstates_dynamic1.png" style="width: 640.0px; height: 480.0px;" />
</a>
</dd></dl>

</section>
<section id="microstates-findnumber">
<h3><em>microstates_findnumber()</em><a class="headerlink" href="#microstates-findnumber" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.microstates.microstates_findnumber">
<span class="sig-name descname"><span class="pre">microstates_findnumber</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eeg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GEV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clustering_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kmod'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/microstates/microstates_findnumber.html#microstates_findnumber"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.microstates.microstates_findnumber" title="Link to this definition">#</a></dt>
<dd><p><strong>Estimate optimal number of microstates</strong></p>
<p>Computes statistical indices useful for estimating the optimal number of microstates using a</p>
<ul class="simple">
<li><p><strong>Global Explained Variance (GEV)</strong>: measures how similar each EEG sample is to its assigned
microstate class. The <strong>higher</strong> (closer to 1), the better the segmentation.</p></li>
<li><p><strong>Krzanowski-Lai Criterion (KL)</strong>: measures quality of microstate segmentation based on the
dispersion measure (average distance between samples in the same microstate class); the
<strong>larger the KL value</strong>, the better the segmentation. Note that KL is not a polarity
invariant measure and thus might not be a suitable measure of fit for polarity-invariant
methods such as modified K-means and (T)AAHC.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eeg</strong> (<em>np.ndarray</em>) – An array (channels, times) of M/EEG data or a Raw or Epochs object from MNE.</p></li>
<li><p><strong>n_max</strong> (<em>int</em>) – Maximum number of microstates to try. A higher number leads to a longer process.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The method to use to estimate the optimal number of microstates. Can be “GEV” (the elbow,
detected using <code class="xref py py-func docutils literal notranslate"><span class="pre">find_knee()</span></code>), or “KL” (the location of the maximum value).</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – Plot indices normalized on the same scale.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Print progress bar.</p></li>
<li><p><strong>**kwargs</strong> – Arguments to be passed to <a class="reference internal" href="#neurokit2.microstates.microstates_segment" title="neurokit2.microstates.microstates_segment"><code class="xref py py-func docutils literal notranslate"><span class="pre">microstates_segment()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>int</em> – Optimal number of microstates.</p></li>
<li><p><em>DataFrame</em> – The different quality scores for each number of microstates.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.microstates.microstates_segment" title="neurokit2.microstates.microstates_segment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">microstates_segment</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span><span class="w"> </span><span class="nn">neurokit2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">eeg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">mne_data</span><span class="p">(</span><span class="s2">&quot;filt-0-40_raw&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="go"># Estimate optimal number</span>
<span class="gp">In [3]: </span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_findnumber</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">n_max</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[........................................] 0/7</span>
<span class="go">[█████...................................] 1/7</span>
<span class="go">[███████████.............................] 2/7</span>
<span class="go">[█████████████████.......................] 3/7</span>
<span class="go">[██████████████████████..................] 4/7</span>
<span class="go">[████████████████████████████............] 5/7</span>
<span class="go">[██████████████████████████████████......] 6/7</span>
<span class="go">[████████████████████████████████████████] 7/7</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_microstates_findnumber1.png"><img alt="../_images/p_microstates_findnumber1.png" src="../_images/p_microstates_findnumber1.png" style="width: 640.0px; height: 480.0px;" />
</a>
</dd></dl>

</section>
<section id="microstates-peaks">
<h3><em>microstates_peaks()</em><a class="headerlink" href="#microstates-peaks" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.microstates.microstates_peaks">
<span class="sig-name descname"><span class="pre">microstates_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eeg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gfp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_between</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/microstates/microstates_peaks.html#microstates_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.microstates.microstates_peaks" title="Link to this definition">#</a></dt>
<dd><p><strong>Find peaks of stability using the GFP</strong></p>
<p>Peaks in the global field power (GFP) are often used to find microstates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eeg</strong> (<em>np.ndarray</em>) – An array (channels, times) of M/EEG data or a Raw or Epochs object from MNE.</p></li>
<li><p><strong>gfp</strong> (<em>list</em>) – The Global Field Power (GFP). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, will be obtained via <a class="reference internal" href="eeg.html#neurokit2.eeg.eeg_gfp" title="neurokit2.eeg.eeg_gfp"><code class="xref py py-func docutils literal notranslate"><span class="pre">eeg_gfp()</span></code></a>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
<li><p><strong>distance_between</strong> (<em>float</em>) – The minimum distance (this value is to be multiplied by the sampling rate) between peaks.
The default is 0.01, which corresponds to 10 ms (as suggested in the Microstate EEGlab
toolbox).</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments to be passed to <a class="reference internal" href="eeg.html#neurokit2.eeg.eeg_gfp" title="neurokit2.eeg.eeg_gfp"><code class="xref py py-func docutils literal notranslate"><span class="pre">eeg_gfp()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>peaks</strong> (<em>array</em>) – The index of the sample where GFP peaks occur.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span><span class="w"> </span><span class="nn">neurokit2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">eeg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">mne_data</span><span class="p">(</span><span class="s2">&quot;filt-0-40_raw&quot;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">gfp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">eeg_gfp</span><span class="p">(</span><span class="n">eeg</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">peaks1</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_peaks</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">distance_between</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">peaks2</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_peaks</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">distance_between</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">peaks3</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_peaks</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">distance_between</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">([</span><span class="n">peaks1</span><span class="p">[</span><span class="n">peaks1</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">],</span> <span class="n">peaks2</span><span class="p">[</span><span class="n">peaks2</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">],</span> <span class="n">peaks3</span><span class="p">[</span><span class="n">peaks3</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">]],</span> <span class="n">gfp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">])</span>
<span class="gh">Out[7]: </span><span class="go">&lt;Figure size 640x480 with 1 Axes&gt;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_microstates_peaks1.png"><img alt="../_images/p_microstates_peaks1.png" src="../_images/p_microstates_peaks1.png" style="width: 640.0px; height: 480.0px;" />
</a>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="eeg.html#neurokit2.eeg.eeg_gfp" title="neurokit2.eeg.eeg_gfp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eeg_gfp</span></code></a></p>
</div>
</dd></dl>

</section>
<section id="microstates-static">
<h3><em>microstates_static()</em><a class="headerlink" href="#microstates-static" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.microstates.microstates_static">
<span class="sig-name descname"><span class="pre">microstates_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">microstates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/microstates/microstates_static.html#microstates_static"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.microstates.microstates_static" title="Link to this definition">#</a></dt>
<dd><p><strong>Static Properties of Microstates</strong></p>
<p>The duration of each microstate is also referred to as the Ratio of Time Covered (RTT) in
some microstates publications.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>microstates</strong> (<em>np.ndarray</em>) – The sequence .</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second). Defaults to 1000.</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – Returns a plot of microstate duration, proportion, and lifetime distribution if <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>DataFrame</em> – Values of microstates proportion, lifetime distribution and duration (median, mean, and their averages).</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.microstates.microstates_dynamic" title="neurokit2.microstates.microstates_dynamic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">microstates_dynamic</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span><span class="w"> </span><span class="nn">neurokit2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">microstates</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="gp">In [3]: </span><span class="n">nk</span><span class="o">.</span><span class="n">microstates_static</span><span class="p">(</span><span class="n">microstates</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[3]: </span>
<span class="go">   Microstate_0_Proportion  ...  Microstate_Average_DurationMedian</span>
<span class="go">0                 0.357143  ...                               0.02</span>

<span class="go">[1 rows x 14 columns]</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_microstates_static1.png"><img alt="../_images/p_microstates_static1.png" src="../_images/p_microstates_static1.png" style="width: 640.0px; height: 480.0px;" />
</a>
</dd></dl>

</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="video.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Video Analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="signal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Signal Processing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main">Main</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-segment"><em>microstates_segment()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_segment"><code class="docutils literal notranslate"><span class="pre">microstates_segment()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-plot"><em>microstates_plot()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_plot"><code class="docutils literal notranslate"><span class="pre">microstates_plot()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-classify"><em>microstates_classify()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_classify"><code class="docutils literal notranslate"><span class="pre">microstates_classify()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-clean"><em>microstates_clean()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_clean"><code class="docutils literal notranslate"><span class="pre">microstates_clean()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-dynamic"><em>microstates_dynamic()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_dynamic"><code class="docutils literal notranslate"><span class="pre">microstates_dynamic()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-findnumber"><em>microstates_findnumber()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_findnumber"><code class="docutils literal notranslate"><span class="pre">microstates_findnumber()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-peaks"><em>microstates_peaks()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_peaks"><code class="docutils literal notranslate"><span class="pre">microstates_peaks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-static"><em>microstates_static()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.microstates.microstates_static"><code class="docutils literal notranslate"><span class="pre">microstates_static()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By <a href="https://dominiquemakowski.github.io/">Dominique Makowski</a> and the <a href="https://github.com/neuropsychology/NeuroKit/blob/master/AUTHORS.rst">Team</a>. This documentation is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> license.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2020–2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>RSP &#8212; NeuroKit2 0.2.1 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <link rel="shortcut icon" href="../_static/icon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="EDA" href="eda.html" />
    <link rel="prev" title="HRV" href="hrv.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/neurokit.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Menu
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../authors.html">
   Authors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cite_us.html">
   Cite us
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../examples/index.html">
   Examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/bio_eventrelated/bio_eventrelated.html">
     Event-related Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/bio_intervalrelated/bio_intervalrelated.html">
     Interval-related Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/bio_custom/bio_custom.html">
     Customize your Processing Pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/ecg_hrv/ecg_hrv.html">
     Heart Rate Varability (HRV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/ecg_heartbeats/ecg_heartbeats.html">
     Extract and Visualize Individual Heartbeats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/ecg_delineate/ecg_delineate.html">
     Locate P, Q, S and T waves in ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/ecg_edr/ecg_edr.html">
     ECG-Derived Respiration (EDR)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/ecg_generate_12leads/ecg_generate_12leads.html">
     Generating Abnormal 12-leads ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/eda_peaks/eda_peaks.html">
     Analyze Electrodermal Activity (EDA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/rsp_rrv/rsp_rrv.html">
     Respiratory Rate Variability (RRV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/eog_analyze/eog_analyze.html">
     Analyze Electrooculography (EOG)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/signal_simulation/signal_simulation.html">
     Simulate Artificial Physiological Signals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/eeg_power/eeg_power.html">
     EEG Power in Frequency Bands
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/misc_fit_function/misc_fit_function.html">
     Fit a function to a non-linear pattern
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/misc_epochs_create/misc_epochs_create.html">
     Create epochs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Functions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="bio.html">
     Bio
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ecg.html">
     ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ppg.html">
     PPG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hrv.html">
     HRV
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     RSP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eda.html">
     EDA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="emg.html">
     EMG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eog.html">
     EOG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eeg.html">
     EEG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="microstates.html">
     Microstates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="signal.html">
     Signal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="events.html">
     Events
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="epochs.html">
     Epochs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="data.html">
     Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="complexity.html">
     Complexity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="markov.html">
     Markov Chains
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="stats.html">
     Stats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="misc.html">
     Misc
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="benchmark.html">
     Benchmarking
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../resources/index.html">
   Resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/learn_python.html">
     Learn Python in 10 minutes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/contributing.html">
     Contributing guide
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/recording.html">
     Recording good quality signals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/resources.html">
     Additional Resources
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../studies/index.html">
   Studies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference external" href="https://www.mdpi.com/1424-8220/21/12/3998">
     HRV Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://psyarxiv.com/mwa6x/">
     HRV Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://psyarxiv.com/f8k3x/">
     Complexity Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://psyarxiv.com/v5tqw/">
     Complexity Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../studies/ecg_benchmark.html">
     ECG Benchmark
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../studies/erp_gam.html">
     EEG Analysis with GAMs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../studies/eog_blinktemplate.html">
     EOG blink template
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/neuropsychology/NeuroKit">
   Repository
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit/issues/new?title=Issue%20on%20page%20%2Ffunctions/rsp.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit/edit/dev/docs/functions/rsp.rst"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/functions/rsp.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#main">
   Main
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-process">
     <em>
      rsp_process()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-analyze">
     <em>
      rsp_analyze()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-simulate">
     <em>
      rsp_simulate()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-plot">
     <em>
      rsp_plot()
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preprocessing">
   Preprocessing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-clean">
     <em>
      rsp_clean()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-amplitude">
     <em>
      rsp_amplitude()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-peaks">
     <em>
      rsp_peaks()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-findpeaks">
     <em>
      rsp_findpeaks()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-fixpeaks">
     <em>
      rsp_fixpeaks()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-phase">
     <em>
      rsp_phase()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-rate">
     <em>
      rsp_rate()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-rrv">
     <em>
      rsp_rrv()
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analysis">
   Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-eventrelated">
     <em>
      rsp_eventrelated()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-intervalrelated">
     <em>
      rsp_intervalrelated()
     </em>
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>RSP</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#main">
   Main
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-process">
     <em>
      rsp_process()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-analyze">
     <em>
      rsp_analyze()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-simulate">
     <em>
      rsp_simulate()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-plot">
     <em>
      rsp_plot()
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preprocessing">
   Preprocessing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-clean">
     <em>
      rsp_clean()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-amplitude">
     <em>
      rsp_amplitude()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-peaks">
     <em>
      rsp_peaks()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-findpeaks">
     <em>
      rsp_findpeaks()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-fixpeaks">
     <em>
      rsp_fixpeaks()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-phase">
     <em>
      rsp_phase()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-rate">
     <em>
      rsp_rate()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-rrv">
     <em>
      rsp_rrv()
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analysis">
   Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-eventrelated">
     <em>
      rsp_eventrelated()
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rsp-intervalrelated">
     <em>
      rsp_intervalrelated()
     </em>
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="rsp">
<h1>RSP<a class="headerlink" href="#rsp" title="Permalink to this headline">#</a></h1>
<section id="main">
<h2>Main<a class="headerlink" href="#main" title="Permalink to this headline">#</a></h2>
<section id="rsp-process">
<h3><em>rsp_process()</em><a class="headerlink" href="#rsp-process" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_process">
<span class="sig-name descname"><span class="pre">rsp_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'khodadad2018'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_process.html#rsp_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_process" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Process a respiration (RSP) signal</strong></p>
<p>Convenience function that automatically processes a respiration signal with one of the
following methods:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://iopscience.iop.org/article/10.1088/1361-6579/aad7e6/meta">Khodadad et al. (2018)</a></p></li>
<li><p><a class="reference external" href="https://github.com/PIA-Group/BioSPPy/blob/master/biosppy/signals/resp.py">BioSPPy</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The raw respiration channel (as measured, for instance, by a respiration belt).</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_signal()</span></code> (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The processing pipeline to apply. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code> (default)
or <code class="docutils literal notranslate"><span class="pre">&quot;biosppy&quot;</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>signals</strong> (<em>DataFrame</em>) – A DataFrame of same length as <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_signal()</span></code> containing the following columns:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Raw&quot;</span></code>: the raw signal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Clean&quot;</span></code>: the cleaned signal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code>: the respiratory peaks (exhalation onsets) marked as “1” in a list of
zeros.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code>: the respiratory troughs (inhalation onsets) marked as “1” in a list of
zeros.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate&quot;</span></code>: breathing rate interpolated between inhalation peaks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude&quot;</span></code>: breathing amplitude interpolated between inhalation peaks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase&quot;</span></code>: breathing phase, marked by “1” for inspiration and “0” for expiration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_PhaseCompletion&quot;</span></code>: breathing phase completion, expressed in percentage (from 0 to
1), representing the stage of the current respiratory phase.</p></li>
</ul>
</li>
<li><p><strong>info</strong> (<em>dict</em>) – A dictionary containing the samples at which inhalation peaks and exhalation troughs occur,
accessible with the keys <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code> respectively, as well as the
signals’ sampling rate.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_findpeaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">signals</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_plot</span><span class="p">(</span><span class="n">signals</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_process_1.png"><img alt="../_images/p_rsp_process_1.png" src="../_images/p_rsp_process_1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="rsp-analyze">
<h3><em>rsp_analyze()</em><a class="headerlink" href="#rsp-analyze" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_analyze">
<span class="sig-name descname"><span class="pre">rsp_analyze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_analyze.html#rsp_analyze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_analyze" title="Permalink to this definition">#</a></dt>
<dd><p><strong>RSP Analysis</strong></p>
<p>Performs RSP analysis on either epochs (event-related analysis) or on longer periods of data such as resting-state data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>dict or DataFrame</em>) – A dictionary of epochs, containing one DataFrame per epoch, usually obtained via
<a class="reference internal" href="epochs.html#neurokit2.epochs.epochs_create" title="neurokit2.epochs.epochs_create"><code class="xref py py-func docutils literal notranslate"><span class="pre">epochs_create()</span></code></a>, or a DataFrame containing all epochs, usually obtained via
<a class="reference internal" href="epochs.html#neurokit2.epochs.epochs_to_df" title="neurokit2.epochs.epochs_to_df"><code class="xref py py-func docutils literal notranslate"><span class="pre">epochs_to_df()</span></code></a>. Can also take a DataFrame of processed signals from a longer period
of data, typically generated by <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_process()</span></code></a> or <a class="reference internal" href="bio.html#neurokit2.bio_process" title="neurokit2.bio_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">bio_process()</span></code></a>. Can also take
a dict containing sets of separate periods of data.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second). Defaults to 1000Hz.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;event-related&quot;</span></code> for event-related analysis on epochs, or
<code class="docutils literal notranslate"><span class="pre">&quot;interval-related&quot;</span></code> for analysis on longer periods of data. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> where
the right method will be chosen based on the mean duration of the data (<code class="docutils literal notranslate"><span class="pre">&quot;event-related&quot;</span></code>
for duration under 10s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataFrame</em> – A dataframe containing the analyzed RSP features. If event-related analysis is conducted,
each epoch is indicated by the <cite>Label</cite> column. See <a class="reference internal" href="#neurokit2.rsp.rsp_eventrelated" title="neurokit2.rsp.rsp_eventrelated"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_eventrelated()</span></code></a> and
<a class="reference internal" href="#neurokit2.rsp.rsp_intervalrelated" title="neurokit2.rsp.rsp_intervalrelated"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_intervalrelated()</span></code></a> docstrings for details.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bio_process</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">epochs_create</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_eventrelated" title="neurokit2.rsp.rsp_eventrelated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_eventrelated</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_intervalrelated" title="neurokit2.rsp.rsp_intervalrelated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_intervalrelated</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Example 1: Download the data for event-related analysis</span>
<span class="gp">In [2]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;bio_eventrelated_100hz&quot;</span><span class="p">)</span>

<span class="go"># Process the data for event-related analysis</span>
<span class="gp">In [3]: </span><span class="n">df</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">bio_process</span><span class="p">(</span><span class="n">rsp</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;RSP&quot;</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">events</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">events_find</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Photosensor&quot;</span><span class="p">],</span> <span class="n">threshold_keep</span><span class="o">=</span><span class="s1">&#39;below&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>                       <span class="n">event_conditions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Negative&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutral&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutral&quot;</span><span class="p">,</span> <span class="s2">&quot;Negative&quot;</span><span class="p">])</span>
<span class="gp">   ...: </span>

<span class="gp">In [5]: </span><span class="n">epochs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">epochs_create</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs_start</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">epochs_end</span><span class="o">=</span><span class="mf">1.9</span><span class="p">)</span>

<span class="go"># Analyze</span>
<span class="gp">In [6]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_analyze</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gh">Out[6]: </span><span class="go"></span>
<span class="go">  Label Condition  ...  RSP_Phase  RSP_Phase_Completion</span>
<span class="go">1     1  Negative  ...        0.0              0.641256</span>
<span class="go">2     2   Neutral  ...        0.0              0.462312</span>
<span class="go">3     3   Neutral  ...        0.0              0.752747</span>
<span class="go">4     4  Negative  ...        1.0              0.746667</span>

<span class="go">[4 rows x 20 columns]</span>

<span class="go"># Example 2: Download the resting-state data</span>
<span class="gp">In [7]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;bio_resting_5min_100hz&quot;</span><span class="p">)</span>

<span class="go"># Process the data</span>
<span class="gp">In [8]: </span><span class="n">df</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;RSP&quot;</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="go"># Analyze</span>
<span class="gp">In [9]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_analyze</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gh">Out[9]: </span><span class="go"></span>
<span class="go">   RSP_Rate_Mean  ...  RRV_MFDFA_alpha2_Increment</span>
<span class="go">0      15.860331  ...                    0.093556</span>

<span class="go">[1 rows x 34 columns]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rsp-simulate">
<h3><em>rsp_simulate()</em><a class="headerlink" href="#rsp-simulate" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_simulate">
<span class="sig-name descname"><span class="pre">rsp_simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respiratory_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'breathmetrics'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_simulate.html#rsp_simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_simulate" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Simulate a respiratory signal</strong></p>
<p>Generate an artificial (synthetic) respiratory signal of a given duration
and rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>int</em>) – Desired length of duration (s).</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The desired sampling rate (in Hz, i.e., samples/second).</p></li>
<li><p><strong>length</strong> (<em>int</em>) – The desired length of the signal (in samples).</p></li>
<li><p><strong>noise</strong> (<em>float</em>) – Noise level (amplitude of the laplace noise).</p></li>
<li><p><strong>respiratory_rate</strong> (<em>float</em>) – Desired number of breath cycles in one minute.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The model used to generate the signal. Can be <code class="docutils literal notranslate"><span class="pre">&quot;sinusoidal&quot;</span></code> for a simulation based on a
trigonometric sine wave that roughly approximates a single respiratory cycle. If
<code class="docutils literal notranslate"><span class="pre">&quot;breathmetrics&quot;</span></code> (default), will use an advanced model desbribed by
<a class="reference external" href="https://github.com/zelanolab/breathmetrics">Noto, et al. (2018)</a>.</p></li>
<li><p><strong>random_state</strong> (<em>int</em>) – Seed for the random number generator.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_findpeaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>array</em> – Vector containing the respiratory signal.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [3]: </span><span class="n">rsp1</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;sinusoidal&quot;</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">rsp2</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;breathmetrics&quot;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;RSP_Simple&quot;</span><span class="p">:</span> <span class="n">rsp1</span><span class="p">,</span> <span class="s2">&quot;RSP_Complex&quot;</span><span class="p">:</span> <span class="n">rsp2</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[5]: </span><span class="go">array([&lt;AxesSubplot:&gt;, &lt;AxesSubplot:&gt;], dtype=object)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_simulate1.png"><img alt="../_images/p_rsp_simulate1.png" src="../_images/p_rsp_simulate1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Noto, T., Zhou, G., Schuele, S., Templer, J., &amp; Zelano, C. (2018). Automated analysis of
breathing waveforms using BreathMetrics: A respiratory signal processing toolbox. Chemical Senses, 43(8), 583-597.</p></li>
</ul>
</dd></dl>

</section>
<section id="rsp-plot">
<h3><em>rsp_plot()</em><a class="headerlink" href="#rsp-plot" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_plot">
<span class="sig-name descname"><span class="pre">rsp_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_signals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_plot.html#rsp_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_plot" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Visualize respiration (RSP) data</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_signals</strong> (<em>DataFrame</em>) – DataFrame obtained from <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_process()</span></code></a>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The desired sampling rate (in Hz, i.e., samples/second).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">rsp_signals</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_plot</span><span class="p">(</span><span class="n">rsp_signals</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_plot1.png"><img alt="../_images/p_rsp_plot1.png" src="../_images/p_rsp_plot1.png" style="width: 640.0px; height: 480.0px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>fig</em> – Figure representing a plot of the processed rsp signals.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a></p>
</div>
</dd></dl>

</section>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">#</a></h2>
<section id="rsp-clean">
<h3><em>rsp_clean()</em><a class="headerlink" href="#rsp-clean" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_clean">
<span class="sig-name descname"><span class="pre">rsp_clean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'khodadad2018'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_clean.html#rsp_clean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_clean" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Preprocess a respiration (RSP) signal</strong></p>
<p>Clean a respiration signal using different sets of parameters, such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code>: Linear detrending followed by a fifth order 2Hz low-pass IIR Butterworth
filter)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;BioSPPy&quot;</span></code>: Second order 0.1-0.35 Hz bandpass Butterworth filter followed by a constant
detrending).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The raw respiration channel (as measured, for instance, by a respiration belt).</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_signal()</span></code> (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The processing pipeline to apply. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code> (default) or
<code class="docutils literal notranslate"><span class="pre">&quot;biosppy&quot;</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – Vector containing the cleaned respiratory signal.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_findpeaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [3]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">signals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;RSP_Raw&quot;</span><span class="p">:</span> <span class="n">rsp</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;RSP_Khodadad2018&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;khodadad2018&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;RSP_BioSPPy&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;biosppy&quot;</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="p">})</span>
<span class="gp">   ...: </span>

<span class="gp">In [5]: </span><span class="n">signals</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gh">Out[5]: </span><span class="go">&lt;AxesSubplot:&gt;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_clean1.png"><img alt="../_images/p_rsp_clean1.png" src="../_images/p_rsp_clean1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Khodadad, D., Nordebo, S., Müller, B., Waldmann, A., Yerworth, R., Becher, T., … &amp; Bayford,
R. (2018). Optimized breath detection algorithm in electrical impedance tomography.
Physiological measurement, 39(9), 094001.</p></li>
</ul>
</dd></dl>

</section>
<section id="rsp-amplitude">
<h3><em>rsp_amplitude()</em><a class="headerlink" href="#rsp-amplitude" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_amplitude">
<span class="sig-name descname"><span class="pre">rsp_amplitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_cleaned</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'monotone_cubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_amplitude.html#rsp_amplitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_amplitude" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Compute respiratory amplitude</strong></p>
<p>Compute respiratory amplitude given the raw respiration signal and its extrema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_cleaned</strong> (<em>Union[list, np.array, pd.Series]</em>) – The cleaned respiration channel as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a>.</p></li>
<li><p><strong>peaks</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the respiration peaks (exhalation onsets) occur. If a dict or a
DataFrame is passed, it is assumed that these containers were obtained
with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the respiration troughs (inhalation onsets) occur. If a dict or a
is passed, it is assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>interpolation_method</strong> (<em>str</em>) – Method used to interpolate the amplitude between peaks. See <a class="reference internal" href="signal.html#neurokit2.signal_interpolate" title="neurokit2.signal_interpolate"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_interpolate()</span></code></a>.
<code class="docutils literal notranslate"><span class="pre">&quot;monotone_cubic&quot;</span></code> is chosen as the default interpolation method since it ensures monotone
interpolation between data point (i.e., it prevents physiologically implausible “overshoots”
or “undershoots” in the y-direction). In contrast, the widely used cubic spline
‘interpolation does not ensure monotonicity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>array</em> – A vector containing the respiratory amplitude.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">peak_signals</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_peaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">amplitude</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_amplitude</span><span class="p">(</span><span class="n">cleaned</span><span class="p">,</span> <span class="n">peak_signals</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;RSP&quot;</span><span class="p">:</span> <span class="n">rsp</span><span class="p">,</span> <span class="s2">&quot;Amplitude&quot;</span><span class="p">:</span> <span class="n">amplitude</span><span class="p">}),</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_amp1.png"><img alt="../_images/p_rsp_amp1.png" src="../_images/p_rsp_amp1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="rsp-peaks">
<h3><em>rsp_peaks()</em><a class="headerlink" href="#rsp-peaks" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_peaks">
<span class="sig-name descname"><span class="pre">rsp_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_cleaned</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'khodadad2018'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_peaks.html#rsp_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_peaks" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Identify extrema in a respiration (RSP) signal</strong></p>
<p>This function <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a> and <a class="reference internal" href="#neurokit2.rsp.rsp_fixpeaks" title="neurokit2.rsp.rsp_fixpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_fixpeaks()</span></code></a> to identify and process peaks
(exhalation onsets) and troughs (inhalation onsets) in a preprocessed respiration signal using
different sets of parameters, such as:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://iopscience.iop.org/article/10.1088/1361-6579/aad7e6/meta">Khodadad et al. (2018)</a></p></li>
<li><p><a class="reference external" href="https://github.com/PIA-Group/BioSPPy/blob/master/biosppy/signals/resp.py">BioSPPy</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_cleaned</strong> (<em>Union[list, np.array, pd.Series]</em>) – The cleaned respiration channel as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_cleaned()</span></code> (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The processing pipeline to apply. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code> (default)
or <code class="docutils literal notranslate"><span class="pre">&quot;biosppy&quot;</span></code>.</p></li>
<li><p><strong>amplitude_min</strong> (<em>float</em>) – Only applies if method is <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code>. Extrema that have a vertical distance smaller
than (outlier_threshold * average vertical distance) to any direct neighbour are removed as
false positive outliers. i.e., outlier_threshold should be a float with positive sign (the
default is 0.3). Larger values of outlier_threshold correspond to more conservative
thresholds (i.e., more extrema removed as outliers).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>info</strong> (<em>dict</em>) – A dictionary containing additional information, in this case the samples at which peaks
(exhalation onsets) and troughs (inhalation onsets) occur, accessible with the keys
<code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code>, respectively, as well as the signals’ sampling rate.</p></li>
<li><p><strong>peak_signal</strong> (<em>DataFrame</em>) – A DataFrame of same length as the input signal in which occurrences of peaks (exhalation
onsets) and troughs (inhalation onsets) are marked as “1” in lists of zeros with the same
length as <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_cleaned()</span></code>. Accessible with the keys <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code> respectively.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_findpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_fixpeaks" title="neurokit2.rsp.rsp_fixpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_fixpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">peak_signal</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_peaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;RSP&quot;</span><span class="p">:</span> <span class="n">rsp</span><span class="p">}),</span> <span class="n">peak_signal</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_peaks1.png"><img alt="../_images/p_rsp_peaks1.png" src="../_images/p_rsp_peaks1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="rsp-findpeaks">
<h3><em>rsp_findpeaks()</em><a class="headerlink" href="#rsp-findpeaks" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_findpeaks">
<span class="sig-name descname"><span class="pre">rsp_findpeaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_cleaned</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'khodadad2018'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_findpeaks.html#rsp_findpeaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_findpeaks" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Extract extrema in a respiration (RSP) signal</strong></p>
<p>Low-level function used by <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a> to identify inhalation and exhalation onsets
(troughs and peaks respectively) in a preprocessed respiration signal using different sets of
parameters. See <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_cleaned</strong> (<em>Union[list, np.array, pd.Series]</em>) – The cleaned respiration channel as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_cleaned()</span></code> (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The processing pipeline to apply. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code> (default) or
<code class="docutils literal notranslate"><span class="pre">&quot;biosppy&quot;</span></code>.</p></li>
<li><p><strong>amplitude_min</strong> (<em>float</em>) – Only applies if method is <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code>. Extrema that have a vertical distance smaller
than(outlier_threshold * average vertical distance) to any direct neighbour are removed as
false positive outliers. I.e., outlier_threshold should be a float with positive sign (the
default is 0.3). Larger values of outlier_threshold correspond to more conservative
thresholds (i.e., more extrema removed as outliers).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>info</strong> (<em>dict</em>) – A dictionary containing additional information, in this case the samples at which inhalation
onsets and exhalation onsets occur, accessible with the keys <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code>, respectively.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_fixpeaks" title="neurokit2.rsp.rsp_fixpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_fixpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_findpeaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">([</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;RSP_Peaks&quot;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;RSP_Troughs&quot;</span><span class="p">]],</span> <span class="n">cleaned</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_findpeaks1.png"><img alt="../_images/p_rsp_findpeaks1.png" src="../_images/p_rsp_findpeaks1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="rsp-fixpeaks">
<h3><em>rsp_fixpeaks()</em><a class="headerlink" href="#rsp-fixpeaks" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_fixpeaks">
<span class="sig-name descname"><span class="pre">rsp_fixpeaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_fixpeaks.html#rsp_fixpeaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_fixpeaks" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Correct RSP peaks</strong></p>
<p>Low-level function used by <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a> to correct the peaks found
by <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>. Doesn’t do anything for now for RSP.
See <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which respiration peaks (exhalation onsets) occur. If a dict or a DataFrame
is passed, it is assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which respiration troughs (inhalation onsets) occur. If a dict or a
DataFrame is passed, it is assumed that these containers were obtained
with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>info</strong> (<em>dict</em>) – A dictionary containing additional information, in this case the samples at which
inhalation onsets and exhalation onsets occur, accessible with the keys <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code>
and <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code>, respectively.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_findpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_findpeaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_fixpeaks</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">([</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;RSP_Peaks&quot;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;RSP_Troughs&quot;</span><span class="p">]],</span> <span class="n">cleaned</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_fixpeaks1.png"><img alt="../_images/p_rsp_fixpeaks1.png" src="../_images/p_rsp_fixpeaks1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="rsp-phase">
<h3><em>rsp_phase()</em><a class="headerlink" href="#rsp-phase" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_phase">
<span class="sig-name descname"><span class="pre">rsp_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_phase.html#rsp_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_phase" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Compute respiratory phase (inspiration and expiration)</strong></p>
<p>Finds the respiratory phase, labelled as 1 for inspiration and 0 for expiration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the inhalation peaks occur. If a dict or a DataFrame is passed, it is
assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the inhalation troughs occur. If a dict or a DataFrame is passed, it is
assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>desired_length</strong> (<em>int</em>) – By default, the returned respiration rate has the same number of elements as <code class="docutils literal notranslate"><span class="pre">peaks</span></code>. If
set to an integer, the returned rate will be interpolated between <code class="docutils literal notranslate"><span class="pre">peaks</span></code> over
<code class="docutils literal notranslate"><span class="pre">desired_length</span></code> samples. Has no effect if a DataFrame is passed in as the <code class="docutils literal notranslate"><span class="pre">peaks</span></code>
argument.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>signals</strong> (<em>DataFrame</em>) – A DataFrame of same length as <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_signal()</span></code> containing the following columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase&quot;</span></code>: breathing phase, marked by “1” for inspiration and “0” for expiration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase_Completion&quot;</span></code>: breathing phase completion, expressed in percentage (from 0
to 1), representing the stage of the current respiratory phase.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">peak_signal</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_peaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">phase</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_phase</span><span class="p">(</span><span class="n">peak_signal</span><span class="p">,</span> <span class="n">desired_length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">))</span>

<span class="gp">In [6]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">rsp</span><span class="p">,</span> <span class="n">phase</span><span class="p">],</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_phase1.png"><img alt="../_images/p_rsp_phase1.png" src="../_images/p_rsp_phase1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="rsp-rate">
<h3><em>rsp_rate()</em><a class="headerlink" href="#rsp-rate" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_rate">
<span class="sig-name descname"><span class="pre">rsp_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_cleaned</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'trough'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'khodadad2018'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'monotone_cubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_rate.html#rsp_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_rate" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Find respiration rate</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_cleaned</strong> (<em>Union[list, np.array, pd.Series]</em>) – The cleaned respiration channel as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>Union[list, np.array, pd.Series, pd.DataFrame]</em>) – The respiration troughs (inhalation onsets) as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a>.
If None (default), inhalation onsets will be automatically identified from the
<a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a> signal.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_cleaned()</span></code> (in Hz, i.e., samples/second).</p></li>
<li><p><strong>window</strong> (<em>int</em>) – The duration of the sliding window (in second). Default to 10 seconds.</p></li>
<li><p><strong>hop_size</strong> (<em>int</em>) – The number of samples between each successive window. Default to 1 sample.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Method can either be <code class="docutils literal notranslate"><span class="pre">&quot;trough&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;xcorr&quot;</span></code>. In <code class="docutils literal notranslate"><span class="pre">&quot;trough&quot;</span></code> method, respiratory rate
is calculated from the periods between successive inspirations (i.e., inhalation onsets/
troughs). In <code class="docutils literal notranslate"><span class="pre">&quot;xcorr&quot;</span></code> method, cross-correlations between the changes in respiration with
a bank of sinusoids of different frequencies are calculated to identify the principal
frequency of oscillation.</p></li>
<li><p><strong>peak_method</strong> (<em>str</em>) – Method to identify successive respiratory inspirations, only relevant if method is
<code class="docutils literal notranslate"><span class="pre">&quot;trough&quot;</span></code>. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">&quot;biosppy&quot;</span></code>.</p></li>
<li><p><strong>interpolation_method</strong> (<em>str</em>) – Method used to interpolate the rate between inhalation onsets.
See <a class="reference internal" href="signal.html#neurokit2.signal_interpolate" title="neurokit2.signal_interpolate"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_interpolate()</span></code></a>. <code class="docutils literal notranslate"><span class="pre">&quot;monotone_cubic&quot;</span></code> is chosen as the default
interpolation method since it ensures monotone interpolation between data points (i.e., it
prevents physiologically implausible “overshoots” or “undershoots” in the
y-direction). In contrast, the widely used cubic spline interpolation does not ensure
monotonicity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rsp_rate</strong> (<em>np.ndarray</em>) – Instantenous respiration rate.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp_signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;rsp_1000hz&quot;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">rsp_cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp_signal</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">rsp_rate_onsets</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_rate</span><span class="p">(</span><span class="n">rsp_cleaned</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;trough&quot;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">rsp_rate_xcorr</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_rate</span><span class="p">(</span><span class="n">rsp_cleaned</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;xcorr&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rsp-rrv">
<h3><em>rsp_rrv()</em><a class="headerlink" href="#rsp-rrv" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_rrv">
<span class="sig-name descname"><span class="pre">rsp_rrv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_rrv.html#rsp_rrv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_rrv" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Computes time domain and frequency domain features for Respiratory Rate Variability (RRV) analysis</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_rate</strong> (<em>array</em>) – Array containing the respiratory rate, produced by <a class="reference internal" href="signal.html#neurokit2.signal_rate" title="neurokit2.signal_rate"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_rate()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>dict</em>) – The samples at which the inhalation onsets occur.
Dict returned by <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a> (Accessible with the key, <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code>).
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, will return a Poincaré plot, a scattergram, which plots each breath-to-breath
interval against the next successive one. The ellipse centers around the average
breath-to-breath interval. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>silent</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, warnings will be printed. Default to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>DataFrame</em> – DataFrame consisting of the computed RRV metrics, which includes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SDBB&quot;</span></code>: the standard deviation of the breath-to-breath intervals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_RMSSD&quot;</span></code>: the root mean square of successive differences of the breath-to-breath
intervals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SDSD&quot;</span></code>: the standard deviation of the successive differences between adjacent
breath-to-breath intervals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_BBx&quot;</span></code>: the number of successive interval differences that are greater than x
seconds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV-pBBx&quot;</span></code>: the proportion of breath-to-breath intervals that are greater than x
seconds,
out of the total number of intervals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_VLF&quot;</span></code>: spectral power density pertaining to very low frequency band (i.e., 0 to .
04 Hz) by default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_LF&quot;</span></code>: spectral power density pertaining to low frequency band (i.e., .04 to .15
Hz) by default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_HF&quot;</span></code>: spectral power density pertaining to high frequency band (i.e., .15 to .4
Hz) by default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_LFHF&quot;</span></code>: the ratio of low frequency power to high frequency power.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_LFn&quot;</span></code>: the normalized low frequency, obtained by dividing the low frequency
power by the total power.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_HFn&quot;</span></code>: the normalized high frequency, obtained by dividing the low frequency
power by total power.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SD1&quot;</span></code>: SD1 is a measure of the spread of breath-to-breath intervals on the
Poincaré plot perpendicular to the line of identity. It is an index of short-term
variability.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SD2&quot;</span></code>: SD2 is a measure of the spread of breath-to-breath intervals on the
Poincaré plot along the line of identity. It is an index of long-term variability.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SD2SD1&quot;</span></code>: the ratio between short and long term fluctuations of the
breath-to-breath intervals (SD2 divided by SD1).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_ApEn&quot;</span></code>: the approximate entropy of RRV, calculated
by <a class="reference internal" href="complexity.html#neurokit2.complexity.entropy_approximate" title="neurokit2.complexity.entropy_approximate"><code class="xref py py-func docutils literal notranslate"><span class="pre">entropy_approximate()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SampEn&quot;</span></code>: the sample entropy of RRV, calculated by <a class="reference internal" href="complexity.html#neurokit2.complexity.entropy_sample" title="neurokit2.complexity.entropy_sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">entropy_sample()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_DFA_alpha1&quot;</span></code>: the “short-term” fluctuation value generated from Detrended
Fluctuation Analysis i.e. the root mean square deviation from the fitted trend of the
breath-to-breath intervals. Will only be computed if mora than 160 breath cycles in the
signal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_DFA_alpha2&quot;</span></code>: the long-term fluctuation value. Will only be computed if mora
than 640 breath cycles in the signal.</p></li>
<li><p><strong>MFDFA indices</strong>: Indices related to the <a class="reference internal" href="complexity.html#neurokit2.complexity.fractal_dfa" title="neurokit2.complexity.fractal_dfa"><code class="xref py py-func docutils literal notranslate"><span class="pre">multifractal</span> <span class="pre">spectrum</span></code></a>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_power</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">entropy_sample</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">entropy_approximate</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">rsp</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">rsp</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_rrv</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[4]: </span><span class="go"></span>
<span class="go">    RRV_RMSSD  RRV_MeanBB    RRV_SDBB  ...  RRV_SD2SD1  RRV_ApEn  RRV_SampEn</span>
<span class="go">0  858.025794     4001.25  563.711654  ...    0.799072  0.091859         inf</span>

<span class="go">[1 rows x 20 columns]</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Soni, R., &amp; Muniyandi, M. (2019). Breath rate variability: a novel measure to study the
meditation effects. International Journal of Yoga, 12(1), 45.</p></li>
</ul>
</dd></dl>

</section>
</section>
<section id="analysis">
<h2>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">#</a></h2>
<section id="rsp-eventrelated">
<h3><em>rsp_eventrelated()</em><a class="headerlink" href="#rsp-eventrelated" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_eventrelated">
<span class="sig-name descname"><span class="pre">rsp_eventrelated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_eventrelated.html#rsp_eventrelated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_eventrelated" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Performs event-related RSP analysis on epochs</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>Union[dict, pd.DataFrame]</em>) – A dict containing one DataFrame per event/trial, usually obtained via
<a class="reference internal" href="epochs.html#neurokit2.epochs.epochs_create" title="neurokit2.epochs.epochs_create"><code class="xref py py-func docutils literal notranslate"><span class="pre">epochs_create()</span></code></a>, or a DataFrame containing all epochs, usually obtained
via <a class="reference internal" href="epochs.html#neurokit2.epochs.epochs_to_df" title="neurokit2.epochs.epochs_to_df"><code class="xref py py-func docutils literal notranslate"><span class="pre">epochs_to_df()</span></code></a>.</p></li>
<li><p><strong>silent</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, silence possible warnings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>DataFrame</em> – A dataframe containing the analyzed RSP features for each epoch, with each epoch indicated
by the <cite>Label</cite> column (if not present, by the <cite>Index</cite> column). The analyzed features
consist of the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Max&quot;</span></code>: the maximum respiratory rate after stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Min&quot;</span></code>: the minimum respiratory rate after stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Mean&quot;</span></code>: the mean respiratory rate after stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_SD&quot;</span></code>: the standard deviation of the respiratory rate after stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Max_Time&quot;</span></code>: the time at which maximum respiratory rate occurs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Min_Time&quot;</span></code>: the time at which minimum respiratory rate occurs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_Baseline&quot;</span></code>: the respiratory amplitude at stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_Max&quot;</span></code>: the change in maximum respiratory amplitude from before stimulus
onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_Min&quot;</span></code>: the change in minimum respiratory amplitude from before stimulus
onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_Mean&quot;</span></code>: the change in mean respiratory amplitude from before stimulus
onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_SD&quot;</span></code>: the standard deviation of the respiratory amplitude after
stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase&quot;</span></code>: indication of whether the onset of the event concurs with respiratory
inspiration (1) or expiration (0).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_PhaseCompletion&quot;</span></code>: indication of the stage of the current respiration phase (0 to
1) at the onset of the event.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">events_find</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">epochs_create</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">bio_process</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Example with simulated data</span>
<span class="gp">In [2]: </span><span class="n">rsp</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">120</span><span class="p">))</span>

<span class="gp">In [3]: </span><span class="n">epochs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">epochs_create</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">15000</span><span class="p">],</span> <span class="n">epochs_start</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">epochs_end</span><span class="o">=</span><span class="mf">1.9</span><span class="p">)</span>

<span class="go"># Analyze</span>
<span class="gp">In [4]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_eventrelated</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
<span class="gh">Out[4]: </span><span class="go"></span>
<span class="go">  Label  Event_Onset  ...  RSP_Phase  RSP_Phase_Completion</span>
<span class="go">1     1         5000  ...        0.0              0.039754</span>
<span class="go">2     2        10000  ...        0.0              0.283831</span>
<span class="go">3     3        15000  ...        0.0              0.708643</span>

<span class="go">[3 rows x 19 columns]</span>

<span class="go"># Example with real data</span>
<span class="gp">In [5]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;bio_eventrelated_100hz&quot;</span><span class="p">)</span>

<span class="go"># Process the data</span>
<span class="gp">In [6]: </span><span class="n">df</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">bio_process</span><span class="p">(</span><span class="n">rsp</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;RSP&quot;</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">events</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">events_find</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Photosensor&quot;</span><span class="p">],</span> <span class="n">threshold_keep</span><span class="o">=</span><span class="s1">&#39;below&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>                       <span class="n">event_conditions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Negative&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutral&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutral&quot;</span><span class="p">,</span> <span class="s2">&quot;Negative&quot;</span><span class="p">])</span>
<span class="gp">   ...: </span>

<span class="gp">In [8]: </span><span class="n">epochs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">epochs_create</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs_start</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">epochs_end</span><span class="o">=</span><span class="mf">2.9</span><span class="p">)</span>

<span class="go"># Analyze</span>
<span class="gp">In [9]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_eventrelated</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
<span class="gh">Out[9]: </span><span class="go"></span>
<span class="go">  Label Condition  ...  RSP_Phase  RSP_Phase_Completion</span>
<span class="go">1     1  Negative  ...        0.0              0.641256</span>
<span class="go">2     2   Neutral  ...        0.0              0.462312</span>
<span class="go">3     3   Neutral  ...        0.0              0.752747</span>
<span class="go">4     4  Negative  ...        1.0              0.746667</span>

<span class="go">[4 rows x 20 columns]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rsp-intervalrelated">
<h3><em>rsp_intervalrelated()</em><a class="headerlink" href="#rsp-intervalrelated" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_intervalrelated">
<span class="sig-name descname"><span class="pre">rsp_intervalrelated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_intervalrelated.html#rsp_intervalrelated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_intervalrelated" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Performs RSP analysis on longer periods of data (typically &gt; 10 seconds), such as resting-state data</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataFrame or dict</em>) – A DataFrame containing the different processed signal(s) as different columns, typically
generated by <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_process()</span></code></a> or <a class="reference internal" href="bio.html#neurokit2.bio_process" title="neurokit2.bio_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">bio_process()</span></code></a>. Can also take a dict containing
sets of separately processed DataFrames.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>DataFrame</em> – A dataframe containing the analyzed RSP features.
The analyzed features consist of the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Mean&quot;</span></code>: the mean respiratory rate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_Mean&quot;</span></code>: the mean respiratory amplitude.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_RRV&quot;</span></code>: the different respiratory rate variability metrices.
See <a class="reference internal" href="#neurokit2.rsp.rsp_rrv" title="neurokit2.rsp.rsp_rrv"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_rrv()</span></code></a> docstrings for details.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase_Duration_Inspiration&quot;</span></code>: the average inspiratory duration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase_Duration_Expiration&quot;</span></code>: the average expiratory duration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase_Duration_Ratio</span> <span class="pre">&quot;</span></code>: the inspiratory-to-expiratory time ratio (I/E).</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bio_process</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_eventrelated" title="neurokit2.rsp.rsp_eventrelated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_eventrelated</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Download data</span>
<span class="gp">In [2]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;bio_resting_5min_100hz&quot;</span><span class="p">)</span>

<span class="go"># Process the data</span>
<span class="gp">In [3]: </span><span class="n">df</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;RSP&quot;</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="go"># Single dataframe is passed</span>
<span class="gp">In [4]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_intervalrelated</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gh">Out[4]: </span><span class="go"></span>
<span class="go">   RSP_Rate_Mean  ...  RRV_MFDFA_alpha2_Increment</span>
<span class="go">0      15.860331  ...                    0.093556</span>

<span class="go">[1 rows x 34 columns]</span>

<span class="gp">In [5]: </span><span class="n">epochs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">epochs_create</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15000</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs_end</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_intervalrelated</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
<span class="gh">Out[6]: </span><span class="go"></span>
<span class="go">  Label  RSP_Rate_Mean  RSP_Amplitude_Mean  ...  RRV_SD2SD1  RRV_ApEn  RRV_SampEn</span>
<span class="go">1     1      15.330861            0.441313  ...    1.506789  0.562986    1.228665</span>
<span class="go">2     2      16.389802            0.356841  ...    0.806392  0.211983    1.011601</span>

<span class="go">[2 rows x 26 columns]</span>
</pre></div>
</div>
</dd></dl>

<p><em>Any function appearing below this point is not explicitly part of the documentation and should be added. Please open an issue if there is one.</em></p>
<span class="target" id="module-neurokit2.rsp"></span><p>Submodule for NeuroKit.</p>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="hrv.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">HRV</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="eda.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">EDA</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By <a href="https://dominiquemakowski.github.io/">Dominique Makowski</a> and the <a href="https://github.com/neuropsychology/NeuroKit/blob/master/AUTHORS.rst">Team</a><br/>
  
      &copy; Copyright 2020–2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>
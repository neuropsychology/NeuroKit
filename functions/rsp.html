

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>RSP &#8212; NeuroKit2 0.2.7 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'functions/rsp';</script>
    <link rel="shortcut icon" href="../_static/icon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="EDA" href="eda.html" />
    <link rel="prev" title="HRV" href="hrv.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/neurokit.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/neurokit.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Menu</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite_us.html">Cite us</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/bio_eventrelated/bio_eventrelated.html">Event-related Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/bio_intervalrelated/bio_intervalrelated.html">Interval-related Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/bio_custom/bio_custom.html">Customize your Processing Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ecg_hrv/ecg_hrv.html">Heart Rate Varability (HRV)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ecg_heartbeats/ecg_heartbeats.html">Extract and Visualize Individual Heartbeats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ecg_delineate/ecg_delineate.html">Locate P, Q, S and T waves in ECG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ecg_edr/ecg_edr.html">ECG-Derived Respiration (EDR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ecg_generate_12leads/ecg_generate_12leads.html">Generating Abnormal 12-leads ECG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/eda_peaks/eda_peaks.html">Analyze Electrodermal Activity (EDA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/rsp_rrv/rsp_rrv.html">Respiratory Rate Variability (RRV)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/eog_analyze/eog_analyze.html">Analyze Electrooculography (EOG)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/signal_simulation/signal_simulation.html">Simulate Artificial Physiological Signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ppg_report/ppg_report.html">Save Preprocessing Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/eeg_power/eeg_power.html">EEG Power in Frequency Bands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/eeg_complexity/eeg_complexity.html">EEG Complexity Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/eeg_microstates/eeg_microstates.html">EEG Microstates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/misc_fit_function/misc_fit_function.html">Fit a function to a non-linear pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/misc_epochs_create/misc_epochs_create.html">Create epochs</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Functions</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bio.html">Bio</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecg.html">ECG</a></li>
<li class="toctree-l2"><a class="reference internal" href="ppg.html">PPG</a></li>
<li class="toctree-l2"><a class="reference internal" href="hrv.html">HRV</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">RSP</a></li>
<li class="toctree-l2"><a class="reference internal" href="eda.html">EDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="emg.html">EMG</a></li>
<li class="toctree-l2"><a class="reference internal" href="eog.html">EOG</a></li>
<li class="toctree-l2"><a class="reference internal" href="eeg.html">EEG</a></li>
<li class="toctree-l2"><a class="reference internal" href="video.html">Video Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="microstates.html">Microstates</a></li>
<li class="toctree-l2"><a class="reference internal" href="signal.html">Signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="epochs.html">Epochs</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="complexity.html">Complexity</a></li>
<li class="toctree-l2"><a class="reference internal" href="markov.html">Markov Chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats.html">Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">Misc</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmark.html">Benchmarking</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../resources/index.html">Resources</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../resources/learn_python.html">Learn Python in 10 minutes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources/contributing.html">Contributing guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources/recording.html">Recording good quality signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources/resources.html">Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../studies/index.html">Studies</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference external" href="https://www.mdpi.com/1424-8220/21/12/3998">HRV Review</a></li>
<li class="toctree-l2"><a class="reference external" href="https://psyarxiv.com/mwa6x/">HRV Indices</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9307944/">HRV Tutorial</a></li>
<li class="toctree-l2"><a class="reference external" href="https://onlinelibrary.wiley.com/doi/10.1111/ejn.15800">Complexity Review</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.mdpi.com/1099-4300/24/8/1036">Complexity Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../studies/complexity_eeg.html">EEG Complexity: Parameters Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../studies/erp_gam.html">EEG Analysis with GAMs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../studies/ecg_benchmark.html">ECG Benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../studies/eog_blinktemplate.html">EOG blink template</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/neuropsychology/NeuroKit">Repository</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/neuropsychology/NeuroKit" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/neuropsychology/NeuroKit/edit/dev/docs/functions/rsp.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/neuropsychology/NeuroKit/issues/new?title=Issue%20on%20page%20%2Ffunctions/rsp.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/functions/rsp.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>RSP</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main">Main</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-process"><em>rsp_process()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_process"><code class="docutils literal notranslate"><span class="pre">rsp_process()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-analyze"><em>rsp_analyze()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_analyze"><code class="docutils literal notranslate"><span class="pre">rsp_analyze()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-simulate"><em>rsp_simulate()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_simulate"><code class="docutils literal notranslate"><span class="pre">rsp_simulate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-plot"><em>rsp_plot()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_plot"><code class="docutils literal notranslate"><span class="pre">rsp_plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-clean"><em>rsp_clean()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_clean"><code class="docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-amplitude"><em>rsp_amplitude()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_amplitude"><code class="docutils literal notranslate"><span class="pre">rsp_amplitude()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-peaks"><em>rsp_peaks()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_peaks"><code class="docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-findpeaks"><em>rsp_findpeaks()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_findpeaks"><code class="docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-fixpeaks"><em>rsp_fixpeaks()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_fixpeaks"><code class="docutils literal notranslate"><span class="pre">rsp_fixpeaks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-phase"><em>rsp_phase()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_phase"><code class="docutils literal notranslate"><span class="pre">rsp_phase()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-rate"><em>rsp_rate()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_rate"><code class="docutils literal notranslate"><span class="pre">rsp_rate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-symmetry"><em>rsp_symmetry()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_symmetry"><code class="docutils literal notranslate"><span class="pre">rsp_symmetry()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-rrv"><em>rsp_rrv()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_rrv"><code class="docutils literal notranslate"><span class="pre">rsp_rrv()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-rvt"><em>rsp_rvt()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_rvt"><code class="docutils literal notranslate"><span class="pre">rsp_rvt()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-eventrelated"><em>rsp_eventrelated()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_eventrelated"><code class="docutils literal notranslate"><span class="pre">rsp_eventrelated()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-intervalrelated"><em>rsp_intervalrelated()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_intervalrelated"><code class="docutils literal notranslate"><span class="pre">rsp_intervalrelated()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_methods"><code class="docutils literal notranslate"><span class="pre">rsp_methods()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_rav"><code class="docutils literal notranslate"><span class="pre">rsp_rav()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="rsp">
<h1>RSP<a class="headerlink" href="#rsp" title="Permalink to this heading">#</a></h1>
<section id="main">
<h2>Main<a class="headerlink" href="#main" title="Permalink to this heading">#</a></h2>
<section id="rsp-process">
<h3><em>rsp_process()</em><a class="headerlink" href="#rsp-process" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_process">
<span class="sig-name descname"><span class="pre">rsp_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'khodadad2018'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_rvt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'harrison2021'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_process.html#rsp_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_process" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Process a respiration (RSP) signal</strong></p>
<p>Convenience function that automatically processes a respiration signal with one of the
following methods:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://iopscience.iop.org/article/10.1088/1361-6579/aad7e6/meta">Khodadad et al. (2018)</a></p></li>
<li><p><a class="reference external" href="https://github.com/PIA-Group/BioSPPy/blob/master/biosppy/signals/resp.py">BioSPPy</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The raw respiration channel (as measured, for instance, by a respiration belt).</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_signal()</span></code> (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The processing pipeline to apply. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code> (default)
or <code class="docutils literal notranslate"><span class="pre">&quot;biosppy&quot;</span></code>.</p></li>
<li><p><strong>method_rvt</strong> (<em>str</em>) – The rvt method to apply. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;harrison2021&quot;</span></code> (default), <code class="docutils literal notranslate"><span class="pre">&quot;birn2006&quot;</span></code>
or <code class="docutils literal notranslate"><span class="pre">&quot;power2020&quot;</span></code>.</p></li>
<li><p><strong>report</strong> (<em>str</em>) – The filename of a report containing description and figures of processing
(e.g. <code class="docutils literal notranslate"><span class="pre">&quot;myreport.html&quot;</span></code>). Needs to be supplied if a report file
should be generated. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. Can also be <code class="docutils literal notranslate"><span class="pre">&quot;text&quot;</span></code> to
just print the text in the console without saving anything.</p></li>
<li><p><strong>**kwargs</strong> – Other arguments to be passed to specific methods. For more information,
see <a class="reference internal" href="#neurokit2.rsp.rsp_methods" title="neurokit2.rsp.rsp_methods"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_methods()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>signals</strong> (<em>DataFrame</em>) – A DataFrame of same length as <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_signal()</span></code> containing the following columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Raw&quot;</span></code>: the raw signal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Clean&quot;</span></code>: the cleaned signal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code>: the respiratory peaks (exhalation onsets) marked as “1” in a list of
zeros.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code>: the respiratory troughs (inhalation onsets) marked as “1” in a list of
zeros.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate&quot;</span></code>: breathing rate interpolated between inhalation peaks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude&quot;</span></code>: breathing amplitude interpolated between inhalation peaks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase&quot;</span></code>: breathing phase, marked by “1” for inspiration and “0” for expiration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase_Completion&quot;</span></code>: breathing phase completion, expressed in percentage (from 0 to
1), representing the stage of the current respiratory phase.</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_RVT&quot;</span></code>: respiratory volume per time (RVT).</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>info</strong> (<em>dict</em>) – A dictionary containing the samples at which inhalation peaks and exhalation troughs occur,
accessible with the keys <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code> respectively, as well as the
signals’ sampling rate.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_findpeaks</span></code></a>, <a class="reference internal" href="signal.html#neurokit2.signal_rate" title="neurokit2.signal_rate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_phase" title="neurokit2.rsp.rsp_phase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_phase</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_rvt" title="neurokit2.rsp.rsp_rvt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_rvt</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_symmetry" title="neurokit2.rsp.rsp_symmetry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_symmetry</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">signals</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
<span class="go">The raw signal, sampled at 1000 Hz, linear detrending followed by a fifth order 2Hz low-pass IIR Butterworth filter; following Khoadadad et al., 2018.</span>

<span class="go">The peak detection was carried out using the method described in Khoadadad et al. (2018).</span>

<span class="go">The respiratory volume per time computation was carried out using the method described in Harrison et al. (2021).</span>

<span class="go">|   RSP_Rate_Mean |   RSP_Rate_SD |</span>
<span class="go">|----------------:|--------------:|</span>
<span class="go">|         14.4184 |       1.82706 |</span>

<span class="go">References</span>
<span class="go">- Harrison, S. J., Bianchi, S., Heinzle, J., Stephan, K. E., Iglesias, S., &amp; Kasper, L. (2021).</span>
<span class="go">            A Hilbert-based method for processing respiratory timeseries.</span>
<span class="go">            Neuroimage, 230, 117787.</span>
<span class="go">- Khodadad, D., Nordebo, S., Müller, B., Waldmann, A., Yerworth, R., Becher, T., ... &amp; Bayford, R. (2018).</span>
<span class="go">            Optimized breath detection algorithm in electrical impedance tomography.</span>
<span class="go">            Physiological measurement, 39(9), 094001.</span>
<span class="go">- Khodadad, D., Nordebo, S., Müller, B., Waldmann, A., Yerworth, R., Becher, T.,... &amp; Bayford, R. (2018).</span>
<span class="go">            Optimized breath detection algorithm in electrical impedance tomography.</span>
<span class="go">            Physiological measurement, 39(9), 094001.</span>
<span class="go">- Makowski, D., Pham, T., Lau, Z. J., Brammer, J. C., Lespinasse, F., Pham, H.,</span>
<span class="go">    Schölzel, C., &amp; Chen, S. A. (2021). NeuroKit2: A Python toolbox for neurophysiological signal processing.</span>
<span class="go">    Behavior Research Methods, 53(4), 1689–1696. https://doi.org/10.3758/s13428-020-01516-y</span>
<span class="go">    </span>

<span class="gp">In [4]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_plot</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_process_1.png"><img alt="../_images/p_rsp_process_1.png" src="../_images/p_rsp_process_1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="rsp-analyze">
<h3><em>rsp_analyze()</em><a class="headerlink" href="#rsp-analyze" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_analyze">
<span class="sig-name descname"><span class="pre">rsp_analyze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_analyze.html#rsp_analyze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_analyze" title="Permalink to this definition">#</a></dt>
<dd><p><strong>RSP Analysis</strong></p>
<p>Performs RSP analysis on either epochs (event-related analysis) or on longer periods of data such as resting-state data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>dict or DataFrame</em>) – A dictionary of epochs, containing one DataFrame per epoch, usually obtained via
<a class="reference internal" href="epochs.html#neurokit2.epochs.epochs_create" title="neurokit2.epochs.epochs_create"><code class="xref py py-func docutils literal notranslate"><span class="pre">epochs_create()</span></code></a>, or a DataFrame containing all epochs, usually obtained via
<a class="reference internal" href="epochs.html#neurokit2.epochs.epochs_to_df" title="neurokit2.epochs.epochs_to_df"><code class="xref py py-func docutils literal notranslate"><span class="pre">epochs_to_df()</span></code></a>. Can also take a DataFrame of processed signals from a longer period
of data, typically generated by <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_process()</span></code></a> or <a class="reference internal" href="bio.html#neurokit2.bio_process" title="neurokit2.bio_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">bio_process()</span></code></a>. Can also take
a dict containing sets of separate periods of data.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second). Defaults to 1000Hz.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;event-related&quot;</span></code> for event-related analysis on epochs, or
<code class="docutils literal notranslate"><span class="pre">&quot;interval-related&quot;</span></code> for analysis on longer periods of data. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> where
the right method will be chosen based on the mean duration of the data (<code class="docutils literal notranslate"><span class="pre">&quot;event-related&quot;</span></code>
for duration under 10s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>DataFrame</em> – A dataframe containing the analyzed RSP features. If event-related analysis is conducted,
each epoch is indicated by the <cite>Label</cite> column. See <a class="reference internal" href="#neurokit2.rsp.rsp_eventrelated" title="neurokit2.rsp.rsp_eventrelated"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_eventrelated()</span></code></a> and
<a class="reference internal" href="#neurokit2.rsp.rsp_intervalrelated" title="neurokit2.rsp.rsp_intervalrelated"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_intervalrelated()</span></code></a> docstrings for details.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bio_process</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">epochs_create</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_eventrelated" title="neurokit2.rsp.rsp_eventrelated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_eventrelated</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_intervalrelated" title="neurokit2.rsp.rsp_intervalrelated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_intervalrelated</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Example 1: Download the data for event-related analysis</span>
<span class="gp">In [2]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;bio_eventrelated_100hz&quot;</span><span class="p">)</span>

<span class="go"># Process the data for event-related analysis</span>
<span class="gp">In [3]: </span><span class="n">df</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">bio_process</span><span class="p">(</span><span class="n">rsp</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;RSP&quot;</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">events</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">events_find</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Photosensor&quot;</span><span class="p">],</span> <span class="n">threshold_keep</span><span class="o">=</span><span class="s1">&#39;below&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>                       <span class="n">event_conditions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Negative&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutral&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutral&quot;</span><span class="p">,</span> <span class="s2">&quot;Negative&quot;</span><span class="p">])</span>
<span class="gp">   ...: </span>

<span class="gp">In [5]: </span><span class="n">epochs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">epochs_create</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs_start</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">epochs_end</span><span class="o">=</span><span class="mf">1.9</span><span class="p">)</span>

<span class="go"># Analyze</span>
<span class="gp">In [6]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_analyze</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gh">Out[6]: </span>
<span class="go">  Label Condition  ...  RSP_RVT_Baseline  RSP_RVT_Mean</span>
<span class="go">1     1  Negative  ...          0.225643      0.004368</span>
<span class="go">2     2   Neutral  ...          0.169809     -0.013798</span>
<span class="go">3     3   Neutral  ...          0.127095      0.008785</span>
<span class="go">4     4  Negative  ...          0.080601      0.001421</span>

<span class="go">[4 rows x 23 columns]</span>

<span class="go"># Example 2: Download the resting-state data</span>
<span class="gp">In [7]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;bio_resting_5min_100hz&quot;</span><span class="p">)</span>

<span class="go"># Process the data</span>
<span class="gp">In [8]: </span><span class="n">df</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;RSP&quot;</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="go"># Analyze</span>
<span class="gp">In [9]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_analyze</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gh">Out[9]: </span>
<span class="go">   RSP_Rate_Mean  ...  RSP_Phase_Duration_Ratio</span>
<span class="go">0      15.860331  ...                  0.664482</span>

<span class="go">[1 rows x 40 columns]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rsp-simulate">
<h3><em>rsp_simulate()</em><a class="headerlink" href="#rsp-simulate" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_simulate">
<span class="sig-name descname"><span class="pre">rsp_simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respiratory_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'breathmetrics'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state_distort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spawn'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_simulate.html#rsp_simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_simulate" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Simulate a respiratory signal</strong></p>
<p>Generate an artificial (synthetic) respiratory signal of a given duration
and rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>int</em>) – Desired length of duration (s).</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The desired sampling rate (in Hz, i.e., samples/second).</p></li>
<li><p><strong>length</strong> (<em>int</em>) – The desired length of the signal (in samples).</p></li>
<li><p><strong>noise</strong> (<em>float</em>) – Noise level (amplitude of the laplace noise).</p></li>
<li><p><strong>respiratory_rate</strong> (<em>float</em>) – Desired number of breath cycles in one minute.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The model used to generate the signal. Can be <code class="docutils literal notranslate"><span class="pre">&quot;sinusoidal&quot;</span></code> for a simulation based on a
trigonometric sine wave that roughly approximates a single respiratory cycle. If
<code class="docutils literal notranslate"><span class="pre">&quot;breathmetrics&quot;</span></code> (default), will use an advanced model desbribed by
<a class="reference external" href="https://github.com/zelanolab/breathmetrics">Noto, et al. (2018)</a>.</p></li>
<li><p><strong>random_state</strong> (<em>None, int, numpy.random.RandomState or numpy.random.Generator</em>) – Seed for the random number generator. See for <code class="docutils literal notranslate"><span class="pre">misc.check_random_state</span></code> for further information.</p></li>
<li><p><strong>random_state_distort</strong> (<em>{‘legacy’, ‘spawn’}, None, int, numpy.random.RandomState or numpy.random.Generator</em>) – Random state to be used to distort the signal. If <code class="docutils literal notranslate"><span class="pre">&quot;legacy&quot;</span></code>, use the same random state used to
generate the signal (discouraged as it creates dependent random streams). If <code class="docutils literal notranslate"><span class="pre">&quot;spawn&quot;</span></code>, spawn
independent children random number generators from the random_state argument. If any of the other types,
generate independent children random number generators from the random_state_distort provided (this
allows generating multiple version of the same signal distorted by different random noise realizations).</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_findpeaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>array</em> – Vector containing the respiratory signal.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [3]: </span><span class="n">rsp1</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;sinusoidal&quot;</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">rsp2</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;breathmetrics&quot;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;RSP_Simple&quot;</span><span class="p">:</span> <span class="n">rsp1</span><span class="p">,</span> <span class="s2">&quot;RSP_Complex&quot;</span><span class="p">:</span> <span class="n">rsp2</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[5]: </span><span class="go">array([&lt;Axes: &gt;, &lt;Axes: &gt;], dtype=object)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_simulate1.png"><img alt="../_images/p_rsp_simulate1.png" src="../_images/p_rsp_simulate1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Noto, T., Zhou, G., Schuele, S., Templer, J., &amp; Zelano, C. (2018). Automated analysis of
breathing waveforms using BreathMetrics: A respiratory signal processing toolbox. Chemical Senses, 43(8), 583-597.</p></li>
</ul>
</dd></dl>

</section>
<section id="rsp-plot">
<h3><em>rsp_plot()</em><a class="headerlink" href="#rsp-plot" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_plot">
<span class="sig-name descname"><span class="pre">rsp_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_signals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_plot.html#rsp_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_plot" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Visualize respiration (RSP) data</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_signals</strong> (<em>DataFrame</em>) – DataFrame obtained from <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_process()</span></code></a>.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – The information Dict returned by <code class="docutils literal notranslate"><span class="pre">rsp_process()</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>static</strong> (<em>bool</em>) – If True, a static plot will be generated with matplotlib.
If False, an interactive plot will be generated with plotly.
Defaults to True.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>See <a class="reference internal" href="ecg.html#neurokit2.ecg.ecg_plot" title="neurokit2.ecg.ecg_plot"><code class="xref py py-func docutils literal notranslate"><span class="pre">ecg_plot()</span></code></a> for details on how to access the figure, modify the size and save it.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Simulate data</span>
<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="go"># Process signal</span>
<span class="gp">In [3]: </span><span class="n">rsp_signals</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="go"># Plot</span>
<span class="gp">In [4]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_plot</span><span class="p">(</span><span class="n">rsp_signals</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_plot1.png"><img alt="../_images/p_rsp_plot1.png" src="../_images/p_rsp_plot1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this heading">#</a></h2>
<section id="rsp-clean">
<h3><em>rsp_clean()</em><a class="headerlink" href="#rsp-clean" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_clean">
<span class="sig-name descname"><span class="pre">rsp_clean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'khodadad2018'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_clean.html#rsp_clean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_clean" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Preprocess a respiration (RSP) signal</strong></p>
<p>Clean a respiration signal using different sets of parameters, such as:</p>
<ul class="simple">
<li><p><strong>khodadad2018</strong>: Linear detrending followed by a fifth order 2Hz low-pass IIR Butterworth
filter)</p></li>
<li><p><strong>BioSPPy</strong>: Second order 0.1-0.35 Hz bandpass Butterworth filter followed by a constant
detrending).</p></li>
<li><p><strong>hampel</strong>: Applies a median-based Hampel filter by replacing values which are 3 (can be
changed via <code class="docutils literal notranslate"><span class="pre">threshold</span></code>) <a class="reference internal" href="stats.html#neurokit2.mad" title="neurokit2.mad"><code class="xref py py-func docutils literal notranslate"><span class="pre">mad()</span></code></a> away from the rolling median.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_signal</strong> (<em>Union[list, np.array, pd.Series]</em>) – The raw respiration channel (as measured, for instance, by a respiration belt).</p></li>
<li><p><strong>sampling_rate</strong> (<em>int, optional</em>) – The sampling frequency of <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_signal()</span></code> (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str, optional</em>) – The processing pipeline to apply. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code> (default),
<code class="docutils literal notranslate"><span class="pre">&quot;biosppy&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;hampel&quot;</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Other arguments to pass to the cleaning method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>array</em> – Vector containing the cleaned respiratory signal.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_findpeaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [3]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">signals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;RSP_Raw&quot;</span><span class="p">:</span> <span class="n">rsp</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;RSP_Khodadad2018&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;khodadad2018&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;RSP_BioSPPy&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;biosppy&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;RSP_Hampel&quot;</span><span class="p">:</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;hampel&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="p">})</span>
<span class="gp">   ...: </span>

<span class="gp">In [5]: </span><span class="n">signals</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gh">Out[5]: </span><span class="go">&lt;Axes: &gt;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_clean1.png"><img alt="../_images/p_rsp_clean1.png" src="../_images/p_rsp_clean1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Khodadad, D., Nordebo, S., Müller, B., Waldmann, A., Yerworth, R., Becher, T., … &amp; Bayford,
R. (2018). Optimized breath detection algorithm in electrical impedance tomography.
Physiological measurement, 39(9), 094001.</p></li>
<li><p>Power, J., Lynch, C., Dubin, M., Silver, B., Martin, A., Jones, R.,(2020)
Characteristics of respiratory measures in young adults scanned at rest,
including systematic changes and “missed” deep breaths.
NeuroImage, Volume 204, 116234</p></li>
</ul>
</dd></dl>

</section>
<section id="rsp-amplitude">
<h3><em>rsp_amplitude()</em><a class="headerlink" href="#rsp-amplitude" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_amplitude">
<span class="sig-name descname"><span class="pre">rsp_amplitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_cleaned</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'monotone_cubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_amplitude.html#rsp_amplitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_amplitude" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Compute respiratory amplitude</strong></p>
<p>Compute respiratory amplitude given the raw respiration signal and its extrema. The
<strong>standard</strong> method computes the amplitude as the difference between a peak and its preceding
trough, while the <strong>prepost</strong> method computes the amplitude as the average of the differences
of peak to its preceding and succeeding troughs (Cole, 2019).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_cleaned</strong> (<em>Union[list, np.array, pd.Series]</em>) – The cleaned respiration channel as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a>.</p></li>
<li><p><strong>peaks</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the respiration peaks (exhalation onsets) occur. If a dict or a
DataFrame is passed, it is assumed that these containers were obtained
with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the respiration troughs (inhalation onsets) occur. If a dict or a
is passed, it is assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The method to use to compute the amplitude. Can be <code class="docutils literal notranslate"><span class="pre">&quot;standard&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;prepost&quot;</span></code>.</p></li>
<li><p><strong>interpolation_method</strong> (<em>str</em>) – Method used to interpolate the amplitude between peaks. See <a class="reference internal" href="signal.html#neurokit2.signal_interpolate" title="neurokit2.signal_interpolate"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_interpolate()</span></code></a>.
<code class="docutils literal notranslate"><span class="pre">&quot;monotone_cubic&quot;</span></code> is chosen as the default interpolation method since it ensures monotone
interpolation between data point (i.e., it prevents physiologically implausible “overshoots”
or “undershoots” in the y-direction). In contrast, the widely used cubic spline
‘interpolation does not ensure monotonicity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>array</em> – A vector containing the respiratory amplitude.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_symmetry" title="neurokit2.rsp.rsp_symmetry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_symmetry</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">peak_signals</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_peaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">amplitude</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_amplitude</span><span class="p">(</span><span class="n">cleaned</span><span class="p">,</span> <span class="n">peak_signals</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">rsp</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;RSP&quot;</span><span class="p">,</span> <span class="s2">&quot;Amplitude&quot;</span><span class="p">],</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_amp1.png"><img alt="../_images/p_rsp_amp1.png" src="../_images/p_rsp_amp1.png" style="width: 640.0px; height: 480.0px;" /></a>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">amp2</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_amplitude</span><span class="p">(</span><span class="n">cleaned</span><span class="p">,</span> <span class="n">peak_signals</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;prepost&quot;</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">amp2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Standard&quot;</span><span class="p">,</span> <span class="s2">&quot;Prepost&quot;</span><span class="p">])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_amp2.png"><img alt="../_images/p_rsp_amp2.png" src="../_images/p_rsp_amp2.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Cole, S., &amp; Voytek, B. (2019). Cycle-by-cycle analysis of neural oscillations. Journal of
neurophysiology, 122(2), 849-861.</p></li>
</ul>
</dd></dl>

</section>
<section id="rsp-peaks">
<h3><em>rsp_peaks()</em><a class="headerlink" href="#rsp-peaks" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_peaks">
<span class="sig-name descname"><span class="pre">rsp_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_cleaned</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'khodadad2018'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_peaks.html#rsp_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_peaks" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Identify extrema in a respiration (RSP) signal</strong></p>
<p>This function runs <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a> and <a class="reference internal" href="#neurokit2.rsp.rsp_fixpeaks" title="neurokit2.rsp.rsp_fixpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_fixpeaks()</span></code></a> to identify and process
peaks (exhalation onsets) and troughs (inhalation onsets) in a preprocessed respiration signal
using different sets of parameters, such as:</p>
<ul class="simple">
<li><p><strong>khodad2018</strong>: Uses the parameters in Khodadad et al. (2018).</p></li>
<li><p><strong>biosppy</strong>: Uses the parameters in <a class="reference external" href="https://github.com/PIA-Group/BioSPPy">BioSPPy’s</a>
<code class="docutils literal notranslate"><span class="pre">resp()</span></code> function.</p></li>
<li><p><strong>scipy</strong> Uses the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.find_peaks.html">scipy</a>
peak-detection function.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_cleaned</strong> (<em>Union[list, np.array, pd.Series]</em>) – The cleaned respiration channel as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_cleaned()</span></code> (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The processing pipeline to apply. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code> (default), <code class="docutils literal notranslate"><span class="pre">&quot;biosppy&quot;</span></code>
or <code class="docutils literal notranslate"><span class="pre">&quot;scipy&quot;</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Other arguments to be passed to the different peak finding methods. See
<a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>info</strong> (<em>dict</em>) – A dictionary containing additional information, in this case the samples at which peaks
(exhalation onsets) and troughs (inhalation onsets) occur, accessible with the keys
<code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code>, respectively, as well as the signals’ sampling rate.</p></li>
<li><p><strong>peak_signal</strong> (<em>DataFrame</em>) – A DataFrame of same length as the input signal in which occurrences of peaks (exhalation
onsets) and troughs (inhalation onsets) are marked as “1” in lists of zeros with the same
length as <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_cleaned()</span></code>. Accessible with the keys <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code> respectively.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_findpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_fixpeaks" title="neurokit2.rsp.rsp_fixpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_fixpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">peak_signal</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_peaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;RSP&quot;</span><span class="p">:</span> <span class="n">rsp</span><span class="p">}),</span> <span class="n">peak_signal</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_peaks1.png"><img alt="../_images/p_rsp_peaks1.png" src="../_images/p_rsp_peaks1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Khodadad, D., Nordebo, S., Müller, B., Waldmann, A., Yerworth, R., Becher, T., … &amp; Bayford,
R. (2018). Optimized breath detection algorithm in electrical impedance tomography.
Physiological measurement, 39(9), 094001.</p></li>
</ul>
</dd></dl>

</section>
<section id="rsp-findpeaks">
<h3><em>rsp_findpeaks()</em><a class="headerlink" href="#rsp-findpeaks" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_findpeaks">
<span class="sig-name descname"><span class="pre">rsp_findpeaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_cleaned</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'khodadad2018'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_findpeaks.html#rsp_findpeaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_findpeaks" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Extract extrema in a respiration (RSP) signal</strong></p>
<p>Low-level function used by <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a> to identify inhalation and exhalation onsets
(troughs and peaks respectively) in a preprocessed respiration signal using different sets of
parameters. See <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_cleaned</strong> (<em>Union[list, np.array, pd.Series]</em>) – The cleaned respiration channel as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_cleaned()</span></code> (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The processing pipeline to apply. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code> (default), <code class="docutils literal notranslate"><span class="pre">&quot;scipy&quot;</span></code> or
<code class="docutils literal notranslate"><span class="pre">&quot;biosppy&quot;</span></code>.</p></li>
<li><p><strong>amplitude_min</strong> (<em>float</em>) – Only applies if method is <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code>. Extrema that have a vertical distance smaller
than(outlier_threshold * average vertical distance) to any direct neighbour are removed as
false positive outliers. I.e., outlier_threshold should be a float with positive sign (the
default is 0.3). Larger values of outlier_threshold correspond to more conservative
thresholds (i.e., more extrema removed as outliers).</p></li>
<li><p><strong>peak_distance</strong> (<em>float</em>) – Only applies if method is <code class="docutils literal notranslate"><span class="pre">&quot;scipy&quot;</span></code>. Minimal distance between peaks. Default is 0.8
seconds.</p></li>
<li><p><strong>peak_prominence</strong> (<em>float</em>) – Only applies if method is <code class="docutils literal notranslate"><span class="pre">&quot;scipy&quot;</span></code>. Minimal prominence between peaks. Default is 0.5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>info</strong> (<em>dict</em>) – A dictionary containing additional information, in this case the samples at which inhalation
onsets and exhalation onsets occur, accessible with the keys <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code>, respectively.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_fixpeaks" title="neurokit2.rsp.rsp_fixpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_fixpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_findpeaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">([</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;RSP_Peaks&quot;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;RSP_Troughs&quot;</span><span class="p">]],</span> <span class="n">cleaned</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_findpeaks1.png"><img alt="../_images/p_rsp_findpeaks1.png" src="../_images/p_rsp_findpeaks1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="rsp-fixpeaks">
<h3><em>rsp_fixpeaks()</em><a class="headerlink" href="#rsp-fixpeaks" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_fixpeaks">
<span class="sig-name descname"><span class="pre">rsp_fixpeaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_fixpeaks.html#rsp_fixpeaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_fixpeaks" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Correct RSP peaks</strong></p>
<p>Low-level function used by <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a> to correct the peaks found
by <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>. Doesn’t do anything for now for RSP.
See <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which respiration peaks (exhalation onsets) occur. If a dict or a DataFrame
is passed, it is assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which respiration troughs (inhalation onsets) occur. If a dict or a
DataFrame is passed, it is assumed that these containers were obtained
with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>info</strong> (<em>dict</em>) – A dictionary containing additional information, in this case the samples at which
inhalation onsets and exhalation onsets occur, accessible with the keys <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code>
and <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Peaks&quot;</span></code>, respectively.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_findpeaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_findpeaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_fixpeaks</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">([</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;RSP_Peaks&quot;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;RSP_Troughs&quot;</span><span class="p">]],</span> <span class="n">cleaned</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_fixpeaks1.png"><img alt="../_images/p_rsp_fixpeaks1.png" src="../_images/p_rsp_fixpeaks1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="rsp-phase">
<h3><em>rsp_phase()</em><a class="headerlink" href="#rsp-phase" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_phase">
<span class="sig-name descname"><span class="pre">rsp_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_phase.html#rsp_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_phase" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Compute respiratory phase (inspiration and expiration)</strong></p>
<p>Finds the respiratory phase, labelled as 1 for inspiration and 0 for expiration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the inhalation peaks occur. If a dict or a DataFrame is passed, it is
assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the inhalation troughs occur. If a dict or a DataFrame is passed, it is
assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>desired_length</strong> (<em>int</em>) – By default, the returned respiration rate has the same number of elements as <code class="docutils literal notranslate"><span class="pre">peaks</span></code>. If
set to an integer, the returned rate will be interpolated between <code class="docutils literal notranslate"><span class="pre">peaks</span></code> over
<code class="docutils literal notranslate"><span class="pre">desired_length</span></code> samples. Has no effect if a DataFrame is passed in as the <code class="docutils literal notranslate"><span class="pre">peaks</span></code>
argument.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><em>pd.DataFrame</em> – A DataFrame of same length as <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_signal()</span></code> containing the following columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase&quot;</span></code>: breathing phase, marked by “1” for inspiration and “0” for expiration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase_Completion&quot;</span></code>: breathing phase completion, expressed in percentage (from 0
to 1), representing the stage of the current respiratory phase.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_plot" title="neurokit2.rsp.rsp_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_plot</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">peak_signal</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_peaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">phase</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_phase</span><span class="p">(</span><span class="n">peak_signal</span><span class="p">,</span> <span class="n">desired_length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">))</span>

<span class="gp">In [6]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">rsp</span><span class="p">,</span> <span class="n">phase</span><span class="p">],</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_phase1.png"><img alt="../_images/p_rsp_phase1.png" src="../_images/p_rsp_phase1.png" style="width: 640.0px; height: 480.0px;" /></a>
</dd></dl>

</section>
<section id="rsp-rate">
<h3><em>rsp_rate()</em><a class="headerlink" href="#rsp-rate" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_rate">
<span class="sig-name descname"><span class="pre">rsp_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_cleaned</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'trough'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'khodadad2018'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'monotone_cubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_rate.html#rsp_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_rate" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Find respiration rate</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_cleaned</strong> (<em>Union[list, np.array, pd.Series]</em>) – The cleaned respiration channel as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>Union[list, np.array, pd.Series, pd.DataFrame]</em>) – The respiration troughs (inhalation onsets) as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a>.
If None (default), inhalation onsets will be automatically identified from the
<a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a> signal.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_cleaned()</span></code> (in Hz, i.e., samples/second).</p></li>
<li><p><strong>window</strong> (<em>int</em>) – The duration of the sliding window (in second). Default to 10 seconds.</p></li>
<li><p><strong>hop_size</strong> (<em>int</em>) – The number of samples between each successive window. Default to 1 sample.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Method can either be <code class="docutils literal notranslate"><span class="pre">&quot;trough&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;xcorr&quot;</span></code>. In <code class="docutils literal notranslate"><span class="pre">&quot;trough&quot;</span></code> method, respiratory rate
is calculated from the periods between successive inspirations (i.e., inhalation onsets/
troughs). In <code class="docutils literal notranslate"><span class="pre">&quot;xcorr&quot;</span></code> method, cross-correlations between the changes in respiration with
a bank of sinusoids of different frequencies are calculated to identify the principal
frequency of oscillation.</p></li>
<li><p><strong>peak_method</strong> (<em>str</em>) – Method to identify successive respiratory inspirations, only relevant if method is
<code class="docutils literal notranslate"><span class="pre">&quot;trough&quot;</span></code>. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;khodadad2018&quot;</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">&quot;biosppy&quot;</span></code>.</p></li>
<li><p><strong>interpolation_method</strong> (<em>str</em>) – Method used to interpolate the rate between inhalation onsets.
See <a class="reference internal" href="signal.html#neurokit2.signal_interpolate" title="neurokit2.signal_interpolate"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_interpolate()</span></code></a>. <code class="docutils literal notranslate"><span class="pre">&quot;monotone_cubic&quot;</span></code> is chosen as the default
interpolation method since it ensures monotone interpolation between data points (i.e., it
prevents physiologically implausible “overshoots” or “undershoots” in the
y-direction). In contrast, the widely used cubic spline interpolation does not ensure
monotonicity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rsp_rate</strong> (<em>np.ndarray</em>) – Instantenous respiration rate.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp_signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;rsp_1000hz&quot;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">rsp_cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp_signal</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">rsp_rate_onsets</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_rate</span><span class="p">(</span><span class="n">rsp_cleaned</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;trough&quot;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">rsp_rate_xcorr</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_rate</span><span class="p">(</span><span class="n">rsp_cleaned</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;xcorr&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rsp-symmetry">
<h3><em>rsp_symmetry()</em><a class="headerlink" href="#rsp-symmetry" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_symmetry">
<span class="sig-name descname"><span class="pre">rsp_symmetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_cleaned</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'monotone_cubic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_symmetry.html#rsp_symmetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_symmetry" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Respiration Cycle Symmetry Features</strong></p>
<p>Compute symmetry features of the respiration cycle, such as the Peak-Trough symmetry and the
Rise-Decay symmetry (see Cole, 2019). Note that the values for each cycle are interpolated to
the same length as the signal (and the first and last cycles, for which one cannot compute the
symmetry characteristics, are padded).</p>
<figure class="align-default">
<a class="reference external image-reference" href="https://journals.physiology.org/doi/full/10.1152/jn.00273.2019"><img alt="Figure from Cole and Voytek (2019)." src="../_images/cole2019.png" /></a>
</figure>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_cleaned</strong> (<em>Union[list, np.array, pd.Series]</em>) – The cleaned respiration channel as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a>.</p></li>
<li><p><strong>peaks</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the inhalation peaks occur. If a dict or a DataFrame is passed, it is
assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the inhalation troughs occur. If a dict or a DataFrame is passed, it is
assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>interpolation_method</strong> (<em>str</em>) – Method used to interpolate the amplitude between peaks. See <a class="reference internal" href="signal.html#neurokit2.signal_interpolate" title="neurokit2.signal_interpolate"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_interpolate()</span></code></a>.
<code class="docutils literal notranslate"><span class="pre">&quot;monotone_cubic&quot;</span></code> is chosen as the default interpolation method since it ensures monotone
interpolation between data point (i.e., it prevents physiologically implausible “overshoots”
or “undershoots” in the y-direction). In contrast, the widely used cubic spline
‘interpolation does not ensure monotonicity.</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – If True, show a plot of the symmetry features.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><em>pd.DataFrame</em> – A DataFrame of same length as <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_signal()</span></code> containing the following columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Symmetry_PeakTrough&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Symmetry_RiseDecay&quot;</span></code></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_phase" title="neurokit2.rsp.rsp_phase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_phase</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">peak_signal</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_peaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">symmetry</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_symmetry</span><span class="p">(</span><span class="n">cleaned</span><span class="p">,</span> <span class="n">peak_signal</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_symmetry1.png"><img alt="../_images/p_rsp_symmetry1.png" src="../_images/p_rsp_symmetry1.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Cole, S., &amp; Voytek, B. (2019). Cycle-by-cycle analysis of neural oscillations. Journal of
neurophysiology, 122(2), 849-861.</p></li>
</ul>
</dd></dl>

</section>
<section id="rsp-rrv">
<h3><em>rsp_rrv()</em><a class="headerlink" href="#rsp-rrv" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_rrv">
<span class="sig-name descname"><span class="pre">rsp_rrv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_rrv.html#rsp_rrv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_rrv" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Respiratory Rate Variability (RRV)</strong></p>
<p>Computes time domain and frequency domain features for Respiratory Rate Variability (RRV)
analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_rate</strong> (<em>array</em>) – Array containing the respiratory rate, produced by <a class="reference internal" href="signal.html#neurokit2.signal_rate" title="neurokit2.signal_rate"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_rate()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>dict</em>) – The samples at which the inhalation onsets occur.
Dict returned by <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a> (Accessible with the key, <code class="docutils literal notranslate"><span class="pre">&quot;RSP_Troughs&quot;</span></code>).
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, will return a Poincaré plot, a scattergram, which plots each breath-to-breath
interval against the next successive one. The ellipse centers around the average
breath-to-breath interval. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>silent</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, warnings will be printed. Default to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><em>DataFrame</em> – DataFrame consisting of the computed RRV metrics, which includes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SDBB&quot;</span></code>: the standard deviation of the breath-to-breath intervals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_RMSSD&quot;</span></code>: the root mean square of successive differences of the breath-to-breath
intervals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SDSD&quot;</span></code>: the standard deviation of the successive differences between adjacent
breath-to-breath intervals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_BBx&quot;</span></code>: the number of successive interval differences that are greater than x
seconds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV-pBBx&quot;</span></code>: the proportion of breath-to-breath intervals that are greater than x
seconds,
out of the total number of intervals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_VLF&quot;</span></code>: spectral power density pertaining to very low frequency band (i.e., 0 to .
04 Hz) by default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_LF&quot;</span></code>: spectral power density pertaining to low frequency band (i.e., .04 to .15
Hz) by default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_HF&quot;</span></code>: spectral power density pertaining to high frequency band (i.e., .15 to .4
Hz) by default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_LFHF&quot;</span></code>: the ratio of low frequency power to high frequency power.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_LFn&quot;</span></code>: the normalized low frequency, obtained by dividing the low frequency
power by the total power.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_HFn&quot;</span></code>: the normalized high frequency, obtained by dividing the low frequency
power by total power.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SD1&quot;</span></code>: SD1 is a measure of the spread of breath-to-breath intervals on the
Poincaré plot perpendicular to the line of identity. It is an index of short-term
variability.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SD2&quot;</span></code>: SD2 is a measure of the spread of breath-to-breath intervals on the
Poincaré plot along the line of identity. It is an index of long-term variability.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SD2SD1&quot;</span></code>: the ratio between short and long term fluctuations of the
breath-to-breath intervals (SD2 divided by SD1).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_ApEn&quot;</span></code>: the approximate entropy of RRV, calculated
by <a class="reference internal" href="complexity.html#neurokit2.complexity.entropy_approximate" title="neurokit2.complexity.entropy_approximate"><code class="xref py py-func docutils literal notranslate"><span class="pre">entropy_approximate()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_SampEn&quot;</span></code>: the sample entropy of RRV, calculated by <a class="reference internal" href="complexity.html#neurokit2.complexity.entropy_sample" title="neurokit2.complexity.entropy_sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">entropy_sample()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_DFA_alpha1&quot;</span></code>: the “short-term” fluctuation value generated from Detrended
Fluctuation Analysis i.e. the root mean square deviation from the fitted trend of the
breath-to-breath intervals. Will only be computed if mora than 160 breath cycles in the
signal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RRV_DFA_alpha2&quot;</span></code>: the long-term fluctuation value. Will only be computed if mora
than 640 breath cycles in the signal.</p></li>
<li><p><strong>MFDFA indices</strong>: Indices related to the <a class="reference internal" href="complexity.html#neurokit2.complexity.fractal_dfa" title="neurokit2.complexity.fractal_dfa"><code class="xref py py-func docutils literal notranslate"><span class="pre">multifractal</span> <span class="pre">spectrum</span></code></a>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_power</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">entropy_sample</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">entropy_approximate</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">rsp</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">rsp</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_rrv</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[4]: </span>
<span class="go">     RRV_RMSSD   RRV_MeanBB    RRV_SDBB  ...  RRV_SD2SD1  RRV_ApEn  RRV_SampEn</span>
<span class="go">0  1243.776909  3806.142857  796.042228  ...    0.751635  0.087336         inf</span>

<span class="go">[1 rows x 20 columns]</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Soni, R., &amp; Muniyandi, M. (2019). Breath rate variability: a novel measure to study the
meditation effects. International Journal of Yoga, 12(1), 45.</p></li>
</ul>
</dd></dl>

</section>
<section id="rsp-rvt">
<h3><em>rsp_rvt()</em><a class="headerlink" href="#rsp-rvt" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_rvt">
<span class="sig-name descname"><span class="pre">rsp_rvt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rsp_signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'power2020'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundaries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2.0,</span> <span class="pre">0.03333333333333333]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_rvt.html#rsp_rvt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_rvt" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Respiratory Volume per Time (RVT)</strong></p>
<p>Computes Respiratory Volume per Time (RVT). RVT is the product of respiratory volume and
breathing rate. RVT can be used to identify the global fMRI confounds of breathing, which is
often considered noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rsp_signal</strong> (<em>array</em>) – Array containing the respiratory rate, produced by <a class="reference internal" href="signal.html#neurokit2.signal_rate" title="neurokit2.signal_rate"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal_rate()</span></code></a>.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int, optional</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str, optional</em>) – The rvt method to apply. Can be one of  <code class="docutils literal notranslate"><span class="pre">&quot;power2020&quot;</span></code> (default), <code class="docutils literal notranslate"><span class="pre">&quot;harrison2021&quot;</span></code> or
<code class="docutils literal notranslate"><span class="pre">&quot;birn2006&quot;</span></code>.</p></li>
<li><p><strong>boundaries</strong> (<em>list, optional</em>) – Only applies if method is <code class="docutils literal notranslate"><span class="pre">&quot;harrison&quot;</span></code>. Lower and upper limit of (humanly possible)
breath frequency in Hertz.</p></li>
<li><p><strong>iterations</strong> (<em>int, optional</em>) – Only applies if method is <code class="docutils literal notranslate"><span class="pre">&quot;harrison&quot;</span></code>. Amount of phase refinement estimates
to remove high frequencies. Synthetic samples often take less than 3.</p></li>
<li><p><strong>show</strong> (<em>bool, optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, will return a simple plot of the RVT (with the re-scaled original RSP signal).</p></li>
<li><p><strong>silent</strong> (<em>bool, optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, warnings will not be printed.</p></li>
<li><p><strong>**kwargs</strong> – Arguments to be passed to the underlying peak detection algorithm.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>array</em> – Array containing the current RVT at every timestep.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">signal_rate</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_peaks</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_rvt</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;power2020&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[3]: </span>
<span class="go">array([       nan,        nan,        nan, ..., 0.00086246, 0.00086246,</span>
<span class="go">       0.00086246])</span>

<span class="gp">In [4]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_rvt</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;harrison2021&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[4]: </span>
<span class="go">array([0.14915545, 0.14915298, 0.14915056, ..., 0.13633738, 0.1363369 ,</span>
<span class="go">       0.13633648])</span>

<span class="gp">In [5]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_rvt</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;birn2006&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[5]: </span><span class="go">array([nan, nan, nan, ..., nan, nan, nan])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/p_rsp_rvt1.png"><img alt="../_images/p_rsp_rvt1.png" src="../_images/p_rsp_rvt1.png" style="width: 640.0px; height: 480.0px;" /></a>
<a class="reference internal image-reference" href="../_images/p_rsp_rvt2.png"><img alt="../_images/p_rsp_rvt2.png" src="../_images/p_rsp_rvt2.png" style="width: 640.0px; height: 480.0px;" /></a>
<a class="reference internal image-reference" href="../_images/p_rsp_rvt3.png"><img alt="../_images/p_rsp_rvt3.png" src="../_images/p_rsp_rvt3.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Birn, R. M., Diamond, J. B., Smith, M. A., &amp; Bandettini, P. A. (2006). Separating
respiratory-variation-related fluctuations from neuronal-activity-related fluctuations in
fMRI. Neuroimage, 31(4), 1536-1548.</p></li>
<li><p>Power, J. D., Lynch, C. J., Dubin, M. J., Silver, B. M., Martin, A., &amp; Jones, R. M. (2020).
Characteristics of respiratory measures in young adults scanned at rest, including systematic
changes and “missed” deep breaths. Neuroimage, 204, 116234.</p></li>
<li><p>Harrison, S. J., Bianchi, S., Heinzle, J., Stephan, K. E., Iglesias, S., &amp; Kasper, L. (2021).
A Hilbert-based method for processing respiratory timeseries. Neuroimage, 230, 117787.</p></li>
</ul>
</dd></dl>

</section>
</section>
<section id="analysis">
<h2>Analysis<a class="headerlink" href="#analysis" title="Permalink to this heading">#</a></h2>
<section id="rsp-eventrelated">
<h3><em>rsp_eventrelated()</em><a class="headerlink" href="#rsp-eventrelated" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_eventrelated">
<span class="sig-name descname"><span class="pre">rsp_eventrelated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_eventrelated.html#rsp_eventrelated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_eventrelated" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Performs event-related RSP analysis on epochs</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>Union[dict, pd.DataFrame]</em>) – A dict containing one DataFrame per event/trial, usually obtained via
<a class="reference internal" href="epochs.html#neurokit2.epochs.epochs_create" title="neurokit2.epochs.epochs_create"><code class="xref py py-func docutils literal notranslate"><span class="pre">epochs_create()</span></code></a>, or a DataFrame containing all epochs, usually obtained
via <a class="reference internal" href="epochs.html#neurokit2.epochs.epochs_to_df" title="neurokit2.epochs.epochs_to_df"><code class="xref py py-func docutils literal notranslate"><span class="pre">epochs_to_df()</span></code></a>.</p></li>
<li><p><strong>silent</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, silence possible warnings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><em>DataFrame</em> – A dataframe containing the analyzed RSP features for each epoch, with each epoch indicated
by the <cite>Label</cite> column (if not present, by the <cite>Index</cite> column). The analyzed features
consist of the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Max&quot;</span></code>: the maximum respiratory rate after stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Min&quot;</span></code>: the minimum respiratory rate after stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Mean&quot;</span></code>: the mean respiratory rate after stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_SD&quot;</span></code>: the standard deviation of the respiratory rate after stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Max_Time&quot;</span></code>: the time at which maximum respiratory rate occurs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Min_Time&quot;</span></code>: the time at which minimum respiratory rate occurs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_Baseline&quot;</span></code>: the respiratory amplitude at stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_Max&quot;</span></code>: the change in maximum respiratory amplitude from before stimulus
onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_Min&quot;</span></code>: the change in minimum respiratory amplitude from before stimulus
onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_Mean&quot;</span></code>: the change in mean respiratory amplitude from before stimulus
onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_SD&quot;</span></code>: the standard deviation of the respiratory amplitude after
stimulus onset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase&quot;</span></code>: indication of whether the onset of the event concurs with respiratory
inspiration (1) or expiration (0).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_PhaseCompletion&quot;</span></code>: indication of the stage of the current respiration phase (0 to
1) at the onset of the event.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">events_find</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">epochs_create</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">bio_process</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Example with simulated data</span>
<span class="gp">In [2]: </span><span class="n">rsp</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">120</span><span class="p">))</span>

<span class="gp">In [3]: </span><span class="n">epochs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">epochs_create</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">15000</span><span class="p">],</span> <span class="n">epochs_start</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">epochs_end</span><span class="o">=</span><span class="mf">1.9</span><span class="p">)</span>

<span class="go"># Analyze</span>
<span class="gp">In [4]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_eventrelated</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
<span class="gh">Out[4]: </span>
<span class="go">  Label  Event_Onset  ...  RSP_RVT_Baseline  RSP_RVT_Mean</span>
<span class="go">1     1         5000  ...          0.194487     -0.015602</span>
<span class="go">2     2        10000  ...          0.189766      0.005882</span>
<span class="go">3     3        15000  ...          0.237266     -0.014360</span>

<span class="go">[3 rows x 22 columns]</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Example with real data</span>
<span class="gp">In [5]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;bio_eventrelated_100hz&quot;</span><span class="p">)</span>

<span class="go"># Process the data</span>
<span class="gp">In [6]: </span><span class="n">df</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">bio_process</span><span class="p">(</span><span class="n">rsp</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;RSP&quot;</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">events</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">events_find</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Photosensor&quot;</span><span class="p">],</span> <span class="n">threshold_keep</span><span class="o">=</span><span class="s1">&#39;below&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>                       <span class="n">event_conditions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Negative&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutral&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutral&quot;</span><span class="p">,</span> <span class="s2">&quot;Negative&quot;</span><span class="p">])</span>
<span class="gp">   ...: </span>

<span class="gp">In [8]: </span><span class="n">epochs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">epochs_create</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs_start</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">epochs_end</span><span class="o">=</span><span class="mf">2.9</span><span class="p">)</span>

<span class="go"># Analyze</span>
<span class="gp">In [9]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_eventrelated</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
<span class="gh">Out[9]: </span>
<span class="go">  Label Condition  ...  RSP_RVT_Baseline  RSP_RVT_Mean</span>
<span class="go">1     1  Negative  ...          0.225643     -0.003451</span>
<span class="go">2     2   Neutral  ...          0.169809     -0.008606</span>
<span class="go">3     3   Neutral  ...          0.127095      0.014045</span>
<span class="go">4     4  Negative  ...          0.080601      0.001213</span>

<span class="go">[4 rows x 23 columns]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rsp-intervalrelated">
<h3><em>rsp_intervalrelated()</em><a class="headerlink" href="#rsp-intervalrelated" title="Permalink to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_intervalrelated">
<span class="sig-name descname"><span class="pre">rsp_intervalrelated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_intervalrelated.html#rsp_intervalrelated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_intervalrelated" title="Permalink to this definition">#</a></dt>
<dd><p><strong>State-related Respiration Indices</strong></p>
<p>Performs RSP analysis on longer periods of data (typically &gt; 10 seconds), such as resting-state
data. It returns a dataframe containing features and characteristics of respiration in that
interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataFrame or dict</em>) – A DataFrame containing the different processed signal(s) as different columns, typically
generated by <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_process()</span></code></a> or <a class="reference internal" href="bio.html#neurokit2.bio_process" title="neurokit2.bio_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">bio_process()</span></code></a>. Can also take a dict containing
sets of separately processed DataFrames.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the signal (in Hz, i.e., samples/second).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><em>DataFrame</em> – A dataframe containing the analyzed RSP features.
The analyzed features consist of the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Rate_Mean&quot;</span></code>: the mean respiratory rate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Amplitude_Mean&quot;</span></code>: the mean respiratory amplitude.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_RRV&quot;</span></code>: the different respiratory rate variability metrices.
See <a class="reference internal" href="#neurokit2.rsp.rsp_rrv" title="neurokit2.rsp.rsp_rrv"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_rrv()</span></code></a> docstrings for details.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase_Duration_Inspiration&quot;</span></code>: the average inspiratory duration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase_Duration_Expiration&quot;</span></code>: the average expiratory duration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RSP_Phase_Duration_Ratio</span> <span class="pre">&quot;</span></code>: the inspiratory-to-expiratory time ratio (I/E).</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bio_process</span></code>, <a class="reference internal" href="#neurokit2.rsp.rsp_eventrelated" title="neurokit2.rsp.rsp_eventrelated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_eventrelated</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_rrv" title="neurokit2.rsp.rsp_rrv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_rrv</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_rav" title="neurokit2.rsp.rsp_rav"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_rav</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="go"># Download data</span>
<span class="gp">In [2]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;bio_resting_5min_100hz&quot;</span><span class="p">)</span>

<span class="go"># Process the data</span>
<span class="gp">In [3]: </span><span class="n">df</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_process</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;RSP&quot;</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="go"># Single dataframe is passed</span>
<span class="gp">In [4]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_intervalrelated</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gh">Out[4]: </span>
<span class="go">   RSP_Rate_Mean  ...  RSP_Phase_Duration_Ratio</span>
<span class="go">0      15.860331  ...                  0.664482</span>

<span class="go">[1 rows x 40 columns]</span>

<span class="gp">In [5]: </span><span class="n">epochs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">epochs_create</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15000</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs_end</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">nk</span><span class="o">.</span><span class="n">rsp_intervalrelated</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gh">Out[6]: </span>
<span class="go">  Label  RSP_Rate_Mean  ...  RSP_Phase_Duration_Expiration  RSP_Phase_Duration_Ratio</span>
<span class="go">1     1      15.330861  ...                       0.024288                  0.617516</span>
<span class="go">2     2      16.389802  ...                       0.021663                  0.716738</span>

<span class="go">[2 rows x 32 columns]</span>
</pre></div>
</div>
</dd></dl>

<p><em>Any function appearing below this point is not explicitly part of the documentation and should be added. Please open an issue if there is one.</em></p>
<span class="target" id="module-neurokit2.rsp"></span><p>Submodule for NeuroKit.</p>
<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_methods">
<span class="sig-name descname"><span class="pre">rsp_methods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'khodadad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_cleaning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_peaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_rvt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'power'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_methods.html#rsp_methods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_methods" title="Permalink to this definition">#</a></dt>
<dd><p><strong>RSP Preprocessing Methods</strong></p>
<p>This function analyzes and specifies the methods used in the preprocessing, and create a
textual description of the methods used. It is used by <a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_process()</span></code></a> to dispatch the
correct methods to each subroutine of the pipeline and <code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_report()</span></code> to create a
preprocessing report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampling_rate</strong> (<em>int</em>) – The sampling frequency of the raw RSP signal (in Hz, i.e., samples/second).</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The method used for cleaning and peak finding if <code class="docutils literal notranslate"><span class="pre">&quot;method_cleaning&quot;</span></code>
and <code class="docutils literal notranslate"><span class="pre">&quot;method_peaks&quot;</span></code> are set to <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>. Can be one of <code class="docutils literal notranslate"><span class="pre">&quot;Khodadad&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;BioSPPy&quot;</span></code>.
Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;Khodadad&quot;</span></code>.</p></li>
<li><p><strong>method_cleaning</strong> (<em>str</em>) – The method used to clean the raw RSP signal. If <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>,
will be set to the value of <code class="docutils literal notranslate"><span class="pre">&quot;method&quot;</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>.
For more information, see the <code class="docutils literal notranslate"><span class="pre">&quot;method&quot;</span></code> argument
of <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a>.</p></li>
<li><p><strong>method_peaks</strong> (<em>str</em>) – The method used to find peaks. If <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>,
will be set to the value of <code class="docutils literal notranslate"><span class="pre">&quot;method&quot;</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>.
For more information, see the <code class="docutils literal notranslate"><span class="pre">&quot;method&quot;</span></code> argument
of <a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a>.</p></li>
<li><p><strong>method_rvt</strong> (<em>str</em>) – The method used to compute respiratory volume per time. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;harrison&quot;</span></code>.
For more information, see the <code class="docutils literal notranslate"><span class="pre">&quot;method&quot;</span></code> argument
of <a class="reference internal" href="#neurokit2.rsp.rsp_rvt" title="neurokit2.rsp.rsp_rvt"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_rvt()</span></code></a>.</p></li>
<li><p><strong>**kwargs</strong> – Other arguments to be passed to <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a>,
<a class="reference internal" href="#neurokit2.rsp.rsp_peaks" title="neurokit2.rsp.rsp_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a>, and <a class="reference internal" href="#neurokit2.rsp.rsp_rvt" title="neurokit2.rsp.rsp_rvt"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_rvt()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>report_info</strong> (<em>dict</em>) – A dictionary containing the keyword arguments passed to the cleaning
and peak finding functions, text describing the methods, and the corresponding
references.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_process" title="neurokit2.rsp.rsp_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_process</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_clean" title="neurokit2.rsp.rsp_clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_clean</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_findpeaks</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">methods</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_methods</span><span class="p">(</span><span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Khodadad&quot;</span><span class="p">,</span> <span class="n">method_cleaning</span><span class="o">=</span><span class="s2">&quot;hampel&quot;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="nb">print</span><span class="p">(</span><span class="n">methods</span><span class="p">[</span><span class="s2">&quot;text_cleaning&quot;</span><span class="p">])</span>
<span class="go">The raw signal, sampled at 100 Hz, was preprocessed using a median-based Hampel filter by replacing values which are 3 median absolute deviation away from the rolling median;following Power et al. 2020.</span>

<span class="gp">In [4]: </span><span class="nb">print</span><span class="p">(</span><span class="n">methods</span><span class="p">[</span><span class="s2">&quot;references&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Khodadad, D., Nordebo, S., Müller, B., Waldmann, A., Yerworth, R., Becher, T., ... &amp; Bayford, R. (2018).</span>
<span class="go">            Optimized breath detection algorithm in electrical impedance tomography.</span>
<span class="go">            Physiological measurement, 39(9), 094001.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neurokit2.rsp.rsp_rav">
<span class="sig-name descname"><span class="pre">rsp_rav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">troughs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurokit2/rsp/rsp_rav.html#rsp_rav"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurokit2.rsp.rsp_rav" title="Permalink to this definition">#</a></dt>
<dd><p><strong>Respiratory Amplitude Variability (RAV)</strong></p>
<p>Computes indices of amplitude variability, such as the mean and SD of the amplitude, and the
RMSSD of the successive differences.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an exploratory feature. If you manage to find studies and literature on RAV, please
let us know by opening an issue on GitHub. Adding more indices (similar to HRV) would be
trivial, but having some evidence as for its usefulness would be prerequisite.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amplitude</strong> (<em>Union[list, np.array, pd.Series]</em>) – The amplitude signal as returned by <a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_amplitude()</span></code></a>.</p></li>
<li><p><strong>peaks</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the inhalation peaks occur. If a dict or a DataFrame is passed, it is
assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>.</p></li>
<li><p><strong>troughs</strong> (<em>list or array or DataFrame or Series or dict</em>) – The samples at which the inhalation troughs occur. If a dict or a DataFrame is passed, it is
assumed that these containers were obtained with <a class="reference internal" href="#neurokit2.rsp.rsp_findpeaks" title="neurokit2.rsp.rsp_findpeaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a>. This argument can
be inferred from the <code class="docutils literal notranslate"><span class="pre">peaks</span></code> argument if the information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pd.DataFrame</em> – A DataFrame of containing the following columns with RAV indices.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neurokit2.rsp.rsp_amplitude" title="neurokit2.rsp.rsp_amplitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_amplitude</span></code></a>, <a class="reference internal" href="#neurokit2.rsp.rsp_rrv" title="neurokit2.rsp.rsp_rrv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rsp_rrv</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="gp">In [2]: </span><span class="n">rsp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_simulate</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">respiratory_rate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_clean</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">peak_signal</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_peaks</span><span class="p">(</span><span class="n">cleaned</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">amplitude</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_amplitude</span><span class="p">(</span><span class="n">cleaned</span><span class="p">,</span> <span class="n">peaks</span><span class="o">=</span><span class="n">peak_signal</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">rav</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">rsp_rav</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">peaks</span><span class="o">=</span><span class="n">peak_signal</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">rav</span>
<span class="gh">Out[7]: </span>
<span class="go">   RAV_Mean    RAV_SD  RAV_RMSSD  RAV_CVSD</span>
<span class="go">0   0.89808  0.115633    0.13496  0.150276</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="hrv.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">HRV</p>
      </div>
    </a>
    <a class="right-next"
       href="eda.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">EDA</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main">Main</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-process"><em>rsp_process()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_process"><code class="docutils literal notranslate"><span class="pre">rsp_process()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-analyze"><em>rsp_analyze()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_analyze"><code class="docutils literal notranslate"><span class="pre">rsp_analyze()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-simulate"><em>rsp_simulate()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_simulate"><code class="docutils literal notranslate"><span class="pre">rsp_simulate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-plot"><em>rsp_plot()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_plot"><code class="docutils literal notranslate"><span class="pre">rsp_plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-clean"><em>rsp_clean()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_clean"><code class="docutils literal notranslate"><span class="pre">rsp_clean()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-amplitude"><em>rsp_amplitude()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_amplitude"><code class="docutils literal notranslate"><span class="pre">rsp_amplitude()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-peaks"><em>rsp_peaks()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_peaks"><code class="docutils literal notranslate"><span class="pre">rsp_peaks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-findpeaks"><em>rsp_findpeaks()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_findpeaks"><code class="docutils literal notranslate"><span class="pre">rsp_findpeaks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-fixpeaks"><em>rsp_fixpeaks()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_fixpeaks"><code class="docutils literal notranslate"><span class="pre">rsp_fixpeaks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-phase"><em>rsp_phase()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_phase"><code class="docutils literal notranslate"><span class="pre">rsp_phase()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-rate"><em>rsp_rate()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_rate"><code class="docutils literal notranslate"><span class="pre">rsp_rate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-symmetry"><em>rsp_symmetry()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_symmetry"><code class="docutils literal notranslate"><span class="pre">rsp_symmetry()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-rrv"><em>rsp_rrv()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_rrv"><code class="docutils literal notranslate"><span class="pre">rsp_rrv()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-rvt"><em>rsp_rvt()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_rvt"><code class="docutils literal notranslate"><span class="pre">rsp_rvt()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-eventrelated"><em>rsp_eventrelated()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_eventrelated"><code class="docutils literal notranslate"><span class="pre">rsp_eventrelated()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsp-intervalrelated"><em>rsp_intervalrelated()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_intervalrelated"><code class="docutils literal notranslate"><span class="pre">rsp_intervalrelated()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_methods"><code class="docutils literal notranslate"><span class="pre">rsp_methods()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurokit2.rsp.rsp_rav"><code class="docutils literal notranslate"><span class="pre">rsp_rav()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By <a href="https://dominiquemakowski.github.io/">Dominique Makowski</a> and the <a href="https://github.com/neuropsychology/NeuroKit/blob/master/AUTHORS.rst">Team</a>. This documentation is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> license.
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2020–2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>